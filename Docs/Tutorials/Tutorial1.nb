(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    273033,       7800]
NotebookOptionsPosition[    245270,       7006]
NotebookOutlinePosition[    245661,       7023]
CellTagsIndexPosition[    245618,       7020]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Libra package examples", "Title",
 CellChangeTimes->{{3.7463266547028627`*^9, 3.746326655872984*^9}, {
  3.770799317068858*^9, 3.770799325476535*^9}, {3.7708113892411737`*^9, 
  3.770811401938076*^9}},
 ExpressionUUID -> "8745f354-1aac-4220-a745-4b94bb29273b"],

Cell[CellGroupData[{

Cell["Loading package", "Subsection",
 CellChangeTimes->{{3.770813141852997*^9, 3.770813146018463*^9}}],

Cell[BoxData[
 RowBox[{"<<", "Libra`"}]], "Code",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, 3.7708131614023447`*^9},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"],

Cell[BoxData[
 RowBox[{"SetDirectory", "[", 
  RowBox[{"NotebookDirectory", "[", "]"}], "]"}]], "Code",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, 3.7708131614023447`*^9},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Example #1: basic functionality", "Chapter",
 CellChangeTimes->{
  3.7708114064532833`*^9, {3.7708131047755632`*^9, 3.770813110759389*^9}, {
   3.770813751963812*^9, 3.770813786313579*^9}}],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.7708132837405777`*^9, 3.770813284348737*^9}}],

Cell[BoxData[
 RowBox[{"m", "=", 
  InterpretationBox[
   TagBox[
    TooltipBox[
     PanelBox["\<\"5\[Times]5 example matrix, depending on \
\\!\\(\\*\\nStyleBox[\\\"x\\\", \\\"TI\\\"]\\) and \\!\\(\\*\\nStyleBox[\\\"\
\[Epsilon]\\\", \\\"TI\\\"]\\).\"\>",
      FrameMargins->Small],
     "\"Tue 3 Nov 2020 14:18:46\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "Tue 3 Nov 2020 14:18:46", "Tooltip"]& ],
   Uncompress[
   "1:eJztWMtKw0AUjXlVxZ/wDwRx4we4clGKSzcVGghUA01Fv1xsKq15YNK5c+\
c906SYLkKmkzv3fe5hrl+yWRJ5npeH5eMxzdfYqno8pa+LPPH/ltPsY7FqltW30+\
V7nu7LX35Wrj7rV/AxewccU33HOSYu357vb24f7prtC0q4k6iNTnetXbhJPiKzrWQ6VUlAbl+2NnI+\
2jCDUP95IAiUx4RBlNu1vUDXN9NHgSCmCwsLflhIR5pZFLiWnXI9xD3oFNQgrR6mNAAZHwOHBA5rXt\
gqJDwBl8TgAjAKdVbGJaVkiyVCzEsDv2xhb8DJD4UVAFk62OUUPgIySp4Z5yriNyYCjxbtO+\
wHr9JEVveEsKU56rx8zObrNHubL+vjjhJCm9Cn2Q1cCb81Gu6wuwEb+\
xBtAnpbbqIPpYHjo4UOJg2E7gdFg4A+Qy6+psB/\
0uS0sEBOC11yeoXkyBU5xXTJk9OxB9324IRlqjSfdDyNZPik+\
vz6Hwy0Lx40eII4FFSxTs0xBmp5zCo1t3ozy6YU1jo9pU2vi8htIeZudYexxk0Rm3A4vSkCw8K0rW0\
gjZ1yE093DOYdTPfCKcPuK2GWsmTe4hs+6d7LRF/7RliDdH/1Q7rHPj+\
xPo9o33vp84hSYhZF6KdOFLGCR6P4Cym2yXk="]]}]], "Input",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, {3.770805038034974*^9, 
   3.770805038115343*^9}, 3.770811959456465*^9, 3.7708120656647167`*^9, 
   3.770812855009626*^9, {3.815607120504034*^9, 3.815607122623263*^9}},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"ds1", ",", 
    RowBox[{"x", "\[Rule]", "m"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, {3.770805038034974*^9, 
   3.770805038115343*^9}, 3.770811959456465*^9, 3.772323912247113*^9},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"],

Cell[BoxData[
 RowBox[{"DSystemQ", "[", "ds1", "]"}]], "Input",
 CellChangeTimes->{{3.770805046813098*^9, 3.77080505085708*^9}, 
   3.772323912260776*^9}],

Cell[TextData[{
 "Note that only commands ",
 StyleBox["Transform[ds1,...]",
  FontWeight->"Bold"],
 ", ",
 StyleBox["Factor[ds1]",
  FontWeight->"Bold"],
 ",",
 StyleBox[" Simplify[ds1]",
  FontWeight->"Bold"],
 ", ",
 StyleBox["Map[f,ds1,...]",
  FontWeight->"Bold"],
 " and a few others are dangerous in a sense that they actually modify the \
differential system, while ",
 StyleBox["VisTransformation",
  FontWeight->"Bold"],
 ", ",
 StyleBox["FuchsifyBlock",
  FontWeight->"Bold"],
 ", ",
 StyleBox["FactorOut",
  FontWeight->"Bold"],
 " only construct the transformation and thus are safe. \nBut even the \
dangerous commands are safe because their effect can be undone with ",
 StyleBox["Undo[ds1]",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.770804116681527*^9, 3.77080441242737*^9}, {
   3.770804459983089*^9, 3.770804497251967*^9}, {3.7708050651206503`*^9, 
   3.770805377394903*^9}, 3.770995674624915*^9, {3.7723239122931013`*^9, 
   3.772323912514151*^9}}],

Cell[TextData[{
 "First, we use visual tool VisTransformation to balance the matrix. Note \
that the option Highlighted\[Rule]{\[Ellipsis]} is supposed to guide you \
through this process by highlighting tha buttons to be pressed, but it is \
extremely fragile. This is because the ordering of the eigenvectors, and even \
their choice (when there is a degeneracy) is not unique and may differ from \
Mathematica\[CloseCurlyQuote]s version to version. Therefore, rely on the \
common sense trying to press ",
 StyleBox["blue",
  FontColor->RGBColor[0, 0, 1]],
 " buttons on the left and ",
 StyleBox["red",
  FontColor->RGBColor[1, 0, 0]],
 " ones on the right as much as possible."
}], "Text",
 CellChangeTimes->{{3.7708053852594137`*^9, 3.770805387737618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"ds1", ",", "x", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Highlighted", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "11", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "22", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"2", ",", "3", ",", "4", ",", "5"}], "}"}], 
         "\[LongLeftRightArrow]", 
         RowBox[{"{", 
          RowBox[{"6", ",", "7", ",", "8", ",", "9"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"11", ",", "12", ",", "13", ",", "14"}], "}"}], 
         "\[LongLeftRightArrow]", 
         RowBox[{"{", 
          RowBox[{"16", ",", "17", ",", "18", ",", "19"}], "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "14", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "20", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "20", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "15", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, 
   3.772323912515729*^9, 3.8156071475148373`*^9, {3.815607592320754*^9, 
   3.815607592509729*^9}, {3.815608140015394*^9, 3.815608164813456*^9}, {
   3.8156084636033697`*^9, 3.815608493929124*^9}}],

Cell[TextData[{
 "Now we apply the transformation found. \nNote that Libra knows that our \
system is wrt x, so there is nether need nor possibility to indicate this. \
So, we shall use the ",
 StyleBox["Transform[ds1,t]",
  FontWeight->"Bold"],
 ".\nYou could get the same transformed matrix via ",
 StyleBox["Transform[ds1[x],t,x]",
  FontWeight->"Bold"],
 " (note that the first argument now is the matrix, not the differential \
system), but this will not change the history of ds1.\nSo, if ",
 StyleBox["m",
  FontWeight->"Bold"],
 " is matrix, use ",
 StyleBox["Transform[m,t,x]",
  FontWeight->"Bold"],
 " syntax for differential transformation and ",
 StyleBox["Transform[m,t]",
  FontWeight->"Bold"],
 " for similarity transformation ",
 StyleBox["Inverse[t].m.t",
  FontWeight->"Bold"],
 ". \nIf, however, the first argument is the differential system, ",
 StyleBox["Transform[ds1,t]",
  FontWeight->"Bold"],
 " "
}], "Text",
 CellChangeTimes->{{3.770804548445692*^9, 3.770805033712843*^9}, {
  3.770805435842716*^9, 3.7708054423382196`*^9}, {3.770805506883195*^9, 
  3.770805566227384*^9}, {3.7723239126236486`*^9, 3.772323912826365*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m"}]], "Input",
 CellChangeTimes->{{3.7708055848668118`*^9, 3.770805589875332*^9}, 
   3.772323912828178*^9}],

Cell["\<\
Before actually modifying the differential system, let us apply the \
transformation to a matrix. \
\>", "Text",
 CellChangeTimes->{{3.770805445665534*^9, 3.770805491402079*^9}, {
  3.770805598834597*^9, 3.770805607290477*^9}}],

Cell[BoxData[
 RowBox[{"m1", "=", 
  RowBox[{"Transform", "[", 
   RowBox[{
    RowBox[{"ds1", "[", "x", "]"}], ",", "t", ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.770805494850697*^9, 3.770805503706025*^9}, {
   3.770805616899088*^9, 3.770805622987488*^9}, 3.7723239128304873`*^9}],

Cell["The system has not changed:", "Text",
 CellChangeTimes->{{3.770805643258604*^9, 3.770805649434731*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m"}]], "Input",
 CellChangeTimes->{3.772323912833267*^9}],

Cell["Now we apply the transformation the the system:", "Text",
 CellChangeTimes->{{3.770805658090592*^9, 3.7708056689868803`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds1", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770799819697781*^9, 3.7707998248310223`*^9}, {
   3.770803154037931*^9, 3.770803159567807*^9}, {3.770805672987648*^9, 
   3.770805674708271*^9}, 3.772323912837023*^9}],

Cell["The system has changed:", "Text",
 CellChangeTimes->{{3.770805693778387*^9, 3.770805699648278*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m"}]], "Input",
 CellChangeTimes->{{3.770805677754465*^9, 3.770805683443562*^9}, 
   3.7723239128442497`*^9}],

Cell["The matrix in the rhs is equal to m1:", "Text",
 CellChangeTimes->{{3.770805693778387*^9, 3.770805736595324*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m1"}]], "Input",
 CellChangeTimes->{3.770805689467211*^9, 3.772323912847453*^9}],

Cell["We can freely undo and redo transformations:", "Text",
 CellChangeTimes->{{3.7708057439808826`*^9, 3.770805767379442*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Undo", "[", "ds1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m"}]}], "Input",
 CellChangeTimes->{{3.770805769840844*^9, 3.7708057816055098`*^9}, {
  3.772323912849835*^9, 3.772323912850581*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Redo", "[", "ds1", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m1"}]}], "Input",
 CellChangeTimes->{{3.770805789283917*^9, 3.770805794486521*^9}, {
  3.772323912855843*^9, 3.772323912856518*^9}}],

Cell[BoxData[
 RowBox[{"Block", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"\[Mu]", "=", "1"}], ",", "C"}], "}"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"C", "[", "1", "]"}], "=", "1"}], ";", 
    RowBox[{
     RowBox[{"C", "[", "_", "]"}], "=", "0"}], ";", "\[IndentingNewLine]", 
    RowBox[{"t", "=", 
     RowBox[{"FactorOut", "[", 
      RowBox[{
       RowBox[{"ds1", "[", "x", "]"}], ",", "x", ",", "\[Epsilon]", ",", 
       "\[Mu]"}], "]"}]}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7707997901745253`*^9, 3.770799800470956*^9}, {
   3.770801401631613*^9, 3.770801432925734*^9}, {3.770801466775*^9, 
   3.770801476494183*^9}, {3.770801509534505*^9, 3.7708015412226562`*^9}, {
   3.770803200670121*^9, 3.770803202512796*^9}, {3.770803321679556*^9, 
   3.7708033875915747`*^9}, {3.7708101110314302`*^9, 3.770810111220622*^9}, 
   3.772323912862225*^9}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.7708015458173018`*^9, 3.770801549174274*^9}, {
   3.770810118047103*^9, 3.77081011821935*^9}, 3.7723239128649197`*^9}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds1", "[", "x", "]"}], ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.770801554357415*^9, 3.770801603017664*^9}, {
   3.770810212567103*^9, 3.770810212629945*^9}, 3.7723239129736223`*^9, {
   3.815608562142968*^9, 3.815608565868898*^9}}],

Cell["\<\
We may want to simplify the numerical coefficients a bit. A good idea is to \
diagonalized one of the matrix residues:\
\>", "Text",
 CellChangeTimes->{{3.7708102197354193`*^9, 3.770810262081801*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ds1", "[", "x", "]"}], "/", "\[Epsilon]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7708016189874372`*^9, 3.770801642814904*^9}, {
   3.770803416938745*^9, 3.770803425769491*^9}, {3.770810269027033*^9, 
   3.770810269890889*^9}, 3.772323912976573*^9}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.7708102786362133`*^9, 3.770810279249254*^9}, 
   3.772323912979238*^9}],

Cell["\<\
Although, the higher-order series coefficients are not guaranted to have \
rational eigenvalues, it worth trying:\
\>", "Text",
 CellChangeTimes->{{3.770803452520216*^9, 3.770803498997192*^9}, 
   3.770803529029241*^9, {3.770803878534841*^9, 3.770803881294442*^9}, {
   3.770804027106913*^9, 3.7708040714259377`*^9}, {3.7708100094552593`*^9, 
   3.770810020342876*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"ds1", "[", "x", "]"}], "/", "\[Epsilon]"}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.770803438791883*^9, 3.770803449209119*^9}, {
   3.770810292134828*^9, 3.770810292449761*^9}, 3.772323912984776*^9}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.770810299280553*^9, 3.770810299604835*^9}, 
   3.772323912987656*^9}],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", 
  RowBox[{"ds1", "[", "x", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.770804082931522*^9, 3.770804092738881*^9}, {
   3.770810305009809*^9, 3.770810305504125*^9}, 3.772323912993453*^9}],

Cell["\<\
Finally, to get the overall transformation, we use the following command:\
\>", "Text",
 CellChangeTimes->{{3.770810043711546*^9, 3.7708100704787807`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"HistoryConsolidate", "[", "ds1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.77081007491341*^9, 3.770810088538619*^9}, {
   3.7708103114027767`*^9, 3.770810313861594*^9}, 3.772323912996019*^9}],

Cell[BoxData["t"], "Input",
 CellChangeTimes->{3.770810316119866*^9}],

Cell["Now we can check that the found transformation is correct.", "Text",
 CellChangeTimes->{{3.7708103364144363`*^9, 3.770810358457758*^9}}],

Cell["First, we undo all transformations:", "Text",
 CellChangeTimes->{{3.7708103617389183`*^9, 3.770810372851248*^9}}],

Cell[BoxData[
 RowBox[{"Undo", "[", 
  RowBox[{"ds1", ",", "All"}], "]"}]], "Input",
 CellChangeTimes->{{3.770810319832041*^9, 3.7708103262653017`*^9}, 
   3.772323913011166*^9}],

Cell["\<\
Now we re-apply the overall tranformation. However, the command below will \
complain:\
\>", "Text",
 CellChangeTimes->{{3.77081038038878*^9, 3.770810869709635*^9}, {
  3.7708109060649843`*^9, 3.7708109472446136`*^9}, {3.7708109879204597`*^9, 
  3.770811003066648*^9}}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{3.772323913016576*^9}],

Cell["\<\
Athough, the command above returns the transformed matrix, it had no effect \
on the actual differential system:\
\>", "Text",
 CellChangeTimes->{{3.7708110303095627`*^9, 3.770811114618835*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds1", "[", "x", "]"}], "===", "m"}]], "Input",
 CellChangeTimes->{{3.7708110460778646`*^9, 3.770811050115655*^9}, 
   3.7723239130214148`*^9}],

Cell[TextData[{
 "This is made for safety: Undo and Redo simply modifies the pointer to the \
specific history entry (",
 StyleBox["HistoryIndex[ds1]",
  FontWeight->"Bold"],
 "), while the history list (",
 StyleBox["History[ds1]",
  FontWeight->"Bold"],
 ") remains intact. \nBy default, dangerous commands can modify differential \
system only if ",
 StyleBox["HistoryIndex[ds1]===Length[History[ds1]]",
  FontWeight->"Bold"],
 ", i.e., when the pointer points to the last entry in history list. \
Therefore has to explicitly chop off the history list by ",
 StyleBox["HistoryChop[ds1]",
  FontWeight->"Bold"],
 " before the transformation is possible."
}], "Text",
 CellChangeTimes->{{3.77081038038878*^9, 3.770810869709635*^9}, {
   3.7708109060649843`*^9, 3.7708109472446136`*^9}, 3.7708109879204597`*^9, {
   3.772323913146346*^9, 3.77232391342776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "@", 
   RowBox[{"History", "[", "ds1", "]"}]}], "-", 
  RowBox[{"HistoryIndex", "[", "ds1", "]"}]}]], "Input",
 CellChangeTimes->{{3.77081112285555*^9, 3.770811201503289*^9}, {
  3.772323913429534*^9, 3.77232391342992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"HistoryChop", "[", "ds1", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770811195923833*^9, 3.770811211256431*^9}, 
   3.7723239134323883`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Length", "@", 
   RowBox[{"History", "[", "ds1", "]"}]}], "-", 
  RowBox[{"HistoryIndex", "[", "ds1", "]"}]}]], "Input",
 CellChangeTimes->{{3.772323913436555*^9, 3.772323913437099*^9}}],

Cell["Now we can apply the transformation:", "Text",
 CellChangeTimes->{{3.770811220714961*^9, 3.770811228967554*^9}, {
  3.770813063531773*^9, 3.770813064458136*^9}}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds1", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.770810949620681*^9, 3.7708109683745947`*^9}, 
   3.772323913439364*^9}],

Cell[BoxData[
 RowBox[{" ", "Quit"}]], "Input",
 CellChangeTimes->{
  3.770812897815827*^9, {3.770813076430389*^9, 3.7708130850694027`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Example #2: many blocks", "Chapter",
 CellChangeTimes->{
  3.7708114064532833`*^9, {3.770812884909944*^9, 3.7708128852765217`*^9}, {
   3.770974201463663*^9, 3.770974205744076*^9}}],

Cell[BoxData[
 RowBox[{"m", "=", 
  InterpretationBox[
   TagBox[
    TooltipBox[
     PanelBox[
      GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggWIQGwI+2GOnH9gzYAW41JNqDqnmU8s9tHYnremBCofB
Zg6t089QSZ9DPb0N1/QzVMJ5sLlzuJY/g40eDR/q0iPNv6PhgJ8ezV9Dy530
pwEq/awd
        "], {{0, 0}, {12, 12}}, {0, 1}],
       Frame->Automatic,
       FrameLabel->{None, None},
       FrameTicks->{{None, None}, {None, None}},
       GridLinesStyle->Directive[
         GrayLevel[0.5, 0.4]],
       ImageSize->Tiny,
       Method->{
        "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> Automatic}],
      FrameMargins->Small],
     "\"Sun 30 Jun 2019 02:19:44\"",
     TooltipStyle->"TextStyling"],
    Annotation[#, "Sun 30 Jun 2019 02:19:44", "Tooltip"]& ],
   Uncompress[
   "1:eJztW82KE0EQzuZnkl0EZQ/iVfEBBPWyJ08i4mFZPHpwFzYwsBowK6JP49GDD+DZJ/\
ABPHsRRGQRjSaamcFkuqZ+uzuZJO4ehp1MVXV3/XxVXT1z9Whw0L/\
QaDSG7enlQTo8BXed7C67PEyfHA/7zX+3+4MXx8+K24x2/+T5MP0z/\
RtuTe9e5v8CYvoJEJPRVYidp7jk5uyJM6M5cb6EnGyYTC+P9m7cvHs7nf7XsF9cNRU/\
9aoD1acwjpjWH6bxfJZzhfHiJ4jGW0Dj+RiJaKgfpEpczRbUtALb7vD9lsu4wyoEXTgWC/\
hgJYdJEG7EEyQnQKy+CIMLURPJCbouzZnovSBitOuPHx3sBEvLlEFAqywzHhW/\
nwO4Rk1YiGqtvYIAvuNwjBEljpDoKZ5MyIVgsDsiqVsI9ZikbiPUEHMAcPdmWmOIXLkcuiPS6YUxjE\
jES7nBXmoA4FxfT3U5ME+\
F6btd5sCIvczNe328KqArDrsmhmsxHBpbSDBgqkYAcG9oHRG6IymGyH47ODxNB08PT/\
J5pkl1sj5OiID7SqlQ5lDXrbtlNsjx0ZRAP5hSIi07ASEB8K3PapNhPCIZhX0VPSKcqgZReywPWljA\
KhzM763STCphX5RWDJwZEqmSMLrkwioccudC1zYllhYy/\
iXW8YzCaPcX1GybmaBmTBid0gQ1Z3JKIL6NxAKH2OoOwtwPFtdBsCNxDT2HjjguneIEyFtoEblhNX+\
wHbcdNixZagtQiRqT/\
dN1aX9PaFXl6tzBBs1YavgdMwNqanpSWEDTBtJ2VilKtGEB1tCOuwbTTDXxRxgFIBSVvBBP2QTgUmS\
wUtOb2jwgW1fh0IMBk112TQyjPgPaQELbW9QUoxHA5txhVQ4rH9V9N3utV311We3PEeorc1dkPZpIc\
XxCyLUrcq4J8yo4oDc3X+uzsN9hvDrCzSUAf44G9GyuX8p6ju0XOqN7aE1zduFy/\
EI4QG8MLXGT6iDr6MaSjsGqvdvbkdK37DgxdRbbTYO322zL+\
zq7GEj9hqTGdtq07ASh7oKIAxXEO7ZQYRjfjz1rFnpEoWPfJdct9MI/\
IyMKdfnXoLocCLvfDOgE6Gfm0QvHNOPdC8fax0KT+I4yTFTCHrNVdLSZefTC6ca6rRd+Du/Lg/\
eLDpuLPQXbLaXzFtSvSGoM42nZFMZr/Gse9AzM3vPNCHsTz4xAjyhkBB6+mIwgQBUGla+\
V1tYJ24qYEeiZeWQEb6jKhYF9Tuh7FLXjzWJ6BZEQyu1CYbutb6YulO1dRCGmr7Dq93o/\
EXuHDHZczFs/D49b/hHtf7fLhWYNLWnMZo3fUXK/IupS61M3CifVic+XRbdYgn0WEwAjc+\
azmgNJJK9EtO1iYpHuPUUqvkN9mA/NKEeXuTI8HLfO925s3+Es5UjymtZSyzqS/BTU+\
nAX713jWo4kN9oR5aNG2+cpeq+p81WuUdU0kjUJEFyKNe1bBVvlB7Qzj5+\
V0k5NdfEKftoXoso2wwGDQwPQJchVf9AFjPUXL1+nNQ=="]]}]], "Input",
 CellLabelAutoDelete->False,
 CellChangeTimes->{
  3.7708247847926817`*^9, 3.7709576118354797`*^9, {3.815608738457636*^9, 
   3.8156087391954117`*^9}},
 CellLabel->"In[17]:="],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"ds2", ",", 
    RowBox[{"y", "\[Rule]", "m"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, {3.770805038034974*^9, 
   3.770805038115343*^9}, 3.770811959456465*^9, 3.770825028503538*^9, 
   3.7723238976610537`*^9},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"],

Cell["Diagonal blocks indices are given by ", "Text",
 CellChangeTimes->{{3.7708248507669497`*^9, 3.770824878106395*^9}, 
   3.7709581206867943`*^9, 3.8156087571048193`*^9}],

Cell[BoxData[
 RowBox[{"inds", "=", 
  RowBox[{"EntangledBlocksIndices", "[", "ds2", "]"}]}]], "Input",
 CellChangeTimes->{{3.770824879926669*^9, 3.7708248844560957`*^9}, {
   3.770825004380273*^9, 3.770825005312817*^9}, 3.7723238976846333`*^9, 
   3.815608790291031*^9}],

Cell["Now we proceed block-by-block ", "Text",
 CellChangeTimes->{{3.7708248957629213`*^9, 3.770824922801138*^9}}],

Cell[CellGroupData[{

Cell["Diagonal blocks", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}}],

Cell[CellGroupData[{

Cell["1", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, 3.770972053755866*^9, 
   3.772323897688415*^9, 3.8156087902994423`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "2", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "3", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "4", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}}],

Cell["\<\
Note that for 1\[Times]1 blocks we don\[CloseCurlyQuote]t need FactorOut as \
the eigenvalue of the matrix residue is simultaneously its only non-zero \
element.\
\>", "Text",
 CellChangeTimes->{{3.815608920643135*^9, 3.8156089841214733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897691824*^9}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.8156088174841347`*^9, 3.815608825444997*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["3", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.770972100305051*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.772323897700636*^9, 3.815608790322673*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "2", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "3", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "4", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897704876*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["4", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.770972100305051*^9, 
  3.7709721943032303`*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.772323897712844*^9, 
   3.815608790325468*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897716317*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["2,5,6", "Subsubsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.770972100305051*^9, {3.7709721943032303`*^9, 
   3.770972218794405*^9}}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.7709722147173862`*^9, 
   3.772323897723325*^9, 3.815608790328495*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "7", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "8", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "17", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "8", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "7", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "13", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "9", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "4", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "8", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "10", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "5", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "11", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "9", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "5", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "11", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "9", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}, 3.7709722110627823`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
      RowBox[{"-", "1"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770964958631016*^9, 3.770964992218898*^9}, {
  3.77096510294136*^9, 3.7709651061496*^9}, {3.770972258827325*^9, 
  3.770972262588004*^9}}],

Cell[BoxData[{
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", "[", "y", "]"}], "\[Epsilon]"], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7709723745611153`*^9, 3.770972404839038*^9}, {
  3.770972445975376*^9, 3.770972446599375*^9}}],

Cell[BoxData[
 RowBox[{"b", "[", "y", "]"}]], "Input",
 CellChangeTimes->{{3.770972337482954*^9, 3.7709723399044437`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897726927*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["9", "Subsubsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.770972100305051*^9, {3.7709721943032303`*^9, 
   3.770972218794405*^9}, 3.770972504593751*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "5", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.7709722147173862`*^9, 
   3.770972501041802*^9, 3.772323897734215*^9, 3.8156087903309603`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "2", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}, 3.7709722110627823`*^9, 3.7709725144946213`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897738268*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["7,11", "Subsubsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.770972100305051*^9, {3.7709721943032303`*^9, 
   3.770972218794405*^9}, 3.770972504593751*^9, 3.7709725510322313`*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "6", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.7709722147173862`*^9, 
   3.770972501041802*^9, 3.7709725456288347`*^9, 3.77232389774553*^9, 
   3.815608790333338*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "7", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}, 3.7709722110627823`*^9, 3.7709725144946213`*^9, 
   3.770972571361685*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
      RowBox[{"-", "1"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770964958631016*^9, 3.770964992218898*^9}, {
  3.77096510294136*^9, 3.7709651061496*^9}, {3.770972258827325*^9, 
  3.770972262588004*^9}}],

Cell[BoxData[{
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", "[", "y", "]"}], "\[Epsilon]"], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7709723745611153`*^9, 3.770972404839038*^9}, {
  3.770972445975376*^9, 3.770972446599375*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897748798*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["8,12", "Subsubsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.770972100305051*^9, {3.7709721943032303`*^9, 
   3.770972218794405*^9}, 3.770972504593751*^9, 3.7709725510322313`*^9, 
   3.770972617360093*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "7", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.7709722147173862`*^9, 
   3.770972501041802*^9, 3.7709725456288347`*^9, {3.770972610868066*^9, 
   3.7709726109140997`*^9}, 3.7723238977557583`*^9, 3.815608790335744*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "6", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "12", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "8", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "10", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "11", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}, 3.7709722110627823`*^9, 3.7709725144946213`*^9, 
   3.770972571361685*^9, 3.7709726318768587`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
      RowBox[{"-", "1"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770964958631016*^9, 3.770964992218898*^9}, {
  3.77096510294136*^9, 3.7709651061496*^9}, {3.770972258827325*^9, 
  3.770972262588004*^9}}],

Cell[BoxData[{
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", "[", "y", "]"}], "\[Epsilon]"], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7709723745611153`*^9, 3.770972404839038*^9}, {
  3.770972445975376*^9, 3.770972446599375*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897759345*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["10", "Subsubsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.770972100305051*^9, {3.7709721943032303`*^9, 
   3.770972218794405*^9}, 3.770972504593751*^9, 3.7709725510322313`*^9, 
   3.770972617360093*^9, 3.7709726720762157`*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "8", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds2", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, {3.770972053755866*^9, 
   3.7709720706329117`*^9}, 3.770972129129414*^9, 3.7709722147173862`*^9, 
   3.770972501041802*^9, 3.7709725456288347`*^9, {3.770972610868066*^9, 
   3.7709726109140997`*^9}, 3.770972666631469*^9, 3.772323897766965*^9, 
   3.815608790338711*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "2", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "3", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, 3.770972089922917*^9, {3.7709721386350718`*^9, 
   3.770972141864501*^9}, 3.7709722110627823`*^9, 3.7709725144946213`*^9, 
   3.770972571361685*^9, 3.7709726318768587`*^9, 3.77097268395245*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Factor", "@", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.770965001962882*^9, 3.770965013226116*^9}, {
  3.770972171353207*^9, 3.770972185576191*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897770583*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check", "Subsection",
 CellChangeTimes->{{3.770972874306334*^9, 3.770972874986761*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EFormQ", "[", 
    RowBox[{
     RowBox[{"ds2", "[", 
      RowBox[{"[", 
       RowBox[{"#", ",", "#"}], "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], 
   "&"}], "/@", "inds"}]], "Input",
 CellChangeTimes->{{3.770972876521245*^9, 3.770972898245771*^9}, 
   3.7723238977785273`*^9, 3.815608790341916*^9, {3.815609180293668*^9, 
   3.8156091917658167`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving intermediate results, quiting, and reloading", "Section",
 CellChangeTimes->{{3.7709741309192533`*^9, 3.770974183245389*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<ds2\>\"", ",", "ds2"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770974145455184*^9, 3.770974154136178*^9}, {
  3.7723238977816877`*^9, 3.772323897782263*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7709741696964293`*^9, 3.770974171561433*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<ds2\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770974189152519*^9, 3.7709741926484203`*^9}, 
   3.772323897785548*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Off-diagonal blocks", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}, {
  3.770972916482695*^9, 3.770972918608078*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Fuchsify", "[", 
   RowBox[{"ds2", ",", "y"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.770972920023385*^9, 3.770972942109729*^9}, {
   3.770973145782333*^9, 3.770973199380849*^9}, 3.770973865111812*^9, 
   3.772323897788734*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770973726398567*^9, 3.770973734182859*^9}, 
   3.772323897792302*^9}],

Cell[BoxData[
 RowBox[{"FuchsianQ", "[", 
  RowBox[{
   RowBox[{"ds2", "[", "y", "]"}], ",", "y"}], "]"}]], "Input",
 CellChangeTimes->{{3.770973736195867*^9, 3.770973740934424*^9}, 
   3.772323897799197*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Total factorization", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}, {
  3.770972916482695*^9, 3.770972918608078*^9}, {3.770973907934355*^9, 
  3.770973912294635*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"ds2", ",", "y", ",", "\[Epsilon]", ",", "1"}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770973913740584*^9, 3.77097396976466*^9}, 
   3.772323897803051*^9, 3.8156092371815233`*^9}],

Cell[BoxData["t"], "Input",
 CellChangeTimes->{3.770973945469932*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds2", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770973726398567*^9, 3.770973734182859*^9}, 
   3.772323897806388*^9}],

Cell[BoxData[
 RowBox[{"Factor", "[", "ds2", "]"}]], "Input",
 CellChangeTimes->{{3.7709739960378942`*^9, 3.7709739975009336`*^9}, 
   3.7723238978131647`*^9}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"ds2", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.770973977610623*^9, 3.770974003839628*^9}, 
   3.772323897819659*^9, {3.8156092519084063`*^9, 3.815609259272427*^9}}],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.815609280855438*^9, 3.815609281504293*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example #3: using notations instead of variable change", "Chapter",
 CellChangeTimes->{
  3.7708114064532833`*^9, {3.770812884909944*^9, 3.7708128852765217`*^9}, {
   3.770974201463663*^9, 3.770974205744076*^9}, {3.772323529483325*^9, 
   3.772323547418723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"m", "=", 
    InterpretationBox[
     TagBox[
      TooltipBox[
       PanelBox[
        GraphicsBox[RasterBox[CompressedData["
1:eJxTTMoPSmVmYGDggWIQGwIe2DNgBQMl/sEeO00t9UNdfKT5dzR8qCs+2MIH
l3sGG03r8KR1vAxUOAxUvIymZ/LcPxo+Ays+0OEx2MufwUaPhg9+mtbt/KFL
AwC2uEh/
          "], {{0, 0}, {12, 12}}, {0, 1}],
         Frame->Automatic,
         FrameLabel->{None, None},
         FrameTicks->{{None, None}, {None, None}},
         GridLinesStyle->Directive[
           GrayLevel[0.5, 0.4]],
         ImageSize->Tiny,
         Method->{
          "DefaultBoundaryStyle" -> Automatic, "DefaultPlotStyle" -> 
           Automatic}],
        FrameMargins->Small],
       "\"Wed 17 Jul 2019 10:43:01\"",
       TooltipStyle->"TextStyling"],
      Annotation[#, "Wed 17 Jul 2019 10:43:01", "Tooltip"]& ],
     Uncompress[
     "1:eJztXV+IVGUUn9mdGXd1zX+\
bGFhsEWURIZogIbH0IBESIvYQGGigtGApreEGEUv44FOETz4uISHUgwQ9BCH74IPUi/\
QgBj34YGZlICX+2b/tztTMfGd+3/l+37l3dmbvTA9L673n3O/8+51zvu/cu0++\
c2zfkYFcLjdaWPixZ2T0hPitd/G34sKP/SPvHR4dmV/470jP//+299jJwx+M5hd/\
rbuySLv36IejI3POzRUGZX6lhR8HXt66ffeOkYX/y8l7epx/kw8pk7A/\
hDQr3AfNNUojRJhZuKNBQL/\
otSt1IgLNzAPN9LiaideloJgFFAVBUQha16yPgkPnmrTytNkqL3nlweKVumUKJyxbsUxYf1PJvanU6\
ETL2LZJnN41cuVBfQs/9h06MXLs/\
UNHK1GlB92SeGMPvdAQFSECsaAkShfeCJDGv7R2QQcRPUWHQT7XGNHTetzOVwPOb7/\
yIpSAK7up4Fu+\
WwAJJKxothhjmga0VCGtJqG8MiV4uZcVrWRa9wCkWxIW2VO0S03ntszIvyLoOnr2CYowrRcGSARU8G\
DCOHX1WtVVJhQ14BwCKschOiB6wnWxv9RFviZBh5LaKkJGjRJVfvUHDbiMmwFDKdcb9IH7aoEyMkCY\
N5t+J2uW5vlSZjTWF4wBf6EcgMrV1ZUoEqKyMiDhz9bcfEvHBJSbn2a0WSbsa9RNhmCsC0rNBCVPE6\
u6D2HnTGs1ru7LqBJKQTlm9bCcim+\
NUD6g4LdPV0ey1igqyAyQGQbAGV3TIBY7JFQTHPtU2Nt2wH3Ama8uvgXb5ZkyrJADKSJQIs42SY4SK\
4fY/F8Cf+sAt3B7igKQw3+eKFGUOk8EXoWtBQvhGuGd+\
Gx4h86GghCZobbIEDM33bUYCrPnwa4c00ARK4QixPNmmiRHHysHBLb0wSu+\
7cyeszTCHYa2e7o0U1AaeqgnAG2B4juZrwH92aHNddw0fRSeiGiHxJ161hvXTBM5JXsaC++\
bFvWAvBdfa9QQIpLQPzfBBGQckqA2fiWjW0RoLpIW+\
SQZNwTshZ9T27dI8XWrrF1uu1OoUpP1oS6GikXjRo4QDGyALWNDSx8Xd+\
u4ToYKM2BHN2QiYRtmjOPuDh9AN8cZBBsd1wynPoZeLeyO0rnAczt482udI0cfkKPmLPIKm5Ard1/\
W9fF8dd3KTZtVj1MUeTZekaetdcrJNOuUnXoQoXJjG+\
MBiPC5fII6hUdLcKjcwExo4aBOUgDPH2O0gAjXWs2HmJW8DhvQQpmZuvvRLpieCIKzB6gbHTluAW0M\
AIb+c0w/oPrhF4XQFdcGUspJZt9mm+ocCuGQGgaKvcZmo/vL21bc/jIRbgtmb1vhD1l6b280/\
L7bY0wCn1m1gJi95c0oTBKgMwozrixUOj6nOhbC8s9nCMdChEPWvIqYFayOBZl54zKg0vJlMfOa0su\
N2e87spf03C5iAMiBdv2Yc0559wVdH69U1x1oNUxdxKV4Re6zZqPtaXYRQ/\
FdxKuMByDC79LsImZa3EVcYLSACCdAfjFjPtqs5jE//A56a7sDEXTELm2nw+2qejmgOiHSBt5y/\
51pAcxTKUPxWnmd1YokXKe6aSR2Gubtv2dAHxHeTFR8uwu3w6Y4XGBeJV9SwOikUF/\
tyIEK1ZUi7qgZnrQGMgznv49bo9qfBQ1RHVg4Cs5vrVGNEMQa1aFXUFD58BqjcUT4qFXjZWbiXSJE4\
j1PzfuWbMWXJCNeXUSqR6T+BgPgauOGLs09Rppd8dI8xUojn/VLPCJcoxGBSc0EGFQOfkVB74+\
BVPKz/yh/iUNJJZPHtYXG2GlmDdPrULCZqpbX6pdedC/7W+B2Kr8KDhkS82/\
kS7XLG3XvBxy5KBfabHKwNEWbqOp7xBdnlct/\
EHWZRZv0XkKK2lwWeONSIIsVBUV4fCfmDR7Qlyf23vbaNe9O68wfGXTkQPvs/nqsqNofxRW+\
G56m6dq7yvSgP9I9qCD800sYOFy+C3aqA/b6hLWXJERHB+\
bD5TdI41B178RMdN17ztoJX7HuiiNmp1S7R7bVwz3RbfUVRguI8LzVF3zNvUkL3gmjVqedbr/\
tYP5jjhzXgTbQK061U1ce85HD+DHf7xQFcPd4XsVwavxot+\
pKCuFvdIagU4u34PjvqPFh9L7oZdYtGlKLFVQRM7TjwqcWOk8xYSNUOjkQnSEWD2FNeeoAyAbmPHU9\
UZ4SzD5VPTIy6eXuRw9BDecJL0WEaODKnPT8O+qGIag9Vi8Fp+ud2pxlL+\
26rdYgkKMEGMadVFnS7hZdexeZRPqVtdXSoUyx1/\
7eaHtdZe3VkMKsA0iI2UekcagUNjwV3Wq9ZG21BtNstXal2WpN6r6AIJr6Pgl8mcPqC4jZCasvoDEs\
/4lEi3oqEfrdMaxginCnXh8AbTwAfhs61UHA4XcWFGA7XRugqjyYIp5VXUwh7FeDRLHXBHFkIZ61hY\
EFRHia1D7FzD+0ZWiZ/JY2+PME488I78dU60cy26R6RCQz9Hy+/\
yk6zDCf7jty8Y6WqLZGLx0jhqFq2e8asArRNXWTqaN/\
tdbRD1TIUGxzOt42B1nbSML9UZoOMBv0MjPU0Wt1EoQbJ6x1dKrvw/\
2V6pGFnjBRBUv5AiL0bwsa6uiS1RfAWGGohG7eRCFcITk9IOGhmy2UbLEmwj5yddd0Camv1d2nUV48\
/FS8arayqkFT1XawFgs/rjs5QraPrfh6LU18Zfskitk4YwuEb/5cZwBLtqqBzCrzosFD3kV+\
1Hx2m1TEUZNZ2nd8Q/\
BxS4eP2rCNqdYLwMcLROCCZ5ngY43VZcuX3WFb4GBiisCZE001KavpTurb7QaXyWdTnHf/\
xDZSyAnS2mAaFIqU2zJMWPBZVRDqxyVKPBm+i02N+CBC1KHw8bQsHdN9LwQ5JvqSWMgxA662OV1XS+\
4x1CshiNBcNJQvM6fQ4DWr5uHvEnc93VntthoH6M5qzx/\
Z4Mhxl8TDmoQ8Ro4LhYp1P1Fdt3LTDtXjFEL9O3+KBQb0LzAhC/xkBddnrE0mYmY+z0C2O6gfhqO+\
9Ly11f7CehiOmF1McytzUv/MG+qLJ5loRISX0xxEM49LdqevlweKb3LkGAJy+M/4/\
fvcCAn8mI8iZnGcUtHewaqUyk36Bw9NyUJiPp0sAvPUE6VoQ+\
9khn8R4W0rTCJmW6wwiZihd2T54QCh0uF/\
ojd5cwUidhDh6ekUN3nPeO1j2OT9QfXIyDSW649OIOPWj0peAIWDOY3d8uZEJo2B7R+\
TSrvz1BlOpG47dBtow/+JSH0LXd59TZhFrPvF6rqVm95U/Uch1D9YqFjga/\
01TGSBb6zt0Lk03xga8qrK0A5NFqMR/\
Ky1HTrTk2I7dD7NdmhY9wUEurk8EY2IcCjNdmiv1Re87VCbtDwi6rvD0UG8TzIcHXcaFRh33l1dt6k\
xCeB9UfV4vwVsXVD8ecSwNUck+9qeYMb+qQKKmf+\
l5qUckTbrBzFDB03mlmald2XdEellA59uuYzgc84Ln3FfVB92tSrXvb66buWmDaq5A9o2lctj8VA4a\
YVC81d5ETP9/ZjIcjlwQI3Q4RTjh4gQfR/RDHjmd2bg6YFOggrV44wvIELzUDxitt7qC2Vm4s9v+\
EOpOw2docTg1tWpTkPPQQnFTQ+tlbIZ6g1j1JtYnfLobIB6859tQLYzzGRPWHdG9D+\
zGMkMfYrSXNuOM4ZFUHvJmr0QM/85DIHb5Ex24Oi37UrwdpnJpr53v5Qz2ejrXBRhi2ayUV+RyL+\
iZrLRstvZ98NTr7WXBHgfD0y93mB8fCmnXrd4ZQwQJpt6LbrM/\
BVGO3nMKuW59o1R5EVx26i3dVylhvr18kkhRHmTKg4DrwIjnzMP9ft36RhnRQfbYdBN34E7YkTbLa+\
o75TH6yV+OKA7Fz0vQVs3TUNp4Ly6gAAPA+\
eU4OVeVrSSad2XwANbERaZVzTKD1LRMSgr9F63Yhu6d1YUuD1GJfd6nTjfGQ6bJGHWNpP9ajQUGxlR\
bWW/B7Cgsl6FWqyZ/ZNA1N30Ni2ZEwTC/wtgO6DN"]]}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"m1", "=", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"Get", "[", "\"\<Data/Mi\>\"", "]"}], "/.", 
       RowBox[{"d", "\[Rule]", 
        RowBox[{"4", "-", 
         RowBox[{"2", "\[Epsilon]"}]}]}]}], "]"}]}], ";"}], "*)"}]}]], "Input",\

 CellLabelAutoDelete->False,
 CellChangeTimes->{
  3.772323781642579*^9, {3.772323853542341*^9, 3.772323855215748*^9}, 
   3.7723239329804792`*^9},
 CellLabel->"In[3]:="],

Cell[BoxData[
 RowBox[{"NewDSystem", "[", 
  RowBox[{"ds3", ",", 
   RowBox[{"s", "\[Rule]", "m"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772323862437183*^9, 3.772323866562749*^9}, {
  3.772323937927767*^9, 3.772323955279415*^9}, {3.772357125783558*^9, 
  3.7723571305228853`*^9}}],

Cell[BoxData[
 RowBox[{"inds", "=", 
  RowBox[{"EntangledBlocksIndices", "[", "m", "]"}]}]], "Input",
 CellChangeTimes->{{3.7723239799504766`*^9, 3.772323998094427*^9}, 
   3.815608790371092*^9}],

Cell[CellGroupData[{

Cell["Diagonal blocks", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}, {
  3.7723571432980423`*^9, 3.772357146513815*^9}}],

Cell[CellGroupData[{

Cell["1,2,3", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, 3.770972053755866*^9, 
   3.772323897688415*^9, {3.772324003797068*^9, 3.772324004893931*^9}, 
   3.8156087904006433`*^9}],

Cell[BoxData[
 RowBox[{"b", "[", "]"}]], "Input",
 CellChangeTimes->{{3.772326182897685*^9, 3.77232618305182*^9}}],

Cell[TextData[{
 "While using visual tool below, we observe that there are \
\[OpenCurlyQuote]square root\[CloseCurlyQuote]  branching points at ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"s", "=", "0"}], "TI"], TraditionalForm]]],
 " anf ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"s", "=", "4"}], "TI"], TraditionalForm]]],
 ". Therefore, we have to make the change of variable. But first we reduce \
the eigenvalues as much as possible. "
}], "Text",
 CellChangeTimes->{{3.772324110114485*^9, 3.772324286285747*^9}, {
  3.7723567239274054`*^9, 3.772356724815312*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "s", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Highlighted", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "10", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "9", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "6", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "9", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "6", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "8", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "6", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, {3.772324012830203*^9, 3.772324018589448*^9}, 
   3.77232409766127*^9, {3.772324313198843*^9, 3.772324360349372*^9}, 
   3.815609384468732*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[TextData[{
 "As the number of \[OpenCurlyQuote]square root\[CloseCurlyQuote] points, 2, \
is less than 4 (cf. ",
 ButtonBox["arXiv:1707.07856, Section 4",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://arxiv.org/pdf/1707.07856v1.pdf#page=7"], None},
  ButtonNote->"https://arxiv.org/pdf/1707.07856v1.pdf#page=7"],
 "), we can use change of variable:"
}], "Text",
 CellChangeTimes->{{3.772324385680214*^9, 3.772324455556375*^9}, {
  3.772324488159134*^9, 3.772324520445197*^9}, {3.772324684412545*^9, 
  3.772324752866322*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"{", "sto\[Beta]", "}"}], "}"}], "=", 
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      SqrtBox[
       FractionBox[
        RowBox[{"s", "-", "4"}], "s"]], "==", "\[Beta]"}], ",", "s"}], 
    "]"}]}], ";", "sto\[Beta]"}]], "Input",
 CellChangeTimes->{{3.7723247552411013`*^9, 3.7723248248130503`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangeVar", "[", 
   RowBox[{"b", ",", "sto\[Beta]", ",", "\[Beta]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723248341218452`*^9, 3.772324851201679*^9}}],

Cell[TextData[{
 "NB: the second argument of ",
 StyleBox["VisTransformation",
  FontWeight->"Bold"],
 " below is the new variable \[Beta]."
}], "Text",
 CellChangeTimes->{{3.772324872128983*^9, 3.772324931124175*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "\[Beta]", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Highlighted", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "12", "}"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772324868521611*^9, 3.7723248687164497`*^9}, {
   3.7723249360290117`*^9, 3.7723249686069317`*^9}, 3.815609431229371*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "\[Beta]", ",", "\[Epsilon]", ",", 
      RowBox[{"1", "/", "2"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772326737295059*^9, 3.772326763400338*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723267858271503`*^9, 3.772326789264008*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "\[Beta]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723268437586813`*^9, 3.77232685362468*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"b", "[", "\[Beta]", "]"}], "\[Epsilon]"], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.772326837521332*^9, 3.772326841627441*^9}, {
  3.772326896016686*^9, 3.772326918010057*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";", 
  RowBox[{"b", "[", "\[Beta]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7723268704644117`*^9, 3.772326871541871*^9}}],

Cell["The overall transformation depends now on \[Beta] rather than s:", \
"Text",
 CellChangeTimes->{{3.772325038012836*^9, 3.7723250644505577`*^9}, {
  3.772356757573656*^9, 3.772356758671234*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.772325020877283*^9, 3.7723250321261263`*^9}}],

Cell[TextData[{
 "We can reduce the \[Beta] appearance using ",
 StyleBox["QuolyMod",
  FontWeight->"Bold"],
 " and ",
 StyleBox["RuleToNotation",
  FontWeight->"Bold"],
 " functions:"
}], "Text",
 CellChangeTimes->{{3.772325087491982*^9, 3.772325119340954*^9}, {
  3.772325173757201*^9, 3.772325190003542*^9}, {3.7723567611891317`*^9, 
  3.7723567620002327`*^9}}],

Cell[BoxData[
 RowBox[{"\[Beta]notation", "=", 
  RowBox[{"RuleToNotation", "[", 
   RowBox[{"sto\[Beta]", ",", "\[Beta]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772325193531804*^9, 3.77232519833489*^9}}],

Cell[TextData[{
 "The above line should be undestood as \[OpenCurlyDoubleQuote]\[Beta] is \
defined by the polynomial equation ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], "+", "s", "-", "s"}], "\[InvisibleComma]", 
    RowBox[{
     SuperscriptBox["\[Beta]", "2"], "=", "0"}]}], TraditionalForm]], "TI"],
 "\[CloseCurlyDoubleQuote]. \nNow we  can \[OpenCurlyQuote]mod out\
\[CloseCurlyQuote] any expression wrt the constraint ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], "+", "s", "-", "s"}], "\[InvisibleComma]", 
    RowBox[{
     SuperscriptBox["\[Beta]", "2"], "=", "0"}]}], TraditionalForm]], "TI"],
 "."
}], "Text",
 CellChangeTimes->{{3.772325211212348*^9, 3.7723253985399323`*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"QuolyMod", "[", 
   RowBox[{"t", ",", "\[Beta]notation"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772325121388711*^9, 3.7723251594469337`*^9}, {
  3.772325390622346*^9, 3.7723254012839813`*^9}}],

Cell["\<\
The result is necessarily the polynomial of \[Beta] with degree one less that \
that of the constraint (i.e., deg=1 in our case).\
\>", "Text",
 CellChangeTimes->{{3.772325411114785*^9, 3.772325492700822*^9}, {
  3.7723567663036633`*^9, 3.772356767034779*^9}}],

Cell[TextData[{
 "Now, instead of changing variable in the whole matrix ",
 StyleBox["ds3",
  FontWeight->"Bold"],
 ", we introduce the corresponding notation:"
}], "Text",
 CellChangeTimes->{{3.772325504516288*^9, 3.772325548277053*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"AddNotation", "[", 
   RowBox[{"ds3", ",", "\[Beta]notation"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772325550070547*^9, 3.77232556826129*^9}}],

Cell[BoxData[
 RowBox[{"Variables", "[", "ds3", "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"Notations", "[", "ds3", "]"}]], "Input",
 CellChangeTimes->{{3.772325571214954*^9, 3.772325575221417*^9}}],

Cell[TextData[StyleBox["NB: it is crucial to introduce notation before making \
transformation depending on it! Otherwise, Libra would assume \[Beta] is some \
parameter independent of s and will calculate wrongly D[t,s] and, therefore, \
the whole transformation!",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.77232558174918*^9, 3.772325720118617*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897691824*^9, {3.772325726374136*^9, 3.772325727037081*^9}}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.77232606706046*^9, 3.77232614523986*^9}, {
  3.772326255422538*^9, 3.7723262678781633`*^9}, {3.772326581560103*^9, 
  3.772326584147472*^9}, {3.7723269798016987`*^9, 3.7723269870920897`*^9}, {
  3.815609511130413*^9, 3.8156095114462833`*^9}}],

Cell[TextData[{
 "Note that the corresponding block now depends both on ",
 Cell[BoxData[
  FormBox["s", TraditionalForm]], "TI"],
 " and ",
 Cell[BoxData[
  FormBox["\[Beta]", TraditionalForm]], "TI"],
 ". The dependence on the latter parameter is confined to be first-order \
polynomial:"
}], "Text",
 CellChangeTimes->{{3.772327006840619*^9, 3.772327099577075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds3", "[", 
   RowBox[{"[", 
    RowBox[{"ii", ",", "ii"}], "]"}], "]"}], "[", "s", "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["4,5,6", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"b", ",", 
    RowBox[{"ds3", "[", 
     RowBox[{"[", 
      RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, 3.770972053755866*^9, 
   3.772323897688415*^9, {3.772324003797068*^9, 3.772324004893931*^9}, 
   3.7723271214948187`*^9, 3.7723273138911057`*^9, 3.8156087904309053`*^9}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772326182897685*^9, 3.77232618305182*^9}, {
  3.7723273172889023`*^9, 3.772327322041924*^9}}],

Cell[TextData[{
 "Note that there are apparent (fake) singularities at zeros of ",
 Cell[BoxData[
  RowBox[{"1", "-", 
   RowBox[{"5", " ", "\[Epsilon]"}], "-", 
   RowBox[{"s", " ", "\[Epsilon]"}], "+", 
   RowBox[{"4", " ", 
    SuperscriptBox["\[Epsilon]", "2"]}], "+", 
   RowBox[{"2", " ", "s", " ", 
    SuperscriptBox["\[Epsilon]", "2"]}]}]], "Output",
  CellChangeTimes->{{3.7723261834338093`*^9, 3.7723261979093933`*^9}, 
    3.7723266213643017`*^9, 3.7723266983504887`*^9, 3.7723271300020657`*^9}],
 ". Since this denominator is linear in s, we can treat it on general ground, \
even with the visual tool below."
}], "Text",
 CellChangeTimes->{{3.772324110114485*^9, 3.772324286285747*^9}, {
  3.772327161497426*^9, 3.7723272434415493`*^9}, {3.772356781815781*^9, 
  3.772356783615768*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "s", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Highlighted", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "7", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "4", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "7", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "3", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "5", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, {3.772324012830203*^9, 3.772324018589448*^9}, 
   3.77232409766127*^9, {3.772324313198843*^9, 3.772324360349372*^9}, {
   3.772327155548484*^9, 3.77232715570614*^9}, {3.77232728989557*^9, 
   3.7723272900594482`*^9}, {3.8156095407251377`*^9, 3.8156095428203077`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772327305710235*^9, 3.772327308465432*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "s", ",", "\[Epsilon]", ",", 
      RowBox[{"-", "2"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772326737295059*^9, 3.772326763400338*^9}, {
  3.772327351062901*^9, 3.7723273611385927`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723267858271503`*^9, 3.772326789264008*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723268437586813`*^9, 3.77232685362468*^9}, {
  3.772327375066725*^9, 3.772327375702917*^9}}],

Cell[BoxData[
 RowBox[{"b", "[", "s", "]"}]], "Input",
 CellChangeTimes->{{3.772328076798785*^9, 3.772328077504239*^9}}],

Cell["\<\
In order to simplify the numerical coefficients a bit, we will \
\[OpenCurlyQuote]shake\[CloseCurlyQuote] the system by diagonalizing residues:\
\>", "Text",
 CellChangeTimes->{{3.772328085407681*^9, 3.77232812956011*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"JDSpace", "[", 
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"b", "[", "s", "]"}], "\[Epsilon]"], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", 
         RowBox[{"-", "1"}], ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Transform", "[", 
  RowBox[{"b", ",", "t"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772326837521332*^9, 3.772326841627441*^9}, {
   3.772326896016686*^9, 3.772326918010057*^9}, {3.7723273794022217`*^9, 
   3.77232738206713*^9}, {3.772327421167574*^9, 3.772327426639797*^9}, 
   3.77232749022241*^9, {3.772327649324087*^9, 3.7723276605543756`*^9}, {
   3.772327996195079*^9, 3.772328015659075*^9}, {3.772328065609771*^9, 
   3.7723280729530983`*^9}, {3.772328164283163*^9, 3.772328164379632*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"JDSpace", "[", 
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"b", "[", "s", "]"}], "\[Epsilon]"], ",", 
       RowBox[{"{", 
        RowBox[{"s", ",", "0", ",", 
         RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Transform", "[", 
  RowBox[{"b", ",", "t"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772328142473268*^9, 3.77232814329701*^9}, {
  3.772328232473666*^9, 3.772328233208375*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.772325020877283*^9, 3.7723250321261263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897691824*^9, {3.772325726374136*^9, 3.772325727037081*^9}}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.77232606706046*^9, 3.77232614523986*^9}, {
   3.772326255422538*^9, 3.7723262678781633`*^9}, {3.772326581560103*^9, 
   3.772326584147472*^9}, {3.7723269798016987`*^9, 3.7723269870920897`*^9}, 
   3.815609610895419*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ds3", "[", 
   RowBox[{"[", 
    RowBox[{"ii", ",", "ii"}], "]"}], "]"}], "[", "s", "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["7", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9, 3.772328282984233*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"b", ",", 
    RowBox[{"ds3", "[", 
     RowBox[{"[", 
      RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, 3.770972053755866*^9, 
   3.772323897688415*^9, {3.772324003797068*^9, 3.772324004893931*^9}, 
   3.7723271214948187`*^9, 3.7723273138911057`*^9, 3.772328278120324*^9, 
   3.8156087904596786`*^9}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772326182897685*^9, 3.77232618305182*^9}, {
  3.7723273172889023`*^9, 3.772327322041924*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "s", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "2", "}"}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, {3.772324012830203*^9, 3.772324018589448*^9}, 
   3.77232409766127*^9, {3.772324313198843*^9, 3.772324360349372*^9}, {
   3.772327155548484*^9, 3.77232715570614*^9}, {3.77232728989557*^9, 
   3.7723272900594482`*^9}, {3.77232829039247*^9, 3.772328305162652*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772327305710235*^9, 3.772327308465432*^9}}],

Cell[BoxData[
 RowBox[{"b", "[", "]"}]], "Input",
 CellChangeTimes->{{3.772328315841332*^9, 3.772328315997908*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"HistoryConsolidate", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.772325020877283*^9, 3.7723250321261263`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897691824*^9, {3.772325726374136*^9, 3.772325727037081*^9}}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.77232606706046*^9, 3.77232614523986*^9}, {
  3.772326255422538*^9, 3.7723262678781633`*^9}, {3.772326581560103*^9, 
  3.772326584147472*^9}, {3.7723269798016987`*^9, 3.7723269870920897`*^9}, {
  3.81560964087738*^9, 3.815609641214362*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["8,9,10,11,12", "Subsubsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9, 3.772328374264062*^9}],

Cell[BoxData[{
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"b", ",", 
    RowBox[{"ds3", "[", 
     RowBox[{"[", 
      RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.770957696944641*^9, 3.770957715617127*^9}, {
   3.7709647870375547`*^9, 3.7709648135782948`*^9}, 3.770972053755866*^9, 
   3.772323897688415*^9, {3.772324003797068*^9, 3.772324004893931*^9}, 
   3.7723271214948187`*^9, 3.7723273138911057`*^9, 3.772328367639958*^9, 
   3.8156087904879217`*^9}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772326182897685*^9, 3.77232618305182*^9}, {
  3.7723273172889023`*^9, 3.772327322041924*^9}}],

Cell[TextData[{
 "Using visual tool, we see the \[OpenCurlyQuote]square \
root\[CloseCurlyQuote] branching points at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "2"}], "i"}]}], TraditionalForm]], "TI",
  FormatType->"TraditionalForm"],
 ". Again we first reduce to some extent other singular points."
}], "Text",
 CellChangeTimes->{{3.772328570056917*^9, 3.772328677307046*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "s", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "21", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "6", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"3", ",", "4", ",", "5"}], "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", 
          RowBox[{"16", ",", "17", ",", "18"}], "}"}]}]}], "}"}]}]}], "]"}]}],
   ";"}]], "Input",
 CellChangeTimes->{{3.770799467883355*^9, 3.770799474528536*^9}, {
   3.770800984117401*^9, 3.7708009864015303`*^9}, {3.7708012792196712`*^9, 
   3.770801327310852*^9}, {3.770802288099742*^9, 3.770802288403623*^9}, {
   3.770802674993848*^9, 3.7708026771649723`*^9}, {3.77080293253367*^9, 
   3.7708029326995173`*^9}, 3.770802982658104*^9, {3.770803035558392*^9, 
   3.770803041375576*^9}, 3.770803113971509*^9, {3.770803162906822*^9, 
   3.770803181297876*^9}, {3.770805061689267*^9, 3.770805061799082*^9}, {
   3.7708167778752203`*^9, 3.7708167798710127`*^9}, {3.7708169029071827`*^9, 
   3.770816907973838*^9}, {3.7708170334261627`*^9, 3.7708170367970743`*^9}, {
   3.770820789992216*^9, 3.770820817219198*^9}, 3.770822042379848*^9, {
   3.7708223580273743`*^9, 3.770822363209284*^9}, {3.7708233847324257`*^9, 
   3.770823392688232*^9}, {3.770823464867063*^9, 3.770823469888812*^9}, {
   3.7708239016651497`*^9, 3.770823946030402*^9}, 3.7708239944065113`*^9, {
   3.770824933070491*^9, 3.770825096367021*^9}, {3.7709648371972857`*^9, 
   3.770964841713417*^9}, {3.772324012830203*^9, 3.772324018589448*^9}, 
   3.77232409766127*^9, {3.772324313198843*^9, 3.772324360349372*^9}, {
   3.772327155548484*^9, 3.77232715570614*^9}, {3.77232728989557*^9, 
   3.7723272900594482`*^9}, {3.772328385519711*^9, 3.772328385671945*^9}, {
   3.772356515100363*^9, 3.772356515196218*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770964950818067*^9, 3.7709649565082073`*^9}}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772327305710235*^9, 3.772327308465432*^9}}],

Cell[TextData[{
 "We could have used the variable change ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    FractionBox[
     RowBox[{"s", "+", 
      RowBox[{"2", "i"}]}], 
     RowBox[{"s", "-", 
      RowBox[{"2", "i"}]}]]], TraditionalForm]], "TI",
  FormatType->"TraditionalForm"],
 ", similar to what we have had previously. But that would potentially \
introduce imaginary unit in the matrix.\nHere we choose another variable \
change, which also has square root branching points at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "2"}], "i"}]}], TraditionalForm]], "TI"],
 ". "
}], "Text",
 CellChangeTimes->{{3.772329591505375*^9, 3.772329735211987*^9}, {
  3.772329789708062*^9, 3.772329854484434*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"{", "sto\[Xi]", "}"}], "}"}], "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"4", "+", 
        SuperscriptBox["s", "2"]}]], "-", "s"}], "\[Equal]", 
     RowBox[{"2", "\[Xi]"}]}], ",", "s"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772328708908399*^9, 3.7723287445723553`*^9}, {
  3.772328851069765*^9, 3.772328893127059*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChangeVar", "[", 
   RowBox[{"b", ",", "sto\[Xi]", ",", "\[Xi]"}], "]"}], ";", 
  RowBox[{"Factor", "[", "b", "]"}]}]], "Input",
 CellChangeTimes->{{3.772328897149827*^9, 3.772328915271209*^9}}],

Cell[TextData[{
 "A special care is needed when the singular points belong to algebraic \
extension of ",
 Cell[BoxData[
  FormBox["\[DoubleStruckCapitalQ]", TraditionalForm]], "TI"],
 ". The reason is that those algebraic extensions may unnecessarily appear in \
the final matrix. In particular, in our present example we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{"2", "i"}], TraditionalForm]], "TI"],
 ", the root of ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SuperscriptBox["s", "2"], "+", "4"}], "=", "0"}], TraditionalForm]], 
  "TI"],
 ", and we would prefer that it does not appear in the transformation and in \
the final matrix.\nLibra has special tools for treating irreducible \
denominators, but here we will apply a poor man approach by choosing the \
balances in a \[OpenCurlyQuote]symmetric way\[CloseCurlyQuote] and hoping \
that the overall transformation will not depend on ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]], "TI"],
 ". "
}], "Text",
 CellChangeTimes->{{3.772329169089576*^9, 3.772329571771948*^9}, {
  3.784195789951303*^9, 3.784195818553906*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"b", ",", "\[Xi]", ",", "\[Epsilon]", ",", 
     RowBox[{"Log", "\[Rule]", "True"}], ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "5", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "15", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "25", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "20", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "15", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "21", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "20", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "1", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "15", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "21", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "20", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772328935688079*^9, 3.772328935848213*^9}, {
  3.772329021353837*^9, 3.772329021555395*^9}}],

Cell["Let us check if we are lucky and t is real:", "Text",
 CellChangeTimes->{{3.772329865643512*^9, 3.772329879116109*^9}, {
  3.784195837601799*^9, 3.784195837803426*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"ExpandNumerator", "@", 
    RowBox[{"ExpandDenominator", "@", 
     RowBox[{"Factor", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", "_Complex"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772329092621663*^9, 3.772329139081962*^9}}],

Cell["Yes, we are. So we apply the transformation:", "Text",
 CellChangeTimes->{{3.772329888371497*^9, 3.7723299009404182`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772329904151926*^9, 3.772329909084756*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"b", ",", "\[Xi]", ",", "\[Epsilon]", ",", 
      RowBox[{"-", "2"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772326737295059*^9, 3.772326763400338*^9}, {
  3.772327351062901*^9, 3.7723273611385927`*^9}, {3.772329918661388*^9, 
  3.772329918851349*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723267858271503`*^9, 3.772326789264008*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "\[Xi]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723268437586813`*^9, 3.77232685362468*^9}, {
  3.772327375066725*^9, 3.772327375702917*^9}, {3.772329932972748*^9, 
  3.772329934204445*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Transpose", "@", 
    RowBox[{"JDSpace", "[", 
     RowBox[{"SeriesCoefficient", "[", 
      RowBox[{
       FractionBox[
        RowBox[{"b", "[", "\[Xi]", "]"}], "\[Epsilon]"], ",", 
       RowBox[{"{", 
        RowBox[{"\[Xi]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Transform", "[", 
  RowBox[{"b", ",", "t"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772326837521332*^9, 3.772326841627441*^9}, {
   3.772326896016686*^9, 3.772326918010057*^9}, {3.7723273794022217`*^9, 
   3.77232738206713*^9}, {3.772327421167574*^9, 3.772327426639797*^9}, 
   3.77232749022241*^9, {3.772327649324087*^9, 3.7723276605543756`*^9}, {
   3.772327996195079*^9, 3.772328015659075*^9}, {3.772328065609771*^9, 
   3.7723280729530983`*^9}, {3.772328164283163*^9, 3.772328164379632*^9}, {
   3.772329947973559*^9, 3.772329995508903*^9}}],

Cell[BoxData[
 RowBox[{"\[Xi]notation", "=", 
  RowBox[{"RuleToNotation", "[", 
   RowBox[{"sto\[Xi]", ",", "\[Xi]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772330021017177*^9, 3.772330037454965*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"QuolyMod", "[", 
   RowBox[{
    RowBox[{"HistoryConsolidate", "[", "b", "]"}], ",", "\[Xi]notation"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.772325020877283*^9, 3.7723250321261263`*^9}, {
  3.77233004256588*^9, 3.772330052779829*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"AddNotation", "[", 
   RowBox[{"ds3", ",", "\[Xi]notation"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Variables", "[", "ds3", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Notations", "[", "ds3", "]"}]}], "Input",
 CellChangeTimes->{{3.772330059583726*^9, 3.7723300856212463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7709651173409758`*^9, 3.770965124085376*^9}, 
   3.772323897691824*^9, {3.772325726374136*^9, 3.772325727037081*^9}}],

Cell[BoxData["t"], "Input",
 CellChangeTimes->{3.7723569668526773`*^9}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.77232606706046*^9, 3.77232614523986*^9}, {
  3.772326255422538*^9, 3.7723262678781633`*^9}, {3.772326581560103*^9, 
  3.772326584147472*^9}, {3.7723269798016987`*^9, 3.7723269870920897`*^9}, {
  3.815609799020101*^9, 3.815609799361629*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check&Save ", "Subsection",
 CellChangeTimes->{{3.770972874306334*^9, 3.770972874986761*^9}, {
  3.772330375677033*^9, 3.772330377166651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EFormQ", "[", 
    RowBox[{
     RowBox[{"ds3", "[", 
      RowBox[{"[", 
       RowBox[{"#", ",", "#"}], "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], 
   "&"}], "/@", "inds"}]], "Input",
 CellChangeTimes->{{3.770972876521245*^9, 3.770972898245771*^9}, 
   3.7723238977785273`*^9, {3.7723301311174507`*^9, 3.772330148746615*^9}, 
   3.815608790516407*^9, {3.815609816637248*^9, 3.8156098176674623`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<Data/ds3.tmp\>\"", ",", "ds3"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772330287796657*^9, 3.772330302454739*^9}, 
   3.772330386758295*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Off-diagonal blocks", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}, {
  3.772330187585943*^9, 3.772330191636568*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<Data/ds3.tmp\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7723303659704227`*^9, 3.772330367174638*^9}, 
   3.772348655259068*^9, {3.772357471725184*^9, 3.7723574725566998`*^9}}],

Cell[BoxData[
 RowBox[{"obi", "=", 
  RowBox[{"OffDiagonalBlocksIndices", "[", "ds3", "]"}]}]], "Input",
 CellChangeTimes->{{3.772334966156795*^9, 3.772334967269269*^9}}],

Cell[TextData[{
 "Note that it is essential that off-diagonal blocks are reduced in a special \
order, e.g., as they appear in ",
 StyleBox["OffDiagonalBlocksIndices[ds3]",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.772335039540573*^9, 3.772335106739379*^9}}],

Cell[CellGroupData[{

Cell["{4,5,6},{1,2,3}", "Subsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9, 3.772328374264062*^9, 3.772334993413917*^9}],

Cell[BoxData[
 RowBox[{"block", "=", 
  RowBox[{"obi", "[", 
   RowBox[{"[", "1", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772334899717916*^9, 3.772334906740918*^9}, {
  3.772335019454109*^9, 3.772335026901423*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"FuchsifyBlock", "[", 
    RowBox[{"ds3", ",", "s", ",", "block"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7723301932096*^9, 3.7723302004053373`*^9}, {
  3.7723346111049013`*^9, 3.772334616245523*^9}, {3.772334714519557*^9, 
  3.772334716981462*^9}, {3.772334873661502*^9, 3.772334911805746*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", 
    RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772334918065421*^9, 3.772334946165504*^9}}],

Cell[BoxData[
 RowBox[{"FuchsianQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Flatten", "[", "block", "]"}], ",", 
      RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], "]"}], ",", "s"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7723351517960863`*^9, 3.7723351913978233`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["{7},{1,2,3}", "Subsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9, 3.772328374264062*^9, 3.772334993413917*^9, 
  3.772335128053673*^9}],

Cell[BoxData[
 RowBox[{"block", "=", 
  RowBox[{"obi", "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7723350333497868`*^9, 3.77233503489354*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"FuchsifyBlock", "[", 
    RowBox[{"ds3", ",", "s", ",", "block"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.772334953797348*^9, 3.772335139864097*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", 
    RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"FuchsianQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Flatten", "[", "block", "]"}], ",", 
      RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], "]"}], ",", "s"}], 
  "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["{8,9,10,11,12},{4,5,6}", "Subsection",
 CellChangeTimes->{3.7709649445311117`*^9, 3.7723239920420628`*^9, 
  3.77232712708176*^9, 3.772328374264062*^9, 3.772334993413917*^9, 
  3.772335128053673*^9, 3.7723352271815033`*^9}],

Cell[BoxData[
 RowBox[{"block", "=", 
  RowBox[{"obi", "[", 
   RowBox[{"[", "3", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7723350333497868`*^9, 3.77233503489354*^9}, 
   3.7723352202220984`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"FuchsifyBlock", "[", 
    RowBox[{"ds3", ",", "s", ",", "block"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.772334953797348*^9, 3.772335139864097*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", 
    RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{"FuchsianQ", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Flatten", "[", "block", "]"}], ",", 
      RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], "]"}], ",", "s"}], 
  "]"}]], "Input"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
{8,9,10,11,12},{1,2,3}: collision of notations, proceeding manually\
\>", "Subsection",
 CellChangeTimes->{
  3.7709649445311117`*^9, 3.7723239920420628`*^9, 3.77232712708176*^9, 
   3.772328374264062*^9, 3.772334993413917*^9, 3.772335128053673*^9, 
   3.7723352271815033`*^9, 3.77233528335818*^9, {3.772346666106559*^9, 
   3.772346676601626*^9}, {3.815610128429511*^9, 3.815610147663871*^9}}],

Cell[TextData[StyleBox["NB: Don\[CloseCurlyQuote]t rely on FuchsianQ when \
there are notations!",
 FontWeight->"Bold"]], "Text",
 CellChangeTimes->{{3.772346055974862*^9, 3.772346077055437*^9}}],

Cell[BoxData[
 RowBox[{"block", "=", 
  RowBox[{"obi", "[", 
   RowBox[{"[", "4", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7723350333497868`*^9, 3.77233503489354*^9}, 
   3.7723352202220984`*^9, 3.772335278670301*^9}],

Cell[TextData[{
 "As of the time this tutorial is written, FuchsifyBlock may treat at most \
one notation. Since block {1,2,3}\[Times]{1,2,3} uses \[Beta] and \
{8,9,10,11,12}\[Times]{8,9,10,11,12} uses \[Xi], in the off-diagonalblock \
both of them appear. Therefore, ",
 StyleBox["FuchsifyBlock",
  FontWeight->"Bold"],
 " fails:"
}], "Text",
 CellChangeTimes->{{3.772335289132799*^9, 3.772335421790318*^9}}],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"FuchsifyBlock", "[", 
   RowBox[{"ds3", ",", "s", ",", "block"}], "]"}]}]], "Input",
 CellChangeTimes->{3.772334953797348*^9, 3.772335139864097*^9, 
  3.772335424150196*^9}],

Cell[TextData[{
 "Therefore, we have to do it in a semi-manual way. We start by copying the \
corresponding submatrix. \n",
 StyleBox["Do not foget to copy notations!",
  FontWeight->"Bold"]
}], "Text",
 CellChangeTimes->{{3.7723362804169416`*^9, 3.772336303385796*^9}, {
  3.77233662030018*^9, 3.772336642035338*^9}, {3.7723371758549337`*^9, 
  3.772337187816106*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"b", ",", 
    RowBox[{"ds3", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{"Flatten", "@", 
        RowBox[{"Reverse", "@", "block"}]}], ",", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Reverse", "@", "block"}]}]}], "]"}], "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"AddNotation", "[", 
     RowBox[{"b", ",", "#"}], "]"}], "&"}], "/@", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Notations", "[", "ds3", "]"}], "/.", 
     RowBox[{"Association", "\[Rule]", "List"}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7723366441693172`*^9, 3.7723367096928663`*^9}, {
  3.7723369995758553`*^9, 3.772337079560547*^9}, {3.77233751502789*^9, 
  3.772337520266852*^9}}],

Cell["\<\
Both \[Beta] and \[Xi] enter the matrix at most to the first power since the \
corresponding polynomials are quadratic:\
\>", "Text",
 CellChangeTimes->{{3.772337390072044*^9, 3.772337465097352*^9}}],

Cell[BoxData[
 RowBox[{"Notations", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.8156099059911623`*^9, 3.815609906257093*^9}}],

Cell["We first examine denominators:", "Text",
 CellChangeTimes->{{3.772337201574725*^9, 3.7723372212874517`*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.772337266456414*^9, 3.772337271128275*^9}}],

Cell[CellGroupData[{

Cell["Denominator s", "Subsubsection",
 CellChangeTimes->{{3.77233763196987*^9, 3.772337632865672*^9}, {
   3.7723407730535*^9, 3.772340779669877*^9}, 3.7723408162138233`*^9}],

Cell["\<\
It is temptful to start with s=0. However, there is a problem here. Note that \
\[Beta]\[Rule]\[Infinity] when s\[Rule]0. Therefore, when we fuchsify other \
points (which requires \[Beta] in the numerator), we can spoil the behaviour \
at s=0. The same thing relates to s=\[Infinity] and \[Xi] (see below).\
\>", "Text",
 CellChangeTimes->{{3.772349330377533*^9, 3.7723493430132933`*^9}, {
   3.772349411589769*^9, 3.772349415141539*^9}, {3.772350354162796*^9, 
   3.772350502474822*^9}, 3.815609944337934*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Denominator ",
 Cell[BoxData[
  RowBox[{"4", "+", 
   SuperscriptBox["s", "2"]}]], "Output",
  CellChangeTimes->{3.772337271826338*^9, 3.772337525060894*^9, 
   3.772338573708045*^9, 3.772338917256874*^9}]
}], "Subsubsection",
 CellChangeTimes->{{3.77233763196987*^9, 3.772337632865672*^9}, {
  3.7723408209029627`*^9, 3.7723408246413937`*^9}}],

Cell["Nothing especially bad happens with \[Beta] and \[Xi]:", "Text",
 CellChangeTimes->{{3.77234099974297*^9, 3.7723410163352118`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{"#", "\[Equal]", "0"}], "]"}], "&"}], "/@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Values", "@", 
     RowBox[{"Notations", "[", "b", "]"}]}], "/.", 
    RowBox[{"s", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "2"}], "I"}]}]}], ")"}]}]], "Input",
 CellChangeTimes->{{3.772340856503087*^9, 3.7723408672152452`*^9}, {
  3.772341021216963*^9, 3.7723410411283484`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"den", "=", 
    RowBox[{"4", "+", 
     SuperscriptBox["s", "2"]}]}], ";"}], 
  RowBox[{"(*", "denominator", "*)"}]}]], "Input",
 CellChangeTimes->{{3.77234110433631*^9, 3.772341110432887*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", "2"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Poincare", " ", "rank"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.772337769426976*^9, 3.77233777021353*^9}, {
   3.772337809891388*^9, 3.7723378358365993`*^9}, {3.772340284236568*^9, 
   3.772340284659667*^9}, {3.772341060640473*^9, 3.77234106754489*^9}, 
   3.7723411128415813`*^9}],

Cell["\<\
Since den is quadratic in s, we allow for the first power of s also:\
\>", "Text",
 CellChangeTimes->{{3.772341132687298*^9, 3.772341150407743*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"IdentityMatrix", "@", 
    RowBox[{"Length", "@", "b"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cs", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "##"], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "3", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cs", ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "\[Beta]"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Xi]"}], "}"}]}], ")"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "s"}], "}"}]}], 
    SuperscriptBox["den", "r"]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.77233734940937*^9, 3.772337351144739*^9}, {
   3.772337646483283*^9, 3.7723376569393053`*^9}, {3.772337705914912*^9, 
   3.772337745772985*^9}, {3.772337799507983*^9, 3.772337807307684*^9}, {
   3.772337842657136*^9, 3.7723378444435453`*^9}, {3.7723379248936033`*^9, 
   3.7723379940989447`*^9}, {3.7723397576840153`*^9, 
   3.7723397578791313`*^9}, {3.772341096393302*^9, 3.772341126552506*^9}, {
   3.7723411658740053`*^9, 3.7723412189645357`*^9}, {3.815610271917746*^9, 
   3.815610302997913*^9}, 3.815610405310142*^9}],

Cell[TextData[{
 "We could have applied the transformation to the whole matrix, but it would \
take a lot of time. In this case even the principal part is too complicated \
for transformation, so we pick out only those terms which enter the \
equations:\nDiagonal blocks  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Proportional]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"4", "+", 
       SuperscriptBox["s", "2"]}], ")"}], 
     RowBox[{"-", "1"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "\nOff-diagonal block  ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Proportional]", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"4", "+", 
       SuperscriptBox["s", "2"]}], ")"}], 
     RowBox[{
      RowBox[{"-", "1"}], "-", "r"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.7723390095526533`*^9, 3.772339054935459*^9}, {
  3.772342026418106*^9, 3.772342171467326*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pp", "=", 
   FractionBox[
    RowBox[{"SeriesCoefficientMod", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "\[Rule]", "den"}], ",", 
        RowBox[{
         RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], 
    SuperscriptBox["den", 
     RowBox[{"r", "+", "1"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Pp", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "#"}], "]"}], " ", "]"}], "=", 
       FractionBox[
        RowBox[{"SeriesCoefficientMod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "#"}], "]"}], "]"}], "[", "s", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", "\[Rule]", "den"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "den"]}], ";"}], ")"}], 
    "&"}], "/@", 
   RowBox[{"EntangledBlocksIndices", "[", "b", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.772338147669401*^9, 3.7723382193180323`*^9}, {
   3.77233838121634*^9, 3.772338384288149*^9}, {3.772338541882962*^9, 
   3.772338554712153*^9}, 3.772338896906096*^9, {3.772338935538012*^9, 
   3.7723390066721697`*^9}, {3.772339057511689*^9, 3.772339087128676*^9}, {
   3.772339211247961*^9, 3.772339212025135*^9}, {3.772339278529503*^9, 
   3.772339299657112*^9}, {3.772342215756131*^9, 3.7723423087637377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ppnew", "=", 
   RowBox[{"Transform", "[", 
    RowBox[{"Pp", ",", "t", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", 
       RowBox[{"Notations", "[", "b", "]"}]}], "}"}], ",", 
     RowBox[{"UseFermat", "\[Rule]", "True"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772349069180591*^9, 3.772349072845375*^9}, {
   3.815610310420969*^9, 3.815610312756819*^9}, 3.815610413038699*^9, {
   3.8156105434938374`*^9, 3.815610544652026*^9}, {3.815610684166395*^9, 
   3.815610688483081*^9}, {3.8156107352062063`*^9, 3.815610744633954*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"SeriesCoefficientMod", "[", 
       RowBox[{"Ppnew", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "den"}], ",", 
          RowBox[{
           RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "\[Xi]", ",", "s"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772339689425517*^9, 3.772339692153479*^9}, {
   3.772341246377719*^9, 3.772341246689683*^9}, 3.772343243548685*^9, 
   3.772343284276713*^9, {3.77234905946922*^9, 3.772349066268715*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"csrules", "=", 
   RowBox[{"GaussSolve", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"Flatten", "[", "cs", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338247223514*^9, 3.772338289334742*^9}, {
   3.772338364903631*^9, 3.772338375640018*^9}, {3.772338585336307*^9, 
   3.772338585736146*^9}, 3.7723390998572607`*^9, {3.772339407369323*^9, 
   3.772339415827819*^9}, {3.772339529828095*^9, 3.772339530161354*^9}, {
   3.772339680939612*^9, 3.772339699367508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"t", "/.", "csrules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338297799165*^9, 3.77233831861438*^9}, {
   3.772338476712413*^9, 3.772338487887475*^9}, {3.772339120904426*^9, 
   3.772339125328498*^9}, 3.772339156977125*^9, {3.772339326934391*^9, 
   3.7723393475612307`*^9}, {3.772339811330138*^9, 3.772339813434909*^9}, 
   3.772342266781942*^9, 3.772342630056242*^9}],

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Alternatives", "@@", 
    RowBox[{"Flatten", "[", "cs", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772350915664028*^9, 3.7723509258349257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723384959740143`*^9, 3.772338508687653*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input"],

Cell["Now we repeat with r=1", "Text",
 CellChangeTimes->{{3.772343429979869*^9, 3.772343436924685*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Poincare", " ", "rank"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.772337769426976*^9, 3.77233777021353*^9}, {
   3.772337809891388*^9, 3.7723378358365993`*^9}, {3.772340284236568*^9, 
   3.772340284659667*^9}, {3.772341060640473*^9, 3.77234106754489*^9}, 
   3.7723411128415813`*^9, {3.772343439501212*^9, 3.7723434396050167`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"IdentityMatrix", "@", 
    RowBox[{"Length", "@", "b"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cs", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "##"], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "3", ",", "2", ",", "2", ",", "2"}], "}"}]}], "]"}]}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"cs", ".", 
         RowBox[{"{", 
          RowBox[{"1", ",", "\[Beta]"}], "}"}]}], ")"}], ".", 
       RowBox[{"{", 
        RowBox[{"1", ",", "\[Xi]"}], "}"}]}], ")"}], ".", 
     RowBox[{"{", 
      RowBox[{"1", ",", "s"}], "}"}]}], 
    SuperscriptBox["den", "r"]]}], ";"}]}], "Input",
 CellChangeTimes->{{3.77233734940937*^9, 3.772337351144739*^9}, {
  3.772337646483283*^9, 3.7723376569393053`*^9}, {3.772337705914912*^9, 
  3.772337745772985*^9}, {3.772337799507983*^9, 3.772337807307684*^9}, {
  3.772337842657136*^9, 3.7723378444435453`*^9}, {3.7723379248936033`*^9, 
  3.7723379940989447`*^9}, {3.7723397576840153`*^9, 3.7723397578791313`*^9}, {
  3.772341096393302*^9, 3.772341126552506*^9}, {3.7723411658740053`*^9, 
  3.7723412189645357`*^9}, {3.772343788208606*^9, 3.7723438066167994`*^9}, {
  3.772343870381804*^9, 3.772343871197379*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Pp", "=", 
   FractionBox[
    RowBox[{"SeriesCoefficientMod", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"s", "\[Rule]", "den"}], ",", 
        RowBox[{
         RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], 
    SuperscriptBox["den", 
     RowBox[{"r", "+", "1"}]]]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"Pp", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "#"}], "]"}], " ", "]"}], "=", 
       FractionBox[
        RowBox[{"SeriesCoefficientMod", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"b", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "#"}], "]"}], "]"}], "[", "s", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", "\[Rule]", "den"}], ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}], "den"]}], ";"}], ")"}], 
    "&"}], "/@", 
   RowBox[{"EntangledBlocksIndices", "[", "b", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.772338147669401*^9, 3.7723382193180323`*^9}, {
   3.77233838121634*^9, 3.772338384288149*^9}, {3.772338541882962*^9, 
   3.772338554712153*^9}, 3.772338896906096*^9, {3.772338935538012*^9, 
   3.7723390066721697`*^9}, {3.772339057511689*^9, 3.772339087128676*^9}, {
   3.772339211247961*^9, 3.772339212025135*^9}, {3.772339278529503*^9, 
   3.772339299657112*^9}, {3.772342215756131*^9, 3.7723423087637377`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Ppnew", "=", 
   RowBox[{"Transform", "[", 
    RowBox[{"Pp", ",", "t", ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", 
       RowBox[{
        RowBox[{"Notations", "[", "b", "]"}], "/.", 
        RowBox[{"Association", "\[Rule]", "List"}]}]}], "}"}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772343844912362*^9, 3.7723438490656977`*^9}, 
   3.7723509701741657`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"SeriesCoefficientMod", "[", 
       RowBox[{"Ppnew", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "den"}], ",", 
          RowBox[{
           RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "\[Xi]", ",", "s"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772339689425517*^9, 3.772339692153479*^9}, {
   3.772341246377719*^9, 3.772341246689683*^9}, 3.772343243548685*^9, 
   3.772343284276713*^9, {3.772343815104154*^9, 3.772343817560258*^9}, 
   3.772343857718252*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"csrules", "=", 
   RowBox[{"GaussSolve", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"Flatten", "[", "cs", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338247223514*^9, 3.772338289334742*^9}, {
   3.772338364903631*^9, 3.772338375640018*^9}, {3.772338585336307*^9, 
   3.772338585736146*^9}, 3.7723390998572607`*^9, {3.772339407369323*^9, 
   3.772339415827819*^9}, {3.772339529828095*^9, 3.772339530161354*^9}, {
   3.772339680939612*^9, 3.772339699367508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"t", "/.", "csrules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338297799165*^9, 3.77233831861438*^9}, {
   3.772338476712413*^9, 3.772338487887475*^9}, {3.772339120904426*^9, 
   3.772339125328498*^9}, 3.772339156977125*^9, {3.772339326934391*^9, 
   3.7723393475612307`*^9}, {3.772339811330138*^9, 3.772339813434909*^9}, 
   3.772342266781942*^9, 3.772342630056242*^9}],

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Alternatives", "@@", 
    RowBox[{"Flatten", "[", "cs", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.77234431075795*^9, 3.772344321027287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723384959740143`*^9, 3.772338508687653*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input"],

Cell[TextData[{
 "So, we have obtained the Fuchsian form at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", 
    RowBox[{
     RowBox[{"\[PlusMinus]", "2"}], "i"}]}], TraditionalForm]], "TI",
  FormatType->"TraditionalForm"],
 ". Good time to save"
}], "Text",
 CellChangeTimes->{{3.772340650554976*^9, 3.77234066174131*^9}, {
  3.772340693989373*^9, 3.772340735509844*^9}, {3.7723443824270687`*^9, 
  3.772344384762965*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<Data/b.tmp\>\"", ",", "b"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772340737542738*^9, 3.772340752598465*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["s\[RightArrow]\[Infinity]", "Subsubsection",
 CellChangeTimes->{{3.77233763196987*^9, 3.772337632865672*^9}, {
  3.7723408209029627`*^9, 3.7723408246413937`*^9}, {3.772344400822195*^9, 
  3.772344407745927*^9}}],

Cell[TextData[{
 "The limit s\[Rule]\[Infinity] should be analyzed with care. Notation \
\[Beta] goes to 1, but \[Xi] might go to \[Infinity] too. Threfore, we shoud \
better eliminate terms of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Xi]", "/", "s"}], TraditionalForm]], "TI"],
 "."
}], "Text",
 CellChangeTimes->{{3.772344432465476*^9, 3.772344608523163*^9}, 
   3.815611517573048*^9}],

Cell["However, there are no such terms: ", "Text",
 CellChangeTimes->{{3.772344873699238*^9, 3.772344903571411*^9}, {
  3.772351483639537*^9, 3.772351494960743*^9}}],

Cell[BoxData[
 RowBox[{"Factor", "@", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], ",", 
    "\[Xi]", ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772344804132473*^9, 3.77234485638029*^9}, {
  3.772345048892908*^9, 3.7723450498442287`*^9}, {3.772345211014307*^9, 
  3.772345212029673*^9}, {3.772345449799551*^9, 3.772345470455562*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Denominator s", "Subsubsection",
 CellChangeTimes->{{3.77233763196987*^9, 3.772337632865672*^9}, {
   3.7723407730535*^9, 3.772340779669877*^9}, 3.7723408162138233`*^9}],

Cell["\<\
We start from s=0. The idea is the following: we make a template matrix, \
apply the transformation and solve for the coefficients to reduce the pole \
order.\
\>", "Text",
 CellChangeTimes->{{3.772337318143634*^9, 3.772337338480411*^9}, 
   3.7723373715521708`*^9, {3.772337547897019*^9, 3.772337592314083*^9}}],

Cell[BoxData[
 RowBox[{"EntangledBlocksIndices", "[", "b", "]"}]], "Input",
 CellChangeTimes->{{3.772337710539867*^9, 3.7723377132987823`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"den", "=", "s"}], ";"}], 
  RowBox[{"(*", "denominator", "*)"}]}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", "1"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Poincare", " ", "rank"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.772337769426976*^9, 3.77233777021353*^9}, {
  3.772337809891388*^9, 3.7723378358365993`*^9}, {3.772340284236568*^9, 
  3.772340284659667*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"IdentityMatrix", "@", 
    RowBox[{"Length", "@", "b"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cs", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "##"], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "3", ",", "2", ",", "2"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "=", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"cs", ".", 
      RowBox[{"{", 
       RowBox[{"1", ",", "\[Beta]"}], "}"}]}], ")"}], ".", 
    RowBox[{"{", 
     RowBox[{"1", ",", "\[Xi]"}], "}"}]}], 
   SuperscriptBox["den", "r"]]}]}], "Input",
 CellChangeTimes->{{3.77233734940937*^9, 3.772337351144739*^9}, {
  3.772337646483283*^9, 3.7723376569393053`*^9}, {3.772337705914912*^9, 
  3.772337745772985*^9}, {3.772337799507983*^9, 3.772337807307684*^9}, {
  3.772337842657136*^9, 3.7723378444435453`*^9}, {3.7723379248936033`*^9, 
  3.7723379940989447`*^9}, {3.7723397576840153`*^9, 3.7723397578791313`*^9}, {
  3.772351526059064*^9, 3.772351526185795*^9}, {3.772351589107862*^9, 
  3.772351589253721*^9}}],

Cell["\<\
We could have applied the transformation to the whole matrix, but it would \
take a lot of time. So we apply it to the principal part of expansion:\
\>", "Text",
 CellChangeTimes->{{3.7723390095526533`*^9, 3.772339054935459*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pp", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficientMod", "[", 
        RowBox[{
         RowBox[{"b", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "den"}], ",", "k"}], "}"}]}], "]"}], 
       SuperscriptBox["den", "k"]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{
         RowBox[{"-", "r"}], "-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.772338147669401*^9, 3.7723382193180323`*^9}, {
   3.77233838121634*^9, 3.772338384288149*^9}, {3.772338541882962*^9, 
   3.772338554712153*^9}, 3.772338896906096*^9, {3.772338935538012*^9, 
   3.7723390066721697`*^9}, {3.772339057511689*^9, 3.772339087128676*^9}, {
   3.772339211247961*^9, 3.772339212025135*^9}, {3.772339278529503*^9, 
   3.772339299657112*^9}}],

Cell["Normal[Series[b[s],{s,0,-1}]] would have the same effect:", "Text",
 CellChangeTimes->{{3.772339302664171*^9, 3.7723393085757427`*^9}}],

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{"Pp", "-", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.77233921435679*^9, 3.772339215601062*^9}, {
  3.7723392494085817`*^9, 3.7723392509680967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"SeriesCoefficientMod", "[", 
       RowBox[{
        RowBox[{"Transform", "[", 
         RowBox[{"Pp", ",", "t", ",", 
          RowBox[{"{", 
           RowBox[{"s", ",", 
            RowBox[{
             RowBox[{"Notations", "[", "b", "]"}], "/.", 
             RowBox[{"Association", "\[Rule]", "List"}]}]}], "}"}]}], "]"}], 
        ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"s", "\[Rule]", "den"}], ",", 
          RowBox[{
           RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Beta]", ",", "\[Xi]"}], "}"}]}], "]"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.772339689425517*^9, 3.772339692153479*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"csrules", "=", 
   RowBox[{"GaussSolve", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"Flatten", "[", "cs", "]"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338247223514*^9, 3.772338289334742*^9}, {
   3.772338364903631*^9, 3.772338375640018*^9}, {3.772338585336307*^9, 
   3.772338585736146*^9}, 3.7723390998572607`*^9, {3.772339407369323*^9, 
   3.772339415827819*^9}, {3.772339529828095*^9, 3.772339530161354*^9}, {
   3.772339680939612*^9, 3.772339699367508*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"t", "/.", "csrules"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338297799165*^9, 3.77233831861438*^9}, {
   3.772338476712413*^9, 3.772338487887475*^9}, {3.772339120904426*^9, 
   3.772339125328498*^9}, 3.772339156977125*^9, {3.772339326934391*^9, 
   3.7723393475612307`*^9}, {3.772339811330138*^9, 3.772339813434909*^9}}],

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Alternatives", "@@", 
    RowBox[{"Flatten", "[", "cs", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772339815885457*^9, 3.772339827029333*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723384959740143`*^9, 3.772338508687653*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input"],

Cell[TextData[{
 "We might have thought that the system ",
 StyleBox["b",
  FontWeight->"Bold"],
 " is Fuchsian at s=0 now, but there is a subtle point here: when ",
 Cell[BoxData[
  FormBox[
   StyleBox["s", "TI"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " goes to zero  ",
 Cell[BoxData[
  FormBox[
   StyleBox["\[Beta]", "TI"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " goes to infinity. Therefore, terms of the form ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[Beta]", "/", "s"}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are not Fuchsian.  Thus, we eliminate them. Basically, this kind of \
complications resist the fully automated approach."
}], "Text",
 CellChangeTimes->{{3.772339868921549*^9, 3.7723399457623453`*^9}, {
  3.772339988346719*^9, 3.772340071604217*^9}, {3.772340141090624*^9, 
  3.772340149955511*^9}, {3.772340186131287*^9, 3.7723402522358227`*^9}}],

Cell["One way to see this is to examine our notations at s=0:", "Text",
 CellChangeTimes->{{3.7723408975021687`*^9, 3.772340923663192*^9}}],

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"Values", "@", 
    RowBox[{"Notations", "[", "b", "]"}]}], "/.", 
   RowBox[{"s", "\[Rule]", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772340926024908*^9, 3.772340931145*^9}}],

Cell["\<\
We see that the first notation corresponds to the equation -4==0, which has \
no solutions.\
\>", "Text",
 CellChangeTimes->{{3.7723409353424273`*^9, 3.7723409811354027`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", "=", "0"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{"Formal", " ", "Poincare", " ", "rank"}], "*)"}]}]], "Input",
 CellChangeTimes->{{3.772337769426976*^9, 3.77233777021353*^9}, {
  3.772337809891388*^9, 3.7723378358365993`*^9}, {3.772340263676437*^9, 
  3.772340274884184*^9}}],

Cell[BoxData[
 RowBox[{"Factor", "@", 
  RowBox[{"Coefficient", "[", 
   RowBox[{
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], ",", 
    "\[Xi]", ",", "1"}], "]"}]}]], "Input"],

Cell["\<\
Note that \[Xi] might go to -s or to 0 when s goes to \[Infinity]. Therefore, \
not to spoil infinity, we can not use \[Xi] upstairs\
\>", "Text",
 CellChangeTimes->{{3.7723517014347754`*^9, 3.772351760674345*^9}, {
  3.7723518324429207`*^9, 3.772351861386833*^9}, {3.772352073219801*^9, 
  3.772352073684135*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"IdentityMatrix", "@", 
    RowBox[{"Length", "@", "b"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"cs", "=", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["c", "##"], "&"}], ",", 
     RowBox[{"{", 
      RowBox[{"5", ",", "3", ",", "1"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "[", 
   RowBox[{"[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"4", ",", "5", ",", "6", ",", "7", ",", "8"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3"}], "}"}]}], "]"}], "]"}], "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"cs", "*", "\[Beta]"}], ")"}], ".", 
   RowBox[{"{", "1", 
    RowBox[{"(*", 
     RowBox[{",", "\[Xi]"}], " ", 
     RowBox[{"(*", 
      RowBox[{"not", " ", "allowed"}], "*)"}], "*)"}], "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.77233734940937*^9, 3.772337351144739*^9}, {
  3.772337646483283*^9, 3.7723376569393053`*^9}, {3.772337705914912*^9, 
  3.772337745772985*^9}, {3.772337799507983*^9, 3.772337807307684*^9}, {
  3.772337842657136*^9, 3.7723378444435453`*^9}, {3.7723379248936033`*^9, 
  3.7723379940989447`*^9}, {3.7723397576840153`*^9, 3.7723397578791313`*^9}, {
  3.772340302396496*^9, 3.7723403102292547`*^9}, {3.772340341492824*^9, 
  3.772340355924677*^9}, {3.772343096385372*^9, 3.772343104112247*^9}, {
  3.772351654082478*^9, 3.7723516660504227`*^9}, {3.772351865852112*^9, 
  3.772351867179409*^9}, {3.7723519046474657`*^9, 3.7723519268201647`*^9}}],

Cell[TextData[{
 "We could have applied the transformation to the whole matrix, but it would \
take a lot of time. So we apply it to the principal part of expansion.\n",
 StyleBox["NB:",
  FontWeight->"Bold"],
 " When ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"s", "\[Rule]", "0"}], "TI"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", \[Beta] grows as ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{
     RowBox[{"-", "1"}], "/", "2"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", so the terms ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Beta]", " ", 
     SuperscriptBox["s", "0"]}], "\[Proportional]", 
    SuperscriptBox["s", 
     RowBox[{
      RowBox[{"-", "1"}], "/", "2"}]]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " are irrelevant (smaller than ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{"-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "). "
}], "Text",
 CellChangeTimes->{{3.7723390095526533`*^9, 3.772339054935459*^9}, {
  3.772348797986566*^9, 3.772348950012992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Pp", "=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"SeriesCoefficientMod", "[", 
        RowBox[{
         RowBox[{"b", "[", "s", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"s", "\[Rule]", "den"}], ",", "k"}], "}"}]}], "]"}], 
       SuperscriptBox["den", "k"]}], ",", 
      RowBox[{"{", 
       RowBox[{"k", ",", 
        RowBox[{
         RowBox[{"-", "r"}], "-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ";"}], " "}]], "Input",
 CellChangeTimes->{{3.772338147669401*^9, 3.7723382193180323`*^9}, {
   3.77233838121634*^9, 3.772338384288149*^9}, {3.772338541882962*^9, 
   3.772338554712153*^9}, 3.772338896906096*^9, {3.772338935538012*^9, 
   3.7723390066721697`*^9}, {3.772339057511689*^9, 3.772339087128676*^9}, {
   3.772339211247961*^9, 3.772339212025135*^9}, {3.772339278529503*^9, 
   3.772339299657112*^9}}],

Cell["Normal[Series[b[s],{s,0,-1}]] would have the same effect:", "Text",
 CellChangeTimes->{{3.772339302664171*^9, 3.7723393085757427`*^9}}],

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{"Pp", "-", 
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"b", "[", "s", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"s", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.77233921435679*^9, 3.772339215601062*^9}, {
  3.7723392494085817`*^9, 3.7723392509680967`*^9}}],

Cell["Indeed, there are dangerous terms:", "Text",
 CellChangeTimes->{{3.772348773362097*^9, 3.772348791762663*^9}, {
  3.772348963906988*^9, 3.772348965555202*^9}}],

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{"Coefficient", "[", 
   RowBox[{"Pp", ",", "\[Beta]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.772348459307088*^9, 3.772348471583149*^9}, {
  3.772352030493248*^9, 3.7723520321481647`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{"CoefficientList", "[", 
     RowBox[{
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"SeriesCoefficientMod", "[", 
         RowBox[{
          RowBox[{"Transform", "[", 
           RowBox[{"Pp", ",", "t", ",", 
            RowBox[{"{", 
             RowBox[{"s", ",", 
              RowBox[{
               RowBox[{"Notations", "[", "b", "]"}], "/.", 
               RowBox[{"Association", "\[Rule]", "List"}]}]}], "}"}]}], "]"}],
           ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"s", "\[Rule]", "den"}], ",", 
            RowBox[{
             RowBox[{"-", "r"}], "-", "1"}]}], "}"}]}], "]"}], ",", 
        "\[Beta]"}], "]"}], ",", "\[Xi]"}], "]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772339689425517*^9, 3.772339692153479*^9}, {
   3.772340386109153*^9, 3.772340390147566*^9}, 3.7723430417152843`*^9, {
   3.772343089763997*^9, 3.772343089924097*^9}, {3.7723431300919456`*^9, 
   3.772343140709607*^9}}],

Cell["\<\
The fact that the equations are compatible comes out as a surprise:\
\>", "Text",
 CellChangeTimes->{{3.772352185148*^9, 3.772352215420789*^9}}],

Cell[BoxData[{
 RowBox[{"Length", "[", "eqs", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", 
  RowBox[{"Flatten", "@", "cs"}], "]"}]}], "Input",
 CellChangeTimes->{{3.772352218284855*^9, 3.7723522434618807`*^9}}],

Cell[BoxData[
 RowBox[{"csrules", "=", 
  RowBox[{"GaussSolve", "[", 
   RowBox[{"eqs", ",", 
    RowBox[{"Flatten", "[", "cs", "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.772338247223514*^9, 3.772338289334742*^9}, {
   3.772338364903631*^9, 3.772338375640018*^9}, {3.772338585336307*^9, 
   3.772338585736146*^9}, 3.7723390998572607`*^9, {3.772339407369323*^9, 
   3.772339415827819*^9}, {3.772339529828095*^9, 3.772339530161354*^9}, {
   3.772339680939612*^9, 3.772339699367508*^9}, 3.77235225242196*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Factor", "[", 
    RowBox[{"t", "/.", "csrules"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772338297799165*^9, 3.77233831861438*^9}, {
   3.772338476712413*^9, 3.772338487887475*^9}, {3.772339120904426*^9, 
   3.772339125328498*^9}, 3.772339156977125*^9, {3.772339326934391*^9, 
   3.7723393475612307`*^9}, {3.772339811330138*^9, 3.772339813434909*^9}, {
   3.77234318715547*^9, 3.772343188915625*^9}}],

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", 
   RowBox[{"Alternatives", "@@", 
    RowBox[{"Flatten", "[", "cs", "]"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772339815885457*^9, 3.772339827029333*^9}}],

Cell["Application will take some time:", "Text",
 CellChangeTimes->{{3.7723405656846447`*^9, 3.772340575164805*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723384959740143`*^9, 3.772338508687653*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723432022261953`*^9, 3.772343205384901*^9}, {
  3.772348987242082*^9, 3.772349001132155*^9}}],

Cell[TextData[{
 "Let us check if \[Beta] is absent in ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["s", 
    RowBox[{"-", "1"}]], TraditionalForm]], "TI",
  FormatType->"TraditionalForm"],
 " terms:"
}], "Text",
 CellChangeTimes->{{3.772340598492148*^9, 3.7723406373184147`*^9}}],

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"SeriesCoefficientMod", "[", 
    RowBox[{
     RowBox[{"b", "[", "s", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s", "\[Rule]", "den"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[Beta]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.772340582389632*^9, 3.772340591565797*^9}, {
  3.772349009773003*^9, 3.772349011499609*^9}}],

Cell["Let us check that we have not spoiled behaviour at \[Infinity]", "Text",
 CellChangeTimes->{{3.77235229733305*^9, 3.772352311157588*^9}}],

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{
     RowBox[{"b", "[", "s", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], ",", 
   "\[Xi]", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.772352331000145*^9, 3.7723523311339684`*^9}}],

Cell[TextData[{
 "So, we have obtained the Fuchsian form at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"s", "=", "1"}], TraditionalForm]], "TI",
  FormatType->"TraditionalForm"],
 ". Good time to save"
}], "Text",
 CellChangeTimes->{{3.772340650554976*^9, 3.77234066174131*^9}, {
  3.772340693989373*^9, 3.772340735509844*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"DumpSave", "[", 
   RowBox[{"\"\<Data/b.tmp\>\"", ",", "b"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772340737542738*^9, 3.772340752598465*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[Beta]\[RightArrow]\[Infinity],\[Xi]\[Rule]\[Infinity]", \
"Subsubsection",
 CellChangeTimes->{{3.77233763196987*^9, 3.772337632865672*^9}, {
  3.7723408209029627`*^9, 3.7723408246413937`*^9}, {3.772344400822195*^9, 
  3.772344407745927*^9}, {3.772347982126178*^9, 3.772347986551353*^9}, {
  3.772348248592252*^9, 3.7723482563364983`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Get", "[", "\"\<Data/b.tmp\>\"", "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723479517105618`*^9, 3.7723479639911423`*^9}}],

Cell["\<\
One might get an impression that we are done, but we should also consider the \
points where \[Xi] and/or \[Beta] go to \[Infinity]. Since \[Xi]\[Rule]\
\[Infinity] implies s\[Rule]\[Infinity], and \[Beta]\[Rule]\[Infinity] \
implies s\[Rule]0, we seem to be done.\
\>", "Text",
 CellChangeTimes->{{3.772348018510975*^9, 3.772348112855719*^9}, {
  3.772348210609169*^9, 3.772348235168373*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Consolidating and applying", "Subsubsection",
 CellChangeTimes->{{3.772345963654255*^9, 3.7723459699987993`*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{"b", ",", "s"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"t", "=", 
    RowBox[{"HistoryConsolidate", "[", "b", "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7723461061889*^9, 3.772346117032255*^9}}],

Cell[BoxData[
 RowBox[{"MatrixPlot", "[", "t", "]"}]], "Input",
 CellChangeTimes->{{3.772346123566173*^9, 3.772346126640151*^9}}],

Cell["Now we apply the transformation to ds3", "Text",
 CellChangeTimes->{{3.772346135197721*^9, 3.7723461477517023`*^9}}],

Cell[TextData[{
 StyleBox["NB:",
  FontWeight->"Bold"],
 " when creating the matrix ",
 StyleBox["b",
  FontWeight->"Bold"],
 ", we used ",
 StyleBox["Flatten@Reverse@block",
  FontWeight->"Bold"],
 " to have a familiar lower-triangular form (pay attention to ",
 StyleBox["Reverse",
  FontWeight->"Bold"],
 "). Therefore, we use the same when applying the overall transformation:"
}], "Text",
 CellChangeTimes->{{3.7723462309512873`*^9, 3.772346305816329*^9}, {
  3.772346354249083*^9, 3.772346408387713*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t", ",", 
    RowBox[{"Flatten", "@", 
     RowBox[{"Reverse", "@", "block"}]}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.772346201538227*^9, 3.772346209177084*^9}, {
  3.772346413786223*^9, 3.7723464733851843`*^9}}],

Cell[BoxData[
 RowBox[{"DenominatorsInfo", "[", 
  RowBox[{
   RowBox[{"ds3", "[", 
    RowBox[{"[", 
     RowBox[{
      RowBox[{"Flatten", "[", "block", "]"}], ",", 
      RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], "]"}], ",", "s"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.772346565564107*^9, 3.7723465855060997`*^9}}],

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ds3", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"Flatten", "[", "block", "]"}], ",", 
         RowBox[{"Flatten", "[", "block", "]"}]}], "]"}], "]"}], "[", "s", 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "\[Beta]"}], "]"}]], "Input",\

 CellChangeTimes->{{3.772340582389632*^9, 3.772340591565797*^9}, {
  3.772349009773003*^9, 3.772349011499609*^9}, {3.772352464175665*^9, 
  3.7723524754071503`*^9}}],

Cell["Let us check that we have not spoiled behaviour at \[Infinity]", "Text",
 CellChangeTimes->{{3.77235229733305*^9, 3.772352311157588*^9}}],

Cell[BoxData[
 RowBox[{"Coefficient", "[", 
  RowBox[{
   RowBox[{"SeriesCoefficient", "[", 
    RowBox[{
     RowBox[{"b", "[", "s", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"s", ",", "\[Infinity]", ",", "1"}], "}"}]}], "]"}], ",", 
   "\[Xi]", ",", "1"}], "]"}]], "Input",
 CellChangeTimes->{{3.772352331000145*^9, 3.7723523311339684`*^9}, {
  3.772352486521222*^9, 3.772352489225074*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Saving", "Subsection",
 CellChangeTimes->{{3.7723466549209023`*^9, 3.772346656073421*^9}}],

Cell[BoxData[
 RowBox[{"DumpSave", "[", 
  RowBox[{"\"\<Data/ds3.tmp1\>\"", ",", "ds3"}], "]"}]], "Input",
 CellChangeTimes->{{3.772346591459978*^9, 3.7723466347385187`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall factorization", "Section",
 CellChangeTimes->{{3.770964757529117*^9, 3.770964761859424*^9}, {
  3.772330187585943*^9, 3.772330191636568*^9}, {3.772346691161604*^9, 
  3.772346698393094*^9}}],

Cell["\<\
Since we have notations, it is not safe to use FactorOut. It is better to \
rely on the approach which also works for multivariate setup: sampling and \
factoring out dependence.\
\>", "Text",
 CellChangeTimes->{{3.77234670480424*^9, 3.772346789666396*^9}}],

Cell["\<\
Ok, so we get samples in a few points . But we have to substitute notations\
\>", "Text",
 CellChangeTimes->{{3.772346798969966*^9, 3.772346837194121*^9}}],

Cell[BoxData[
 RowBox[{"Get", "[", "\"\<Data/ds3.tmp1\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7723468612927628`*^9, 3.772346862180275*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Beta]\[Xi]coefs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Coefficient", "[", 
      RowBox[{
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"ds3", "[", "s", "]"}], ",", "\[Beta]", ",", "#1"}], "]"}], 
       ",", "\[Xi]", ",", "#2"}], "]"}], "&"}], "@@@", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.772347419052957*^9, 3.7723474523090982`*^9}, {
  3.7723474852789383`*^9, 3.772347640863776*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"samples", "=", 
   RowBox[{"Flatten", "[", 
    RowBox[{
     RowBox[{"\[Beta]\[Xi]coefs", "/.", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"s", "\[Rule]", "#"}], "}"}], "&"}], "/@", 
        RowBox[{"RandomInteger", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"5", ",", "30"}], "}"}], ",", "3"}], "]"}]}], ")"}]}], ",",
      "1"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7723469773154783`*^9, 3.7723470905503273`*^9}, 
   3.772347201002409*^9, {3.772347322165165*^9, 3.77234733149376*^9}, 
   3.772347565327044*^9, {3.772347657967223*^9, 3.7723476864625587`*^9}, {
   3.772352519503426*^9, 3.77235253176751*^9}}],

Cell["\<\
There should be a transformation which eliminates \[Epsilon] from samples/\
\[Epsilon], and we can search for it useing FactorDependence:\
\>", "Text",
 CellChangeTimes->{{3.772347103427183*^9, 3.772347149395689*^9}, 
   3.7723473268287687`*^9}],

Cell[BoxData[
 RowBox[{"Variables", "[", "samples", "]"}]], "Input",
 CellChangeTimes->{{3.772347308783202*^9, 3.772347312217992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorDependence", "[", 
     RowBox[{
      RowBox[{"samples", "/", "\[Epsilon]"}], ",", "\[Epsilon]", ",", 
      RowBox[{"-", "3"}]}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";", 
  RowBox[{"Factor", "[", 
   RowBox[{"Det", "[", "t", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7723471514302273`*^9, 3.772347194811975*^9}, {
  3.772347259198061*^9, 3.772347259548814*^9}, {3.772347702240306*^9, 
  3.7723477024226437`*^9}, {3.772352578120863*^9, 3.772352632216031*^9}, {
  3.815612115754911*^9, 3.8156121586071167`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds3", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723472198019037`*^9, 3.77234722058237*^9}, {
  3.7723526471601143`*^9, 3.772352653319353*^9}}],

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"ds3", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7723526576382227`*^9, 3.772352664056134*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Unprotect", "[", "ds3", "]"}], ";", 
  RowBox[{"Save", "[", 
   RowBox[{"\"\<Data/ds3.res\>\"", ",", "ds3"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7723527327515163`*^9, 3.772352759168372*^9}}],

Cell[BoxData[
 RowBox[{"Quit", "[", "]"}]], "Input",
 CellChangeTimes->{{3.772352705815805*^9, 3.7723527079922647`*^9}, {
  3.772352765137888*^9, 3.772352766759997*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check", "Section",
 CellChangeTimes->{{3.7723571863775578`*^9, 3.7723571872653313`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Get", "[", "\"\<Data/ds3.res\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"ds3", "[", "s", "]"}]}], "Input",
 CellChangeTimes->{{3.772352777232985*^9, 3.772352785072853*^9}}],

Cell[BoxData[
 RowBox[{"Notations", "[", "ds3", "]"}]], "Input",
 CellChangeTimes->{{3.772355606872382*^9, 3.772355608410595*^9}, 
   3.7723573728443193`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"T", "=", 
   RowBox[{"HistoryConsolidate", "[", "ds3", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7723586744908457`*^9, 3.7723586910198317`*^9}}],

Cell[BoxData[
 RowBox[{"Put", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"T", ",", 
     RowBox[{"Notations", "[", "ds3", "]"}]}], "}"}], ",", 
   "\"\<Data/ds3Transformation&Notations\>\""}], "]"}]], "Input",
 CellChangeTimes->{{3.772358693381337*^9, 3.772358751635646*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example #4: Irreducible and ugly denominators.", "Chapter",
 CellChangeTimes->{
  3.7708114064532833`*^9, {3.770812884909944*^9, 3.7708128852765217`*^9}, {
   3.770974201463663*^9, 3.770974205744076*^9}, {3.772323529483325*^9, 
   3.772323547418723*^9}, {3.815195055878508*^9, 3.815195071430271*^9}}],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.8151954743969727`*^9, 3.815195474973946*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"m", "=", 
   InterpretationBox[
    TagBox[
     TooltipBox[
      PanelBox["\<\"3\[Times]3 block with ugly denominator\"\>",
       FrameMargins->Small],
      "\"Tue 24 Nov 2020 15:30:04\"",
      TooltipStyle->"TextStyling"],
     Annotation[#, "Tue 24 Nov 2020 15:30:04", "Tooltip"]& ],
    Uncompress[
    "1:eJztWr1OG0EQdnxw2FZERUFBQd7AUqCJqKMUFFZEQUERRQLFUiIiDIoUUeQR8gAp8ggpeYQ\
8QZQyJUpFgRBCweGOFbJ3/c3s7NweP2YpLM7e+WZ359v5bubu2dvd1ztZo9EYzBQf6/\
3BvnM1V17NFh8b/Q/bg/7/4m+nefNdb/fT9p65LA167w/MiMGT4uozGkz/\
4sCU44IGY0fllxCgzQCYpZ6Rs2+\
S7mYATqu8zIuPrRfd5y9Xzf6Ofj5m3TCGLXYW44bOhJ4Cw9FoszrH1yK7wYFgyD/\
aPghmgrkwQTnJItGMzei/\
ZBBQRGnsHIymT0ELjL4ojw8ddD4QjOE3MVvEHnPe8IJdN8NPAQtcX92gs+\
oB22xW4Kd8Znk4GPKPqITBnG1GgR0zyYD/P0PlNiOwr5eyM1dxZp5tRmA05T3bfA3WtsGWJ014xTT/\
3oU6sgmVFBVqSS6Aky6SKtuGU6DK/\
ujRmhA1eicpekGa1bLBvkyaaG7yMy9MzWkMMTClsXQQPGnMLoAdOR+\
hgMPgK3YB8StzfiIWIew15f2NhTv4n5CkZnTGM4pnPGMI0oiMioobbGnVKAJD/\
uU5OaWUKUopuYUYQVtTAy0Rsgoh7QYait5pUPL/FdRAo7HpnImaZfN8gH9rmbEiZobYo6dZNs+um+\
HiWjh9PsZslr1rRmyW0TNTaDnaGXWz7BVvgrpI37XbjMB+\
kP0tRbOMnpmiWYZ2Rt4scx4vjUyAHI7fMNdxJ129ekya+JA10a77Ojb+EHdJ71HdJ8OCPJb2gF0Rs/\
meAUc0q1GW5Us9RLk6moA8leKegaOYWlytCZhy2RTlMqdrhQJMJbN7WHXGezAVlgzTaZiO0+\
Cvdukn60in6FijiNLYYdVuhw+w+tWQQ3Y1dbwa0mHXzXBxKZw+\
vZhcPNaWYWEzU1S7aGfU1a7i1ZA32m2Gr4aQYIpql57Zrb8a4lS7YDEPSZWTOj4WdQx7ECh97uXDDl\
PHdk3MGGrVkfboUcc2u26Giwvh9DmPWX/+\
FN4WVZyZQh3RzqjV0XPkkWx0Sf8KdaQ7rgp1pGemUEc6GQnU8QpAiMy5"]]}], ";"}]], "Input",\

 CellLabelAutoDelete->False,
 CellChangeTimes->{{3.815195404195999*^9, 3.8151954193510017`*^9}},
 CellLabel->"In[44]:="],

Cell[BoxData[
 RowBox[{"NewDSystem", "[", 
  RowBox[{"ds4", ",", 
   RowBox[{"z", "\[Rule]", "m"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.772323862437183*^9, 3.772323866562749*^9}, {
   3.772323937927767*^9, 3.772323955279415*^9}, {3.772357125783558*^9, 
   3.7723571305228853`*^9}, {3.815195469182392*^9, 3.815195469502248*^9}, 
   3.8151955312783012`*^9}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "ds4", "]"}]], "Input",
 CellChangeTimes->{3.815195492542198*^9}],

Cell["\<\
The last denominator is ugly: it depends both on z and \[Epsilon]. It should \
be possible to eliminate it.\
\>", "Text",
 CellChangeTimes->{{3.8151955441425*^9, 3.815195604733862*^9}}],

Cell[CellGroupData[{

Cell["Getting rid of ugly denominator", "Subsection",
 CellChangeTimes->{{3.815195610805582*^9, 3.8151956176214647`*^9}}],

Cell[BoxData[
 RowBox[{"den", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Denominators", "[", "ds4", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], ",", "z", ",", "Factor"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.8043863422242928`*^9, 3.804386344318136*^9}, {
  3.8151956364538813`*^9, 3.8151956388376303`*^9}, {3.815196827415759*^9, 
  3.815196833655159*^9}}],

Cell["\<\
We need mod versions of SeriesCoefficient and similar function. For example, \
we can start with determining the order of poles \
\>", "Text",
 CellChangeTimes->{{3.81519570855725*^9, 3.815195788141246*^9}}],

Cell[BoxData[
 RowBox[{"LeadingOrderMod", "[", 
  RowBox[{
   RowBox[{"ds4", "[", "z", "]"}], ",", 
   RowBox[{"z", "\[Rule]", "den"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.815195790400844*^9, 3.815195808253552*^9}}],

Cell["\<\
Ok, this is a simple pole. Let us find the eigenvalues of matrix residues: \
\>", "Text",
 CellChangeTimes->{{3.815195814261503*^9, 3.815195842733007*^9}}],

Cell[BoxData[
 RowBox[{"EValuesMod", "[", 
  RowBox[{
   RowBox[{"SeriesCoefficientMod", "[", 
    RowBox[{
     RowBox[{"ds4", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"z", "\[Rule]", "den"}], ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", 
   RowBox[{"z", "\[Rule]", "den"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.815195674334013*^9, 3.815195682469571*^9}}],

Cell[TextData[{
 "From now on, to avoid keystrokes, we will use ",
 StyleBox["NotationsBlock",
  FontWeight->"Bold"],
 " to indicate which polynomial is use  to mod out. For exmaple, the above \
commands can be replaced with"
}], "Text",
 CellChangeTimes->{{3.8151958546975403`*^9, 3.8151959270291767`*^9}}],

Cell[BoxData[
 RowBox[{"NotationsBlock", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", "den"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{"LeadingOrderMod", "[", 
      RowBox[{
       RowBox[{"ds4", "[", "z", "]"}], ",", "z"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"EValuesMod", "[", 
      RowBox[{
       RowBox[{"SeriesCoefficientMod", "[", 
        RowBox[{
         RowBox[{"ds4", "[", "z", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "z"}], "]"}]}], ";"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8151959344864902`*^9, 3.815195972461506*^9}}],

Cell["\<\
Now, let us find the \[OpenCurlyDoubleQuote]eigenvector\
\[CloseCurlyDoubleQuote], corresponding to nonzero eigenvalue. It should be \
the first one:\
\>", "Text",
 CellChangeTimes->{{3.815195984996868*^9, 3.815196034525023*^9}, {
  3.815196086973606*^9, 3.815196093357806*^9}}],

Cell[BoxData[
 RowBox[{"NotationsBlock", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", "den"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"vs", "=", 
    RowBox[{
     RowBox[{"ESpaceMod", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"SeriesCoefficientMod", "[", 
         RowBox[{
          RowBox[{"ds4", "[", "z", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", "z"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"{", "1", "}"}], "]"}], "]"}]}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.804386349019449*^9, 3.80438645682012*^9}, {
  3.8043865392144737`*^9, 3.804386544366597*^9}, {3.815196022669488*^9, 
  3.815196072542614*^9}}],

Cell[TextData[{
 "It happened so that this vector does depend on z, but in general, it will \
be the (n-1)-th order polynomial in z, where n is the degree of ",
 StyleBox["den",
  FontWeight->"Bold"],
 ". So, we proceed further as if vs depended on z . "
}], "Text",
 CellChangeTimes->{{3.815196098653582*^9, 3.815196221470192*^9}, {
  3.8151962561024723`*^9, 3.8151962784783297`*^9}}],

Cell["\<\
The idea is to balance the ugly denominator with \[Infinity], perhaps, at the \
expense of worsening the system\[CloseCurlyQuote]s properties at \[Infinity]. \
Leter on we will fix these properties by applying further transformations. \
However, we\[CloseCurlyQuote]d better do our best not to spoil the properties \
to much, otherwise, we can get stuck due to computational problems (e.g., \
time and/or memory restriction). For example, we find here  an appropriate \
subspace for the residue at z=0:\
\>", "Text",
 CellChangeTimes->{{3.8151962812624702`*^9, 3.8151965769744253`*^9}}],

Cell[BoxData[
 RowBox[{"us", "=", 
  RowBox[{
   RowBox[{"GetSubspaces", "[", 
    RowBox[{
     RowBox[{"ds4", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0"}], "}"}], ",", "\[Epsilon]"}], "]"}], "[", 
   RowBox[{"[", "2", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8151965835990973`*^9, 3.815196584087019*^9}, {
  3.8151977868098183`*^9, 3.8151977979346523`*^9}}],

Cell[TextData[{
 StyleBox["GetSubspaces ",
  FontWeight->"Bold"],
 "returns the list of bases for invariant subspaces. We take the second \
subspace which has appropriate dimension 1 and simple form of basis vector.\n\
Although, it takes time to understand the format of ",
 StyleBox["GetSubspaces ",
  FontWeight->"Bold"],
 "output, this procedure is almost inavoidable for complicated systems."
}], "Text",
 CellChangeTimes->{{3.815197707087041*^9, 3.815197764207254*^9}, {
  3.8151978055025682`*^9, 3.815197902343008*^9}}],

Cell["Now we cook up a projector and the corresponding balance", "Text",
 CellChangeTimes->{{3.815196590182702*^9, 3.815196621958684*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"ProjectorMod", "[", 
    RowBox[{"us", ",", "vs", ",", 
     RowBox[{"z", "\[Rule]", "den"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"Length", "@", "ds4"}], "]"}], "-", "P", "+", 
    RowBox[{"P", " ", 
     RowBox[{"den", "/", "z"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.815196631695175*^9, 3.815196639663072*^9}}],

Cell[TextData[{
 "Note that ",
 StyleBox["den",
  FontWeight->"Bold"],
 " is of 4-th degree, so the transformation ",
 StyleBox["t",
  FontWeight->"Bold"],
 " defined above is singular at zeros of ",
 StyleBox["den",
  FontWeight->"Bold"],
 ", at ",
 StyleBox["z=0",
  FontWeight->"Bold"],
 " and at ",
 StyleBox["z=\[Infinity]",
  FontWeight->"Bold"],
 ". Applying this transformation, we are likely to increase Poincare rank at ",
 StyleBox["z=\[Infinity]",
  FontWeight->"Bold"],
 " by 3 (=",
 StyleBox["Exponent[den/z,z]",
  FontWeight->"Bold"],
 "). Since we have carefully chosen ",
 StyleBox["us",
  FontWeight->"Bold"],
 ", the Poincare rank at z=0 should not increase."
}], "Text",
 CellChangeTimes->{{3.815196846910939*^9, 3.815197127439342*^9}, 
   3.8151972124711323`*^9}],

Cell["Before the transformation:", "Text",
 CellChangeTimes->{{3.815197153334771*^9, 3.815197159030982*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PoincareRank", "[", 
    RowBox[{"ds4", ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[Infinity]"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.815197132394436*^9, 3.815197162526334*^9}, {
  3.8151979208152533`*^9, 3.815197928023223*^9}}],

Cell["Transform:", "Text",
 CellChangeTimes->{{3.815197168895328*^9, 3.815197171182928*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds4", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.815197174495462*^9, 3.81519718195925*^9}}],

Cell["After the transformation:", "Text",
 CellChangeTimes->{{3.815197153334771*^9, 3.815197159030982*^9}, {
  3.815197190118929*^9, 3.815197190935082*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PoincareRank", "[", 
    RowBox[{"ds4", ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[Infinity]"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.815197132394436*^9, 3.815197162526334*^9}, 
   3.8151979347601633`*^9}],

Cell["\<\
Ok, the Poincare rank has increased by one at z=\[Infinity]. 
But now we don\[CloseCurlyQuote]t have the ugly denominator:\
\>", "Text",
 CellChangeTimes->{{3.81519722064717*^9, 3.8151972321110697`*^9}, {
  3.8151979407026377`*^9, 3.815197960870531*^9}}],

Cell[BoxData[
 RowBox[{"Denominators", "[", "ds4", "]"}]], "Input",
 CellChangeTimes->{{3.81519723356288*^9, 3.815197238031104*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Irreducible denominator", "Subsection",
 CellChangeTimes->{{3.815195610805582*^9, 3.8151956176214647`*^9}, {
  3.8151973176552973`*^9, 3.815197322430932*^9}}],

Cell[TextData[{
 "The denominator ",
 Cell[BoxData[
  RowBox[{"1", "+", 
   SuperscriptBox["z", "2"]}]], "Output",
  CellChangeTimes->{3.815197239379406*^9}],
 " can be factorized as (z+I)(z-I), but thsi factorization will leave, in \
general, the complex numbers in the transformation and in the resulting \
matrix. Let us show, for the sake of completeness, how to treat ",
 Cell[BoxData[
  RowBox[{"1", "+", 
   SuperscriptBox["z", "2"]}]], "Output",
  CellChangeTimes->{3.815197239379406*^9}],
 " as irreducible denominator. Basically, we follow the same path as for ugly \
denominator"
}], "Text",
 CellChangeTimes->{{3.815197344847158*^9, 3.815197481271286*^9}, {
  3.815197515247293*^9, 3.815197532911457*^9}}],

Cell[BoxData[
 RowBox[{"den", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Denominators", "[", "ds4", "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"-", "1"}], "]"}], "]"}], ",", "z", ",", "Factor"}], 
   "]"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"NotationsBlock", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", "den"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Print", "@", 
     RowBox[{"LeadingOrderMod", "[", 
      RowBox[{
       RowBox[{"ds4", "[", "z", "]"}], ",", "z"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Print", "@", 
     RowBox[{"EValuesMod", "[", 
      RowBox[{
       RowBox[{"SeriesCoefficientMod", "[", 
        RowBox[{
         RowBox[{"ds4", "[", "z", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ",", "z"}], "]"}]}], ";"}]}],
   "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.8151959344864902`*^9, 3.815195972461506*^9}}],

Cell["\<\
Now, let us find the two \[OpenCurlyDoubleQuote]eigenvectors\
\[CloseCurlyDoubleQuote], corresponding to nonzero eigenvalues. It should be \
the two first ones:\
\>", "Text",
 CellChangeTimes->{{3.815195984996868*^9, 3.815196034525023*^9}, {
  3.815196086973606*^9, 3.815196093357806*^9}, {3.815198145862793*^9, 
  3.815198159102447*^9}}],

Cell[BoxData[
 RowBox[{"NotationsBlock", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", "den"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{"vs", "=", 
    RowBox[{
     RowBox[{"ESpaceMod", "[", 
      RowBox[{
       RowBox[{"Transpose", "@", 
        RowBox[{"SeriesCoefficientMod", "[", 
         RowBox[{
          RowBox[{"ds4", "[", "z", "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"z", ",", 
            RowBox[{"-", "1"}]}], "}"}]}], "]"}]}], ",", "z"}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"{", 
       RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.804386349019449*^9, 3.80438645682012*^9}, {
  3.8043865392144737`*^9, 3.804386544366597*^9}, {3.815196022669488*^9, 
  3.815196072542614*^9}, {3.815198163519006*^9, 3.8151981636065607`*^9}}],

Cell["Let\[CloseCurlyQuote]s again respect 0 ", "Text",
 CellChangeTimes->{{3.815197638647058*^9, 3.815197660374963*^9}, {
  3.815198054246694*^9, 3.8151980586064568`*^9}}],

Cell[BoxData[
 RowBox[{"us", "=", 
  RowBox[{
   RowBox[{"GetSubspaces", "[", 
    RowBox[{
     RowBox[{"ds4", "[", "z", "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "0"}], "}"}], ",", "\[Epsilon]"}], "]"}], "[", 
   RowBox[{"[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "2"}], "}"}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.8151965835990973`*^9, 3.815196584087019*^9}, {
  3.815197664031169*^9, 3.815197681183297*^9}, {3.815198064311035*^9, 
  3.81519807285489*^9}, {3.8151981748873997`*^9, 3.8151981808146353`*^9}}],

Cell["\<\
It is two one-dimensional subspaces, so we just joint the bases:\
\>", "Text",
 CellChangeTimes->{{3.8151981873102837`*^9, 3.815198224366527*^9}}],

Cell[BoxData[
 RowBox[{"us", "=", 
  RowBox[{"Join", "@@", "us"}]}]], "Input",
 CellChangeTimes->{{3.815198226226379*^9, 3.8151982319030724`*^9}}],

Cell["Now we cook up a projector and the corresponding balance", "Text",
 CellChangeTimes->{{3.815196590182702*^9, 3.815196621958684*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"P", "=", 
   RowBox[{"ProjectorMod", "[", 
    RowBox[{"us", ",", "vs", ",", 
     RowBox[{"z", "\[Rule]", "den"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"IdentityMatrix", "[", 
     RowBox[{"Length", "@", "ds4"}], "]"}], "-", "P", "+", 
    RowBox[{"P", " ", 
     RowBox[{"den", "/", "z"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.815196631695175*^9, 3.815196639663072*^9}, {
  3.815197996359332*^9, 3.815197996815288*^9}, {3.815198078438944*^9, 
  3.8151980785909967`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds4", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"PoincareRank", "[", 
    RowBox[{"ds4", ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", "#"}], "}"}]}], "]"}], "&"}], "/@", 
  RowBox[{"{", 
   RowBox[{"0", ",", "\[Infinity]"}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"Denominators", "[", "ds4", "]"}]], "Input"],

Cell[TextData[{
 "Ok, we got rid of the denomiantor ",
 Cell[BoxData[
  FormBox[
   RowBox[{"1", "+", 
    SuperscriptBox["z", "2"]}], TraditionalForm]],
  FormatType->"TraditionalForm"]
}], "Text",
 CellChangeTimes->{{3.815198258086156*^9, 3.815198272654512*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Other singularities", "Subsection",
 CellChangeTimes->{{3.815195610805582*^9, 3.8151956176214647`*^9}, {
  3.8151973176552973`*^9, 3.815197322430932*^9}, {3.815198303118226*^9, 
  3.815198309814499*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"VisTransformation", "[", 
    RowBox[{"ds4", ",", "z", ",", "\[Epsilon]", ",", 
     RowBox[{"Animate", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", "5", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "13", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "13", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "1", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "13", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "7", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "13", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "5", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "1", "}"}]}], ",", 
        RowBox[{
         RowBox[{"{", "11", "}"}], "\[LongLeftRightArrow]", 
         RowBox[{"{", "7", "}"}]}]}], "}"}]}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8151983174451923`*^9, 3.815198332806713*^9}, 
   3.815198368383642*^9}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds4", ",", "t"}], "]"}]], "Input",
 CellChangeTimes->{{3.815198379518208*^9, 3.815198383542523*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Factoring out \[Epsilon]", "Subsection",
 CellChangeTimes->{{3.815195610805582*^9, 3.8151956176214647`*^9}, {
  3.8151973176552973`*^9, 3.815197322430932*^9}, {3.8151983962140303`*^9, 
  3.815198399182803*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{
    RowBox[{"FactorOut", "[", 
     RowBox[{"ds4", ",", "z", ",", "\[Epsilon]", ",", "1"}], "]"}], "/.", 
    RowBox[{"_C", "\[Rule]", "1"}]}]}], ";", 
  RowBox[{"Factor", "@", 
   RowBox[{"Det", "[", "t", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8151984008803387`*^9, 3.8151984229104633`*^9}}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds4", ",", "t"}], "]"}]], "Input"],

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"Transpose", "@", 
   RowBox[{"JDSpace", "[", 
    RowBox[{"SeriesCoefficient", "[", 
     RowBox[{
      FractionBox[
       RowBox[{"ds4", "[", "z", "]"}], "\[Epsilon]"], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", "0", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.815198436023107*^9, 3.815198464696075*^9}}],

Cell[BoxData[
 RowBox[{"Transform", "[", 
  RowBox[{"ds4", ",", "t"}], "]"}]], "Input"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Example #5: two variables", "Chapter",
 CellChangeTimes->{
  3.7708114064532833`*^9, {3.7708131047755632`*^9, 3.770813110759389*^9}, {
   3.770813751963812*^9, 3.770813786313579*^9}, {3.784196492838256*^9, 
   3.7841964966455317`*^9}, {3.8156126236619*^9, 3.815612623798211*^9}}],

Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.7708132837405777`*^9, 3.770813284348737*^9}}],

Cell["Here we create the differential systems wrt x and y. ", "Text",
 CellChangeTimes->{{3.784196841630584*^9, 3.7841968681634197`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"my", "=", 
   InterpretationBox[
    TagBox[
     TooltipBox[
      PanelBox["\<\"16x16 matrix \\!\\(\\*SubscriptBox[\\(M\\), \\(y\\)]\\) \
in \\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(y\\)]\\)J=\\!\\(\\*SubscriptBox[\\(M\\), \\(y\\)]\\)J\"\>",
       FrameMargins->Small],
      "\"Sun 1 Dec 2019 20:45:07\"",
      TooltipStyle->"TextStyling"],
     Annotation[#, "Sun 1 Dec 2019 20:45:07", "Tooltip"]& ],
    Uncompress[
    "1:eJztWcFOhDAQRWF39eYv+\
Acmxosf4MnDxnj0ZLKbkGg2kTXivytaWjfQ6QyUlrIt1gOhlFlmXt/Mm9bL593D9iJJkiJjl/\
u82IPRqh4t2OUxf90UxQm7K7enh4fr3cfmTQxri/XLu/IKt8t/2B+f+\
eS3sklrFvw0bVJPoCbITwNnhIfd3kD/+XDJLk+3V9d3Nzm7S8a5yHiLR/LHtTGZzHHEZ/E8VVfdK+\
8px8Xkogt2Y5bToVtxNm2bQEeqgyMlzBGSUaUAm78+\
EuQYtTMkrNGRtq8BFULGVCYjoEvjUqDxiPX5D/Xent4Ys8/d0WFcoWvQbuFgVpANsqb/\
G9DizCElHRXnEHFusTsWgUH5PyNRoyPW7UkVDjbuYTOaoSmdYP2OdbsaK8vElQXrs71Nl+\
Ho6ajZUg3Cc8plqjtGuwq4O/ymOqS/jxtu/\
jr3eLQV0s2PsC7SLo3rF40SxIfexE2jeUDk5rjd0UFh0JlGO9MzXcOKkk0n4hj3LkdTPnQ5EEHwNq/\
cSKJcWUJSQ+hII2lmCol93E4czdTQxXmqb6TuKSU29Zer+YqIIhwIJk17P0UnLqKhwEFZ4ynhd2U/\
zn9U+gs0gDLyj26yQzjCCav1c62Skdu6tRXqZdUX52xOKAb3sFjMdEpjdvQ7tv01PBb48irpaT/\
50C8/YUb4BWVHq+sXlmjO/QL7slbZ"]]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"mx", "=", 
   InterpretationBox[
    TagBox[
     TooltipBox[
      PanelBox["\<\"16x16 matrix \\!\\(\\*SubscriptBox[\\(M\\), \\(x\\)]\\) \
in \\!\\(\\*SubscriptBox[\\(\[PartialD]\\), \
\\(x\\)]\\)J=\\!\\(\\*SubscriptBox[\\(M\\), \\(x\\)]\\)J\"\>",
       FrameMargins->Small],
      "\"Sun 1 Dec 2019 20:45:07\"",
      TooltipStyle->"TextStyling"],
     Annotation[#, "Sun 1 Dec 2019 20:45:07", "Tooltip"]& ],
    Uncompress[
    "1:eJztW81u1DAQXmiyLQUhXoE3QKq49AE4cagQR05IXSkSqBLbqu2bcyiF/JR6bI/\
tydqOx7uzh2iT+Gc845n5Ptt5//3qy+bdarXaNv3lc7e9Nu5Ohru2v3ztfl5uu7/9b/\
Pyf4mLHzfTo+2L/u5uejEUvri6vfw1PcSqDC/QKno5s4gSYXxzD/562wEiPDcztQ3aCVfpxtt1f/\
l2/uHs08eu/\
7dKc9GVnrDh0q0fzvxJNDEQbW6OtZ7DolqKcxVWegwXnqPMI6sX3LTDw6mwavHxeQCZPPsR8exRBmX\
AzboajSdQj2Ytszu3OTDVALvC4nN0Hwgbu1mhavusffbBoqdTZ08jO9IcEuQ24L36G7ydxlnHH9PvU\
cenymu2A/22tSdvPueFHc+\
1soUlhjJpssWp1hHn2JUswOePYOq9YbP5pt4hHYX7MGu8qmYSsAQLlZl7cvzWliO34SMUQZnF6WBY1\
QDgra/TUGIHgRZxnmD0IydpAAaw8XhwACUe+yGAKeUfFRbAbEIKuTvzVFTagYUavdCJQ+\
A7WnUK6PJUVwqg4SakeiQUi8UyQnqXJr2TERpbsMWSCFVIMGf0DFGYJxKNDx3vmIn8ORF0MZ5kRJTX\
dsuzdE1YcWTMkerFtcJlDs7mlA0EplMg3moLrsfOtznBgkLbhLZxoG3IeHyc6dQhqwvK6HIdBFnbbS\
NZ9oBJ8FT2HIvtOVbGetHJVDsT5rnjmwvcL8eJhQRXTohkQzdHeqhsElAygL5Owp4pQ6bCbMlE+\
LHwY+HHwo+D0ZfPyWqJ9DmwYAwqH4ehYzfJyRxR+7IpWzD4UFz8Yj/8YtGFs6ex9xcrU3I5R8EBV7/\
xOa4aN/bGAxxR3KwD3RDfJgHBkp8SOE/6+QC3WwcBZ/\
lNICqBI4IRsNgv9i6wOAyGa1ui4J5FGSSA1icxL2Pyyt7O5MVah3vgENGcToLYvgWxAtu/\
Zmr1hgTBs4JnBc/6e0+KZ+\
es65onLxBBMkaP8pivXHBKCegO1JSsTg1hOTEv9mjt5grbOxadgriUjprFjZjqofMHPA6TFqpN/\
0eSVUJTo9GksYcvRIHurG50zF2xEAjyWn8wT10+LBkA90WTnu85ueuTucvP+74+\
oWY9ECkWI5TIpWNTakj/AAqNUPE="]]}], ";"}]}], "Input",
 CellLabelAutoDelete->False,
 CellChangeTimes->{{3.784196707810644*^9, 3.78419671352353*^9}},
 CellLabel->"In[3]:="],

Cell["Let us check the integrability conditions:", "Text",
 CellChangeTimes->{{3.784197413378023*^9, 3.784197424742168*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{"mx", ",", "y"}], "]"}], "-", 
   RowBox[{"D", "[", 
    RowBox[{"my", ",", "x"}], "]"}], "+", 
   RowBox[{"mx", ".", "my"}], "-", 
   RowBox[{"my", ".", "mx"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7841973534175777`*^9, 3.784197401273354*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.784197384007093*^9, 3.784197401898356*^9}, 
   3.815194189220915*^9, 3.815612316488105*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"NewDSystem", "[", 
   RowBox[{"ds5", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x", "\[Rule]", "mx"}], ",", 
      RowBox[{"y", "\[Rule]", "my"}]}], "}"}]}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.770799330631817*^9, 3.770799383644908*^9}, {
   3.770802246629614*^9, 3.770802249379951*^9}, {3.770805038034974*^9, 
   3.770805038115343*^9}, 3.770811959456465*^9, 3.772323912247113*^9, {
   3.784196728898899*^9, 3.78419674140431*^9}, 3.815612303759758*^9},
 ExpressionUUID -> "59430b85-dca3-4fee-9839-d70206cac0fc"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"inds", "=", 
  RowBox[{"EntangledBlocksIndices", "[", "ds5", "]"}]}]], "Input",
 CellChangeTimes->{{3.784196938759325*^9, 3.784196952463393*^9}, 
   3.815612303810727*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "8"}], "}"}], ",", 
   RowBox[{"{", "9", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "11"}], "}"}], ",", 
   RowBox[{"{", "12", "}"}], ",", 
   RowBox[{"{", "13", "}"}], ",", 
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", "15", "}"}], ",", 
   RowBox[{"{", "16", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7841969528586893`*^9, 3.815194192293145*^9, 
  3.815612324079822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diagonal blocks", "Subsection",
 CellChangeTimes->{{3.784196964340514*^9, 3.784196970302412*^9}}],

Cell[CellGroupData[{

Cell["All 1x1 blocks", "Subsubsection",
 CellChangeTimes->{{3.7841969812358427`*^9, 3.7841969908100557`*^9}}],

Cell[TextData[{
 "All 1x1 blocks can be trivially reduced to \[Epsilon]-form. Let us first \
elaborate on ds5",
 StyleBox["[[1,1]]",
  FontWeight->"Bold"],
 "\nThe idea is to \[OpenCurlyQuote]integrate out\[CloseCurlyQuote] the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Epsilon]", "0"], TraditionalForm]]],
 " term. "
}], "Text",
 CellChangeTimes->{{3.7841971664199038`*^9, 3.784197272553487*^9}, 
   3.784198942391356*^9, 3.815612304007161*^9}],

Cell[TextData[{
 "From now on we will put \[Epsilon]=0 when finding the transformation. \
First, note that due to integrability condition we have ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["\[PartialD]", "y"], 
     SubscriptBox[
      RowBox[{"(", 
       SubscriptBox["M", "x"], ")"}], "11"]}], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     SubscriptBox[
      RowBox[{"(", 
       SubscriptBox["M", "y"], ")"}], "11"]}]}], TraditionalForm]], "TI"],
 ":"
}], "Text",
 CellChangeTimes->{{3.784197319996582*^9, 3.7841973396386423`*^9}, 
   3.784197441333069*^9, {3.784197634436878*^9, 3.784197693972371*^9}, {
   3.7841989480219707`*^9, 3.784198971874714*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ds5", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "y"}], "]"}], "-", 
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"ds5", "[", 
        RowBox[{"[", 
         RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "y", "]"}], "/.", 
      RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "x"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.784197453091799*^9, 3.784197467641501*^9}, {
  3.784198980681823*^9, 3.78419898696093*^9}, {3.815612304010667*^9, 
  3.81561230401186*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{3.7841974679973783`*^9, 3.784198987329384*^9, 
  3.815194198529036*^9, 3.815612331616013*^9}]
}, Open  ]],

Cell[TextData[{
 "Therefore, there exists ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["M", "11"], TraditionalForm]], "TI"],
 ", such that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["M", "x"], ")"}], "11"], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "x"], 
     SubscriptBox["M", "11"]}]}], TraditionalForm]], "TI"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     RowBox[{"(", 
      SubscriptBox["M", "y"], ")"}], "11"], "=", 
    RowBox[{
     SubscriptBox["\[PartialD]", "y"], 
     SubscriptBox["M", "11"]}]}], TraditionalForm]], "TI"],
 ".  We first use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["M", "11"], "=", 
    RowBox[{
     RowBox[{"c", "(", "y", ")"}], "+", 
     RowBox[{"\[Integral]", 
      SubscriptBox[
       RowBox[{"dx", "(", 
        SubscriptBox["M", "x"], ")"}], "11"]}]}]}], TraditionalForm]], "TI"],
 ", where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "(", "y", ")"}], TraditionalForm]], "TI"],
 " is an unfixed function of ",
 Cell[BoxData[
  FormBox["y", TraditionalForm]], "TI"],
 ". "
}], "Text",
 CellChangeTimes->{{3.7841975024664917`*^9, 3.784197555556839*^9}, {
  3.784197703058137*^9, 3.7841977656544533`*^9}, {3.7841978039108686`*^9, 
  3.784197856161479*^9}, {3.7841979379406137`*^9, 3.7841979792255774`*^9}, {
  3.784198413199463*^9, 3.784198430729637*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M11", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ds5", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "x", "]"}], "/.", 
     RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "x"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7841972847505302`*^9, 3.784197314736795*^9}, {
   3.784197485364264*^9, 3.784197498368561*^9}, {3.784197790219973*^9, 
   3.7841977950122643`*^9}, {3.784197859151435*^9, 3.7841978600203743`*^9}, {
   3.784198701039485*^9, 3.7841987024927073`*^9}, 3.7841989914936113`*^9, 
   3.815612304015511*^9}],

Cell[BoxData[
 RowBox[{"y", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"Log", "[", "x", "]"}], "y"]}], "+", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"x", "-", "y"}], "]"}], "y"], "+", 
    FractionBox[
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       RowBox[{"x", " ", "y"}]}], "]"}], "y"]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.7841972896385736`*^9, 3.784197303491461*^9}, 
   3.7841974963446703`*^9, 3.784197868054604*^9, 3.784198702962343*^9, 
   3.784198992229813*^9, 3.815194200059059*^9, 3.8156123334735317`*^9}]
}, Open  ]],

Cell[TextData[{
 "In order to fix ",
 Cell[BoxData[
  FormBox[
   RowBox[{"c", "(", "y", ")"}], TraditionalForm]], "TI"],
 ", we use ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"c", "(", "y", ")"}], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["M", "11"], "-", 
      RowBox[{"\[Integral]", 
       SubscriptBox[
        RowBox[{"dx", "(", 
         SubscriptBox["M", "x"], ")"}], "11"]}]}], "=", 
     RowBox[{
      RowBox[{"\[Integral]", 
       RowBox[{"dy", "[", 
        RowBox[{
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], 
          SubscriptBox["M", "11"]}], "-", 
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], 
          RowBox[{"\[Integral]", 
           SubscriptBox[
            RowBox[{"dx", "(", 
             SubscriptBox["M", "x"], ")"}], "11"]}]}]}], "]"}]}], "=", 
      RowBox[{"\[Integral]", 
       RowBox[{"dy", "[", 
        RowBox[{
         SubscriptBox[
          RowBox[{"(", 
           SubscriptBox["M", "y"], ")"}], "11"], "-", 
         RowBox[{
          SubscriptBox["\[PartialD]", "y"], 
          RowBox[{"\[Integral]", 
           SubscriptBox[
            RowBox[{"dx", "(", 
             SubscriptBox["M", "x"], ")"}], "11"]}]}]}], "]"}]}]}]}]}], 
   TraditionalForm]], "TI"]
}], "Text",
 CellChangeTimes->{{3.784197882257423*^9, 3.7841978973882227`*^9}, {
  3.784198437477723*^9, 3.784198550901672*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"M11", "=", 
  RowBox[{"Factor", "[", 
   RowBox[{"M11", "+", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Factor", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ds5", "[", 
           RowBox[{"[", 
            RowBox[{"1", ",", "1"}], "]"}], "]"}], "[", "y", "]"}], "-", 
         RowBox[{"D", "[", 
          RowBox[{"M11", ",", "y"}], "]"}]}], "]"}], "/.", 
       RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "y"}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.784198659508319*^9, 3.784198708702778*^9}, 
   3.784199001599633*^9, 3.8156123040187283`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   RowBox[{"Log", "[", "x", "]"}]}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"x", "-", "y"}], "]"}], "-", 
  RowBox[{"Log", "[", "y", "]"}], "+", 
  RowBox[{"Log", "[", 
   RowBox[{"1", "-", 
    RowBox[{"x", " ", "y"}]}], "]"}]}]], "Output",
 CellChangeTimes->{{3.7841986915330753`*^9, 3.7841987089920893`*^9}, 
   3.784199002884091*^9, 3.8151942015476513`*^9, 3.81561233633*^9}]
}, Open  ]],

Cell[TextData[{
 "Now the transformation is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["T", "11"], "=", 
    SuperscriptBox["e", 
     SubscriptBox["M", "11"]]}], TraditionalForm]], "TI"],
 ": "
}], "Text",
 CellChangeTimes->{{3.784199009648986*^9, 3.7841990706426497`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{"{", 
    RowBox[{"{", 
     RowBox[{"Exp", "[", "M11", "]"}], "}"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199085313991*^9, 3.784199102171075*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "x"]}], "-", "x", "+", 
    FractionBox["1", "y"], "+", "y"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.784199102571497*^9, 3.815194203898999*^9, 
  3.815612339301712*^9}]
}, Open  ]],

Cell["Let us check the found transformation:", "Text",
 CellChangeTimes->{{3.78419912547369*^9, 3.784199145555691*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Factor", "@", 
  RowBox[{"Transform", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ds5", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", "x", "]"}], ",", "t", 
    ",", "x"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Factor", "@", 
  RowBox[{"Transform", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"ds5", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"{", "1", "}"}], ",", 
        RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "[", "y", "]"}], ",", "t", 
    ",", "y"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.784199110446084*^9, 3.784199183123646*^9}, {
  3.815612304021667*^9, 3.815612304022291*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "x"}], ")"}], " ", "y", " ", "\[Epsilon]"}], 
     RowBox[{"x", " ", 
      RowBox[{"(", 
       RowBox[{"x", "-", "y"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.784199165563458*^9, 3.78419918349619*^9}, 
   3.815194205873547*^9, 3.815612341982587*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   FractionBox[
    RowBox[{"2", " ", "x", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "+", "y"}], ")"}], " ", "\[Epsilon]"}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"x", "-", "y"}], ")"}], " ", "y", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"x", " ", "y"}]}], ")"}]}]], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.784199165563458*^9, 3.78419918349619*^9}, 
   3.815194205873547*^9, 3.815612341983437*^9}]
}, Open  ]],

Cell["\<\
Ok, indeed we found \[Epsilon]-form. No we do it in cycle for each 1x1 block:\
\
\>", "Text",
 CellChangeTimes->{{3.7841991870596437`*^9, 3.784199210297782*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"onebyone", " ", "=", 
  RowBox[{"Select", "[", 
   RowBox[{"inds", ",", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], "\[Equal]", "1"}], "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.784196997569955*^9, 3.784197013943108*^9}, {
  3.784197132108336*^9, 3.784197154731456*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", "9", "}"}], ",", 
   RowBox[{"{", "12", "}"}], ",", 
   RowBox[{"{", "13", "}"}], ",", 
   RowBox[{"{", "14", "}"}], ",", 
   RowBox[{"{", "15", "}"}], ",", 
   RowBox[{"{", "16", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.7841970140932627`*^9, 3.784197156524662*^9, 
  3.784197222321356*^9, 3.7841992128404713`*^9, 3.815194209774723*^9, 
  3.815612356115963*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"IdentityMatrix", "[", 
    RowBox[{"Length", "@", "ds5"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Mii", "=", 
       RowBox[{"Integrate", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ds5", "[", 
            RowBox[{"[", 
             RowBox[{"#", ",", "#"}], "]"}], "]"}], "[", "x", "]"}], "/.", 
          RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "x"}], "]"}]}], ";", 
      
      RowBox[{"Mii", "=", 
       RowBox[{"Factor", "[", 
        RowBox[{"Mii", "+", 
         RowBox[{"Integrate", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Factor", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ds5", "[", 
                RowBox[{"[", 
                 RowBox[{"#", ",", "#"}], "]"}], "]"}], "[", "y", "]"}], "-", 
              
              RowBox[{"D", "[", 
               RowBox[{"Mii", ",", "y"}], "]"}]}], "]"}], "/.", 
            RowBox[{"\[Epsilon]", "\[Rule]", "0"}]}], ",", "y"}], "]"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"t", "[", 
        RowBox[{"[", 
         RowBox[{"#", ",", "#"}], "]"}], "]"}], "=", 
       RowBox[{"FullSimplify", "[", 
        RowBox[{"Exp", "@", "Mii"}], "]"}]}]}], ")"}], "&"}], "/@", 
   "onebyone"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Diagonal", "[", "t", "]"}]}], "Input",
 CellChangeTimes->{{3.784199229738162*^9, 3.78419936258035*^9}, {
  3.815612304059287*^9, 3.815612304060957*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "x"]}], "-", "x", "+", 
    FractionBox["1", "y"], "+", "y"}], ",", 
   FractionBox["1", "y"], ",", "y", ",", "1", ",", "1", ",", "1", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], ",", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], ",", 
   FractionBox["x", 
    RowBox[{"1", "-", 
     SuperscriptBox["x", "2"]}]], ",", 
   FractionBox[
    SuperscriptBox["x", "2"], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SuperscriptBox["x", "2"]}], ")"}], "2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.784199329332816*^9, 3.784199362954299*^9}, 
   3.8151942253949003`*^9, 3.815612359444628*^9}]
}, Open  ]],

Cell["Now we apply the transformation:", "Text",
 CellChangeTimes->{{3.784199367827518*^9, 3.7841993786149883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784199380238109*^9, 3.784199391492237*^9}, 
   3.815612304063447*^9}],

Cell["\<\
Let\[CloseCurlyQuote]s check that we have indeed \[Epsilon]-form for all 1x1 \
diagonal blocks:\
\>", "Text",
 CellChangeTimes->{{3.784199458731357*^9, 3.784199492883*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EFormQ", "[", 
    RowBox[{
     RowBox[{"ds5", "[", 
      RowBox[{"[", 
       RowBox[{"#", ",", "#"}], "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], 
   "&"}], "/@", "onebyone"}]], "Input",
 CellChangeTimes->{{3.784199396999145*^9, 3.784199421647936*^9}, 
   3.815612304068267*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.784199416588212*^9, 3.78419942224021*^9}, 
   3.8151942406050777`*^9, 3.815612369750161*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["{5,6}", "Subsubsection",
 CellChangeTimes->{{3.7841969812358427`*^9, 3.7841969908100557`*^9}, {
  3.784199516167828*^9, 3.784199517347886*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "5", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7841995276663847`*^9, 3.784199531394598*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{3.78419953184853*^9, 3.8151942464350452`*^9, 
  3.815612373162075*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.784199534399301*^9, 3.784199544329773*^9}, 
   3.815612304069878*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"History length for b is 1.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.81519424757821*^9, 3.815612374636457*^9}],

Cell[BoxData["\<\"Successfully created differential system for 2 functions of \
x,y.\"\>"], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.81519424757821*^9, 3.815612374639023*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
    RowBox[{"Animate", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "4", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "12", "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", 
      FractionBox["\[Epsilon]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "+", "x"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"5", " ", "\[Epsilon]"}], "+", 
          RowBox[{"6", " ", 
           SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}]}]]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["x", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, 
   3.7842001084000072`*^9, 3.8151942513557997`*^9, 3.8156123796017017`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841995941383963`*^9, 3.784199602550765*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 2.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199603183695*^9, 3.784200110130186*^9, 
  3.8151942534627047`*^9, 3.815612381703689*^9}]
}, Open  ]],

Cell[TextData[{
 "At this stage we have normalized matrix ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "x"], TraditionalForm]], "TI"],
 ". Now we do the same for ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "y"], TraditionalForm]], "TI"],
 ". However, we have to use only transformations which do not depend on ",
 Cell[BoxData[
  FormBox["x", TraditionalForm]], "TI"],
 "."
}], "Text",
 CellChangeTimes->{{3.784199606326243*^9, 3.784199701707862*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
    RowBox[{"Log", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}, {
  3.784199711593071*^9, 3.784199722423646*^9}, {3.815194301455947*^9, 
  3.8151943027593718`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"NB: option\\n\\t\"\>", "\[InvisibleSpace]", 
   RowBox[{"Highlighted", "\[Rule]", 
    RowBox[{"{", "}"}]}], 
   "\[InvisibleSpace]", "\<\"\\nwill guide you through the same path,\\n \
while option\\n\\t\"\>", "\[InvisibleSpace]", 
   RowBox[{"Animate", "\[Rule]", 
    RowBox[{"{", "}"}]}], 
   "\[InvisibleSpace]", "\<\"\\nwill press the buttons for you \
\[HappySmiley].\"\>"}],
  SequenceForm[
  "NB: option\n\t", Highlighted -> {}, 
   "\nwill guide you through the same path,\n while option\n\t", 
   Animate -> {}, "\nwill press the buttons for you \[HappySmiley]."],
  Editable->False]], "Print",
 CellChangeTimes->{3.7841997320139112`*^9, 3.784200117894326*^9, 
  3.815194259729425*^9, 3.815194312618518*^9, 3.8156123887370234`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, {
   3.7841997159658327`*^9, 3.784199732015113*^9}, 3.784200117895669*^9, 
   3.815194259730418*^9, 3.8151943126196957`*^9, 3.815612388742148*^9}]
}, Open  ]],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "y"], TraditionalForm]], "TI"],
 " appeared to be already normalized."
}], "Text",
 CellChangeTimes->{{3.7841997419840803`*^9, 3.78419978359833*^9}}],

Cell[TextData[{
 "Now we can factor our \[Epsilon]. We can use ,e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "x"], TraditionalForm]], "TI"],
 ":"
}], "Text",
 CellChangeTimes->{{3.784199791065866*^9, 3.784199811580373*^9}, {
  3.784199865414968*^9, 3.78419988901353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"FactorOut", "[", 
    RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
     RowBox[{"-", "1"}]}], "]"}], "/.", 
   RowBox[{"_C", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.784199891037011*^9, 3.78419992623382*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"5", " ", "\[Epsilon]"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"12", " ", "\[Epsilon]"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.784199907015883*^9, 3.784199927210525*^9}, 
   3.784200125300688*^9, 3.815194323394355*^9, 3.815612393145575*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841999334751663`*^9, 3.784199938656932*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 3.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199939779456*^9, 3.784200126333344*^9, 
  3.815194325323194*^9, 3.815612395602359*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.784199941254384*^9, 3.784199948474441*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784199948892765*^9, 3.784200127018902*^9, 
  3.8151943262855053`*^9, 3.81561239886523*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7841999517525597`*^9, 3.7841999521859093`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "x", " ", "y"}], "-", 
             SuperscriptBox["y", "2"]}], ")"}], " ", "\[Epsilon]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", 
        FractionBox["\[Epsilon]", 
         RowBox[{"6", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}]}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"24", " ", "\[Epsilon]"}], "x"]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["x", "2"]}], "+", 
            RowBox[{"6", " ", "x", " ", "y"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["x", "3"], " ", "y"}], "-", 
            SuperscriptBox["y", "2"], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["x", "2"], " ", 
             SuperscriptBox["y", "2"]}]}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y"}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        FractionBox[
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "y"}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.784199952456931*^9, 3.784200127779249*^9, 
  3.815194327673296*^9, 3.815612400838093*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"HistoryConsolidate", "[", "b", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784200130481675*^9, 3.7842001403171673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784200143323547*^9, 3.784200151162841*^9}, 
   3.8156123040746803`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.784200152772197*^9, 3.784200166595305*^9}, 
   3.8156123040778933`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.81561240958086*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["{7,8}", "Subsubsection",
 CellChangeTimes->{{3.7841969812358427`*^9, 3.7841969908100557`*^9}, {
   3.784199516167828*^9, 3.784199517347886*^9}, 3.784200185657662*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "6", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7841995276663847`*^9, 3.784199531394598*^9}, 
   3.784200182474564*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"7", ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{3.78419953184853*^9, 3.784200182829899*^9, 
  3.8151943366063013`*^9, 3.815612412262405*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.784199534399301*^9, 3.784199544329773*^9}, 
   3.815612304079337*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"History length for b is 1.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.784200188259424*^9, 3.815194338010435*^9, 3.815612413895185*^9}],

Cell[BoxData["\<\"Successfully created differential system for 2 functions of \
x,y.\"\>"], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.784200188259424*^9, 3.815194338010435*^9, 3.815612413897249*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
    RowBox[{"Animate", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "4", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "12", "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}, {
  3.784200194274084*^9, 3.784200220938878*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "y", "-", 
         RowBox[{"x", " ", "y"}], "+", 
         RowBox[{
          SuperscriptBox["x", "2"], " ", "y"}]}], ")"}], " ", "\[Epsilon]"}], 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", "\[Epsilon]"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["x", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, 
   3.7842001084000072`*^9, 3.784200215689479*^9, 3.815194340714581*^9, 
   3.815612418180889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841995941383963`*^9, 3.784199602550765*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 2.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199603183695*^9, 3.784200110130186*^9, 
  3.784200224762895*^9, 3.815194342697205*^9, 3.815612420153693*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
    RowBox[{"Animate", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "9", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", "8", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "1", "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}, {
   3.784199711593071*^9, 3.784199722423646*^9}, 3.815194359471571*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{"\[Epsilon]", "-", 
       RowBox[{"y", " ", "\[Epsilon]"}]}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", "\[Epsilon]"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, {
   3.7841997159658327`*^9, 3.784199732015113*^9}, 3.784200117895669*^9, 
   3.7842002616797867`*^9, 3.815194362558394*^9, 3.815612424799387*^9}]
}, Open  ]],

Cell[TextData[{
 "Check that ",
 StyleBox["t",
  FontWeight->"Bold"],
 " does not depend on x:"
}], "Text",
 CellChangeTimes->{{3.784200269827838*^9, 3.784200285543015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.784200287178062*^9, 3.784200291787311*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784200292052676*^9, 3.8151943657282248`*^9, 
  3.815612426725659*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"History length for b is 3.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784200307875453*^9, 3.815194367756331*^9, 
  3.815612428060071*^9}]
}, Open  ]],

Cell[TextData[{
 "Now we can factor our \[Epsilon]. We can use ,e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "x"], TraditionalForm]], "TI"],
 ":"
}], "Text",
 CellChangeTimes->{{3.784199791065866*^9, 3.784199811580373*^9}, {
  3.784199865414968*^9, 3.78419988901353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"FactorOut", "[", 
    RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
     RowBox[{"-", "1"}]}], "]"}], "/.", 
   RowBox[{"_C", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.784199891037011*^9, 3.78419992623382*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"5", " ", "\[Epsilon]"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"12", " ", "\[Epsilon]"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.784199907015883*^9, 3.784199927210525*^9}, 
   3.784200125300688*^9, 3.784200313902162*^9, 3.8151943696304617`*^9, 
   3.815612430353168*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841999334751663`*^9, 3.784199938656932*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 4.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199939779456*^9, 3.784200126333344*^9, 
  3.7842003159747877`*^9, 3.8151943712139387`*^9, 3.8156124328406076`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.784199941254384*^9, 3.784199948474441*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784199948892765*^9, 3.784200127018902*^9, 
  3.784200318120384*^9, 3.815194371961505*^9, 3.815612434220984*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7841999517525597`*^9, 3.7841999521859093`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "x"}], "+", "y", "+", 
            RowBox[{
             SuperscriptBox["x", "2"], " ", "y"}]}], ")"}], " ", 
          "\[Epsilon]"}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "x"}], "+", "y", "+", 
            RowBox[{
             SuperscriptBox["x", "2"], " ", "y"}]}], ")"}], " ", 
          "\[Epsilon]"}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "x"}], "+", 
             SuperscriptBox["x", "3"], "-", "y", "-", 
             RowBox[{"7", " ", 
              SuperscriptBox["x", "2"], " ", "y"}], "+", 
             RowBox[{"2", " ", "x", " ", 
              SuperscriptBox["y", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["x", "3"], " ", 
              SuperscriptBox["y", "2"]}]}], ")"}], " ", "\[Epsilon]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["\[Epsilon]", 
          RowBox[{"y", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{"x", " ", "\[Epsilon]"}], 
          RowBox[{"12", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"12", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}], " ", "\[Epsilon]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "x"}], "-", "y", "+", 
            RowBox[{"2", " ", "x", " ", 
             SuperscriptBox["y", "2"]}]}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.784199952456931*^9, 3.784200127779249*^9, 
  3.784200321495039*^9, 3.8151943732467318`*^9, 3.815612436519409*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"HistoryConsolidate", "[", "b", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784200130481675*^9, 3.7842001403171673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784200143323547*^9, 3.784200151162841*^9}, 
   3.8156123040807257`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.784200152772197*^9, 3.784200166595305*^9}, 
   3.815612304083962*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784200167225696*^9, 3.784200333827291*^9, 
  3.815194376161066*^9, 3.815612444573428*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["{10,11}", "Subsubsection",
 CellChangeTimes->{{3.7841969812358427`*^9, 3.7841969908100557`*^9}, {
   3.784199516167828*^9, 3.784199517347886*^9}, 3.784200185657662*^9, 
   3.784200355268862*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ii", "=", 
  RowBox[{"inds", "[", 
   RowBox[{"[", "8", "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7841995276663847`*^9, 3.784199531394598*^9}, 
   3.784200182474564*^9, 3.7842003493434362`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"10", ",", "11"}], "}"}]], "Output",
 CellChangeTimes->{3.78419953184853*^9, 3.784200182829899*^9, 
  3.784200349647134*^9, 3.8151943852813663`*^9, 3.815612450878619*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NewDSystem", "[", 
  RowBox[{"b", ",", 
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.784199534399301*^9, 3.784199544329773*^9}, 
   3.815612304088711*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 StyleBox["\<\"History length for b is 1.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.784200188259424*^9, 3.784200360934409*^9, 3.815194387457872*^9, 
  3.8156124521647863`*^9}],

Cell[BoxData["\<\"Successfully created differential system for 2 functions of \
x,y.\"\>"], "Print",
 CellChangeTimes->{3.784199546030987*^9, 3.784200100084302*^9, 
  3.784200188259424*^9, 3.784200360934409*^9, 3.815194387457872*^9, 
  3.815612452165556*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
    RowBox[{"Animate", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "4", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", "6", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "12", "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}, {
  3.784200194274084*^9, 3.784200220938878*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "-", "x", "+", 
         SuperscriptBox["x", "2"], "+", "y"}], ")"}], " ", "\[Epsilon]"}], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}], " ", "y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", "\[Epsilon]"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["x", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "x"}], ")"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, 
   3.7842001084000072`*^9, 3.784200215689479*^9, 3.7842003691804943`*^9, 
   3.815194390735058*^9, 3.815612455924716*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841995941383963`*^9, 3.784199602550765*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 2.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199603183695*^9, 3.784200110130186*^9, 
  3.784200224762895*^9, 3.784200379215164*^9, 3.815194392866096*^9, 
  3.8156124576288548`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{"VisTransformation", "[", 
   RowBox[{"b", ",", "y", ",", "\[Epsilon]", ",", 
    RowBox[{"Animate", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"{", "9", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "3", "}"}]}], ",", 
       RowBox[{
        RowBox[{"{", "2", "}"}], "\[LongLeftRightArrow]", 
        RowBox[{"{", "7", "}"}]}]}], "}"}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.784199548097487*^9, 3.784199585253374*^9}, {
  3.784199711593071*^9, 3.784199722423646*^9}, {3.784200381773652*^9, 
  3.7842004177678003`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "y"}], ")"}], " ", "\[Epsilon]"}], 
      RowBox[{"y", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"3", " ", "\[Epsilon]"}]}], ")"}]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7841995779914494`*^9, 3.7841995896339617`*^9}, {
   3.7841997159658327`*^9, 3.784199732015113*^9}, 3.784200117895669*^9, 
   3.7842002616797867`*^9, {3.78420038737367*^9, 3.784200412358164*^9}, 
   3.815194395693679*^9, 3.8156124630269213`*^9}]
}, Open  ]],

Cell[TextData[{
 "Check that ",
 StyleBox["t",
  FontWeight->"Bold"],
 " does not depend on x:"
}], "Text",
 CellChangeTimes->{{3.784200269827838*^9, 3.784200285543015*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FreeQ", "[", 
  RowBox[{"t", ",", "x"}], "]"}]], "Input",
 CellChangeTimes->{{3.784200287178062*^9, 3.784200291787311*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784200292052676*^9, 3.78420042260546*^9, 
  3.815194397851253*^9, 3.815612464487315*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input"],

Cell[BoxData[
 StyleBox["\<\"History length for b is 3.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784200307875453*^9, 3.784200426206821*^9, 
  3.815194398841957*^9, 3.8156124661989717`*^9}]
}, Open  ]],

Cell[TextData[{
 "Now we can factor our \[Epsilon]. We can use ,e.g. ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["b", "x"], TraditionalForm]], "TI"],
 ":"
}], "Text",
 CellChangeTimes->{{3.784199791065866*^9, 3.784199811580373*^9}, {
  3.784199865414968*^9, 3.78419988901353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"FactorOut", "[", 
    RowBox[{"b", ",", "x", ",", "\[Epsilon]", ",", 
     RowBox[{"-", "1"}]}], "]"}], "/.", 
   RowBox[{"_C", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.784199891037011*^9, 3.78419992623382*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"5", " ", "\[Epsilon]"}], "-", 
       RowBox[{"6", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"12", " ", "\[Epsilon]"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.784199907015883*^9, 3.784199927210525*^9}, 
   3.784200125300688*^9, 3.784200313902162*^9, 3.7842004300375977`*^9, 
   3.815194400162114*^9, 3.815612468878708*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"b", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.7841999334751663`*^9, 3.784199938656932*^9}}],

Cell[BoxData[
 StyleBox["\<\"History length for b is 4.\"\>",
  StripOnInput->False,
  FontSize->Small]], "Print",
 CellChangeTimes->{3.784199939779456*^9, 3.784200126333344*^9, 
  3.7842003159747877`*^9, 3.7842004327715397`*^9, 3.815194401253183*^9, 
  3.815612471313102*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"b", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.784199941254384*^9, 3.784199948474441*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784199948892765*^9, 3.784200127018902*^9, 
  3.784200318120384*^9, 3.784200433854409*^9, 3.815194402714878*^9, 
  3.815612473230645*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"b", "[", "]"}]], "Input",
 CellChangeTimes->{{3.7841999517525597`*^9, 3.7841999521859093`*^9}}],

Cell[BoxData[
 RowBox[{"\[LeftAssociation]", 
  RowBox[{
   RowBox[{"x", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         FractionBox[
          RowBox[{"y", " ", "\[Epsilon]"}], 
          RowBox[{"x", " ", 
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}]}]]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"], "-", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}]}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"12", " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            SuperscriptBox["x", "2"], "-", 
            RowBox[{"2", " ", "x", " ", "y"}]}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{"x", " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "x"}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["x", "3"]}], "-", "y", "-", 
             RowBox[{"7", " ", 
              SuperscriptBox["x", "2"], " ", "y"}], "+", 
             RowBox[{"3", " ", "x", " ", 
              SuperscriptBox["y", "2"]}], "+", 
             RowBox[{
              SuperscriptBox["x", "3"], " ", 
              SuperscriptBox["y", "2"]}]}], ")"}], " ", "\[Epsilon]"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", "x", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "x"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"x", "-", "y"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"x", " ", "y"}]}], ")"}]}]]}]}], "}"}]}], "}"}]}], ",", 
   RowBox[{"y", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox["\[Epsilon]", 
         RowBox[{"x", "-", "y"}]], ",", 
        FractionBox[
         RowBox[{"x", " ", "\[Epsilon]"}], 
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", "y"}]]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{"12", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "x"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "x"}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "x"}], "+", "y", "+", 
            RowBox[{"x", " ", 
             SuperscriptBox["y", "2"]}]}], ")"}], " ", "\[Epsilon]"}], 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"x", "-", "y"}], ")"}], " ", "y", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"x", " ", "y"}]}], ")"}]}]]}], "}"}]}], "}"}]}]}], 
  "\[RightAssociation]"}]], "Output",
 CellChangeTimes->{3.784199952456931*^9, 3.784200127779249*^9, 
  3.784200321495039*^9, 3.784200435289934*^9, 3.815194404260243*^9, 
  3.815612475081335*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"HistoryConsolidate", "[", "b", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.784200130481675*^9, 3.7842001403171673`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t", ",", "ii"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.784200143323547*^9, 3.784200151162841*^9}, 
   3.8156123040900803`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{
   RowBox[{"ds5", "[", 
    RowBox[{"[", 
     RowBox[{"ii", ",", "ii"}], "]"}], "]"}], ",", "\[Epsilon]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.784200152772197*^9, 3.784200166595305*^9}, 
   3.815612304093602*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.784200167225696*^9, 3.784200333827291*^9, 
  3.784200442098488*^9, 3.815194409375979*^9, 3.815612485717957*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Check diagonal blocks", "Subsubsection",
 CellChangeTimes->{{3.7841969812358427`*^9, 3.7841969908100557`*^9}, {
   3.784199516167828*^9, 3.784199517347886*^9}, 3.784200185657662*^9, 
   3.784200355268862*^9, {3.815194423462983*^9, 3.815194435774909*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EFormQ", "[", 
    RowBox[{
     RowBox[{"ds5", "[", 
      RowBox[{"[", 
       RowBox[{"#", ",", "#"}], "]"}], "]"}], ",", "\[Epsilon]"}], "]"}], 
   "&"}], "/@", "inds"}]], "Input",
 CellChangeTimes->{{3.8151944377889557`*^9, 3.815194457454988*^9}, 
   3.8156123040951347`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", 
   ",", "True", ",", "True", ",", "True", ",", "True", ",", "True", ",", 
   "True", ",", "True"}], "}"}]], "Output",
 CellChangeTimes->{{3.81519443845921*^9, 3.815194457630458*^9}, 
   3.815612488376474*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Overall factorization", "Subsection",
 CellChangeTimes->{{3.784196964340514*^9, 3.784196970302412*^9}, {
  3.815194482638839*^9, 3.815194485646913*^9}, {3.815194560054603*^9, 
  3.81519456491873*^9}, {3.815194724142872*^9, 3.815194726222612*^9}}],

Cell["\<\
It appears that the differential system is already globally fuchsian at this \
point.\
\>", "Text",
 CellChangeTimes->{{3.815194584134438*^9, 3.815194626775003*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"FuchsianQ", "[", 
  RowBox[{"ds5", ",", "x"}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"FuchsianQ", "[", 
  RowBox[{"ds5", ",", "y"}], "]"}]}], "Input",
 CellChangeTimes->{{3.815194516586586*^9, 3.815194579559224*^9}, {
  3.8156123040964212`*^9, 3.815612304097007*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.815194522275074*^9, 3.815194526288885*^9}, {
   3.815194574096652*^9, 3.815194579807761*^9}, 3.815612491637241*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.815194522275074*^9, 3.815194526288885*^9}, {
   3.815194574096652*^9, 3.815194579807761*^9}, 3.8156124917510633`*^9}]
}, Open  ]],

Cell["If it was not so, we would have run the following", "Text",
 CellChangeTimes->{{3.815194644694749*^9, 3.81519467090247*^9}, {
  3.8151947180945473`*^9, 3.815194718734281*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Fuchsify", "[", 
    RowBox[{"ds5", ",", "x"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"t", "=", 
   RowBox[{"Fuchsify", "[", 
    RowBox[{"ds5", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.815194487883066*^9, 3.815194506223641*^9}, {
  3.8151946771194696`*^9, 3.815194703479034*^9}, {3.815612304102748*^9, 
  3.815612304103978*^9}}],

Cell["\<\
Now we find the overall factorizing transformation. Although we don\
\[CloseCurlyQuote]t need to use sampling here, let us show this technique for \
the sake of completeness\
\>", "Text",
 CellChangeTimes->{{3.8151947295745487`*^9, 3.815194799126555*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"samples", "=", 
   RowBox[{"Join", "@@", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"ds5", "[", "x", "]"}], ",", 
         RowBox[{"ds5", "[", "y", "]"}]}], "}"}], "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "\[Rule]", 
          RowBox[{"RandomInteger", "[", "30", "]"}]}], ",", 
         RowBox[{"y", "\[Rule]", 
          RowBox[{"RandomInteger", "[", "30", "]"}]}]}], "}"}]}], ",", 
      RowBox[{"{", "5", "}"}]}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.81519475447414*^9, 3.815194755214734*^9}, {
  3.815194801943153*^9, 3.815194883238817*^9}, {3.815612304112586*^9, 
  3.8156123041130257`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"t", "=", 
  RowBox[{
   RowBox[{"FactorDependence", "[", 
    RowBox[{
     RowBox[{"samples", "/", "\[Epsilon]"}], ",", "\[Epsilon]", ",", "1"}], 
    "]"}], "/.", 
   RowBox[{"_C", "\[Rule]", "1"}]}]}]], "Input",
 CellChangeTimes->{{3.8151948976789703`*^9, 3.815194919274102*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"9", " ", "\[Epsilon]"}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}]], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", 
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"9", " ", "\[Epsilon]"}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}]], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"3", " ", "\[Epsilon]"}]}], "\[Epsilon]"], ",", "0", ",", "0", 
     ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{"2", "-", 
       RowBox[{"9", " ", "\[Epsilon]"}], "+", 
       RowBox[{"9", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}]}], 
      RowBox[{"2", " ", "\[Epsilon]", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}]}]], ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"13", " ", "\[Epsilon]"}], "-", 
       RowBox[{"27", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["\[Epsilon]", "3"]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}]], ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"13", " ", "\[Epsilon]"}], "-", 
       RowBox[{"27", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["\[Epsilon]", "3"]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}]], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "\[Epsilon]"}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"2", "-", 
         RowBox[{"9", " ", "\[Epsilon]"}], "+", 
         RowBox[{"9", " ", 
          SuperscriptBox["\[Epsilon]", "2"]}]}], ")"}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}]], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", 
     ",", 
     FractionBox[
      RowBox[{
       RowBox[{"-", "2"}], "+", 
       RowBox[{"13", " ", "\[Epsilon]"}], "-", 
       RowBox[{"27", " ", 
        SuperscriptBox["\[Epsilon]", "2"]}], "+", 
       RowBox[{"18", " ", 
        SuperscriptBox["\[Epsilon]", "3"]}]}], 
      RowBox[{"2", " ", 
       SuperscriptBox["\[Epsilon]", "3"]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.815194886413198*^9, 3.815194920799108*^9}, 
   3.815612515164358*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Transform", "[", 
   RowBox[{"ds5", ",", "t"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.815194931779469*^9, 3.81519493773444*^9}, 
   3.815612304115612*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"EFormQ", "[", 
  RowBox[{"ds5", ",", "\[Epsilon]"}], "]"}]], "Input",
 CellChangeTimes->{{3.815194939437317*^9, 3.815194943070303*^9}, 
   3.815612304121357*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.815194943624584*^9, 3.81561252395426*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
Evaluator->"Local1",
WindowSize->{2602, 2045},
WindowMargins->{{Automatic, 526}, {0, Automatic}},
Magnification:>2. Inherited,
FrontEndVersion->"11.0 for Linux x86 (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 266, 4, 169, "Title"],
Cell[CellGroupData[{
Cell[871, 30, 103, 1, 82, "Subsection"],
Cell[977, 33, 248, 4, 103, "Code"],
Cell[1228, 39, 302, 5, 103, "Code"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1567, 49, 195, 3, 119, "Chapter"],
Cell[1765, 54, 98, 1, 128, "Input"],
Cell[1866, 57, 1482, 28, 140, "Input"],
Cell[3351, 87, 407, 8, 128, "Input"],
Cell[3761, 97, 154, 3, 128, "Input"],
Cell[3918, 102, 982, 31, 278, "Text"],
Cell[4903, 135, 762, 15, 278, "Text"],
Cell[5668, 152, 1832, 39, 216, "Input"],
Cell[7503, 193, 1149, 29, 512, "Text"],
Cell[8655, 224, 175, 4, 128, "Input"],
Cell[8833, 230, 237, 5, 122, "Text"],
Cell[9073, 237, 292, 6, 128, "Input"],
Cell[9368, 245, 109, 1, 122, "Text"],
Cell[9480, 248, 123, 3, 128, "Input"],
Cell[9606, 253, 131, 1, 122, "Text"],
Cell[9740, 256, 296, 6, 128, "Input"],
Cell[10039, 264, 105, 1, 122, "Text"],
Cell[10147, 267, 175, 4, 128, "Input"],
Cell[10325, 273, 119, 1, 122, "Text"],
Cell[10447, 276, 146, 3, 128, "Input"],
Cell[10596, 281, 128, 1, 122, "Text"],
Cell[10727, 284, 278, 6, 216, "Input"],
Cell[11008, 292, 277, 6, 216, "Input"],
Cell[11288, 300, 885, 21, 216, "Input"],
Cell[12176, 323, 228, 4, 128, "Input"],
Cell[12407, 329, 312, 6, 128, "Input"],
Cell[12722, 337, 210, 4, 122, "Text"],
Cell[12935, 343, 537, 13, 128, "Input"],
Cell[13475, 358, 181, 4, 128, "Input"],
Cell[13659, 364, 379, 7, 122, "Text"],
Cell[14041, 373, 463, 12, 128, "Input"],
Cell[14507, 387, 179, 4, 128, "Input"],
Cell[14689, 393, 231, 4, 128, "Input"],
Cell[14923, 399, 165, 3, 122, "Text"],
Cell[15091, 404, 254, 5, 128, "Input"],
Cell[15348, 411, 69, 1, 128, "Input"],
Cell[15420, 414, 142, 1, 122, "Text"],
Cell[15565, 417, 119, 1, 122, "Text"],
Cell[15687, 420, 178, 4, 128, "Input"],
Cell[15868, 426, 279, 6, 122, "Text"],
Cell[16150, 434, 129, 3, 128, "Input"],
Cell[16282, 439, 204, 4, 122, "Text"],
Cell[16489, 445, 177, 4, 128, "Input"],
Cell[16669, 451, 860, 20, 278, "Text"],
Cell[17532, 473, 268, 6, 128, "Input"],
Cell[17803, 481, 178, 4, 128, "Input"],
Cell[17984, 487, 221, 5, 128, "Input"],
Cell[18208, 494, 167, 2, 122, "Text"],
Cell[18378, 498, 181, 4, 128, "Input"],
Cell[18562, 504, 140, 3, 128, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[18739, 512, 187, 3, 93, "Chapter"],
Cell[18929, 517, 2563, 53, 488, "Input"],
Cell[21495, 572, 435, 9, 128, "Input"],
Cell[21933, 583, 173, 2, 122, "Text"],
Cell[22109, 587, 271, 5, 128, "Input"],
Cell[22383, 594, 114, 1, 122, "Text"],
Cell[CellGroupData[{
Cell[22522, 599, 100, 1, 240, "Section"],
Cell[CellGroupData[{
Cell[22647, 604, 70, 1, 126, "Subsubsection"],
Cell[22720, 607, 470, 11, 216, "Input"],
Cell[23193, 620, 1589, 29, 128, "Input"],
Cell[24785, 651, 172, 4, 128, "Input"],
Cell[24960, 657, 160, 3, 128, "Input"],
Cell[25123, 662, 253, 5, 122, "Text"],
Cell[25379, 669, 211, 5, 128, "Input"],
Cell[25593, 676, 246, 7, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25876, 688, 92, 1, 126, "Subsubsection"],
Cell[25971, 691, 494, 11, 216, "Input"],
Cell[26468, 704, 1611, 29, 128, "Input"],
Cell[28082, 735, 172, 4, 128, "Input"],
Cell[28257, 741, 160, 3, 128, "Input"],
Cell[28420, 746, 211, 5, 128, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[28668, 756, 119, 2, 94, "Subsubsection"],
Cell[28790, 760, 520, 12, 216, "Input"],
Cell[29313, 774, 2211, 44, 128, "Input"],
Cell[31527, 820, 172, 4, 128, "Input"],
Cell[31702, 826, 277, 6, 128, "Input"],
Cell[31982, 834, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[32230, 844, 151, 3, 126, "Subsubsection"],
Cell[32384, 849, 544, 12, 216, "Input"],
Cell[32931, 863, 2597, 53, 128, "Input"],
Cell[35531, 918, 172, 4, 128, "Input"],
Cell[35706, 924, 507, 13, 216, "Input"],
Cell[36216, 939, 548, 15, 292, "Input"],
Cell[36767, 956, 122, 2, 128, "Input"],
Cell[36892, 960, 277, 6, 128, "Input"],
Cell[37172, 968, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37420, 978, 169, 3, 126, "Subsubsection"],
Cell[37592, 983, 568, 12, 216, "Input"],
Cell[38163, 997, 1664, 29, 128, "Input"],
Cell[39830, 1028, 172, 4, 128, "Input"],
Cell[40005, 1034, 277, 6, 128, "Input"],
Cell[40285, 1042, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40533, 1052, 196, 3, 126, "Subsubsection"],
Cell[40732, 1057, 593, 13, 216, "Input"],
Cell[41328, 1072, 1690, 30, 128, "Input"],
Cell[43021, 1104, 172, 4, 128, "Input"],
Cell[43196, 1110, 507, 13, 216, "Input"],
Cell[43706, 1125, 548, 15, 292, "Input"],
Cell[44257, 1142, 277, 6, 128, "Input"],
Cell[44537, 1150, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44785, 1160, 222, 4, 126, "Subsubsection"],
Cell[45010, 1166, 644, 13, 216, "Input"],
Cell[45657, 1181, 1955, 36, 128, "Input"],
Cell[47615, 1219, 172, 4, 128, "Input"],
Cell[47790, 1225, 507, 13, 216, "Input"],
Cell[48300, 1240, 548, 15, 292, "Input"],
Cell[48851, 1257, 277, 6, 128, "Input"],
Cell[49131, 1265, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49379, 1275, 244, 4, 126, "Subsubsection"],
Cell[49626, 1281, 668, 14, 216, "Input"],
Cell[50297, 1297, 1735, 30, 128, "Input"],
Cell[52035, 1329, 172, 4, 128, "Input"],
Cell[52210, 1335, 277, 6, 128, "Input"],
Cell[52490, 1343, 211, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52738, 1353, 93, 1, 164, "Subsection"],
Cell[52834, 1356, 399, 11, 128, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[53282, 1373, 138, 1, 240, "Section"],
Cell[53423, 1376, 232, 5, 128, "Input"],
Cell[53658, 1383, 120, 2, 128, "Input"],
Cell[53781, 1387, 178, 4, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[53996, 1396, 153, 2, 240, "Section"],
Cell[54152, 1400, 274, 6, 128, "Input"],
Cell[54429, 1408, 198, 5, 128, "Input"],
Cell[54630, 1415, 208, 5, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54875, 1425, 202, 3, 240, "Section"],
Cell[55080, 1430, 334, 8, 128, "Input"],
Cell[55417, 1440, 69, 1, 128, "Input"],
Cell[55489, 1443, 198, 5, 128, "Input"],
Cell[55690, 1450, 159, 3, 128, "Input"],
Cell[55852, 1455, 233, 4, 128, "Input"],
Cell[56088, 1461, 96, 1, 128, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[56233, 1468, 268, 4, 93, "Chapter"],
Cell[56504, 1474, 5531, 109, 488, "Input"],
Cell[62038, 1585, 284, 6, 128, "Input"],
Cell[62325, 1593, 195, 4, 128, "Input"],
Cell[CellGroupData[{
Cell[62545, 1601, 151, 2, 240, "Section"],
Cell[CellGroupData[{
Cell[62721, 1607, 98, 1, 126, "Subsubsection"],
Cell[62822, 1610, 520, 12, 216, "Input"],
Cell[63345, 1624, 114, 2, 128, "Input"],
Cell[63462, 1628, 592, 16, 202, "Text"],
Cell[64057, 1646, 1975, 37, 128, "Input"],
Cell[66035, 1685, 172, 4, 128, "Input"],
Cell[66210, 1691, 543, 12, 122, "Text"],
Cell[66756, 1705, 376, 12, 232, "Input"],
Cell[67135, 1719, 197, 4, 128, "Input"],
Cell[67335, 1725, 218, 6, 122, "Text"],
Cell[67556, 1733, 539, 12, 128, "Input"],
Cell[68098, 1747, 104, 3, 128, "Input"],
Cell[68205, 1752, 316, 8, 128, "Input"],
Cell[68524, 1762, 104, 3, 128, "Input"],
Cell[68631, 1767, 159, 3, 128, "Input"],
Cell[68793, 1772, 165, 3, 128, "Input"],
Cell[68961, 1777, 451, 12, 196, "Input"],
Cell[69415, 1791, 211, 5, 128, "Input"],
Cell[69629, 1798, 199, 3, 122, "Text"],
Cell[69831, 1803, 162, 3, 128, "Input"],
Cell[69996, 1808, 364, 11, 122, "Text"],
Cell[70363, 1821, 208, 4, 128, "Input"],
Cell[70574, 1827, 758, 21, 204, "Text"],
Cell[71335, 1850, 241, 5, 128, "Input"],
Cell[71579, 1857, 270, 5, 122, "Text"],
Cell[71852, 1864, 238, 6, 122, "Text"],
Cell[72093, 1872, 187, 4, 128, "Input"],
Cell[72283, 1878, 64, 1, 128, "Input"],
Cell[72350, 1881, 130, 2, 128, "Input"],
Cell[72483, 1885, 362, 5, 200, "Text"],
Cell[72848, 1892, 257, 5, 128, "Input"],
Cell[73108, 1899, 443, 10, 128, "Input"],
Cell[73554, 1911, 368, 10, 124, "Text"],
Cell[73925, 1923, 135, 4, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74097, 1932, 122, 2, 126, "Subsubsection"],
Cell[74222, 1936, 590, 13, 216, "Input"],
Cell[74815, 1951, 181, 3, 128, "Input"],
Cell[74999, 1956, 800, 17, 202, "Text"],
Cell[75802, 1975, 1979, 35, 128, "Input"],
Cell[77784, 2012, 172, 4, 128, "Input"],
Cell[77959, 2018, 131, 2, 128, "Input"],
Cell[78093, 2022, 356, 9, 128, "Input"],
Cell[78452, 2033, 104, 3, 128, "Input"],
Cell[78559, 2038, 159, 3, 128, "Input"],
Cell[78721, 2043, 208, 4, 128, "Input"],
Cell[78932, 2049, 120, 2, 128, "Input"],
Cell[79055, 2053, 232, 4, 122, "Text"],
Cell[79290, 2059, 920, 21, 292, "Input"],
Cell[80213, 2082, 575, 16, 292, "Input"],
Cell[80791, 2100, 162, 3, 128, "Input"],
Cell[80956, 2105, 257, 5, 128, "Input"],
Cell[81216, 2112, 420, 10, 128, "Input"],
Cell[81639, 2124, 135, 4, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81811, 2133, 140, 2, 126, "Subsubsection"],
Cell[81954, 2137, 616, 14, 216, "Input"],
Cell[82573, 2153, 181, 3, 128, "Input"],
Cell[82757, 2158, 1664, 27, 128, "Input"],
Cell[84424, 2187, 172, 4, 128, "Input"],
Cell[84599, 2193, 131, 2, 128, "Input"],
Cell[84733, 2197, 115, 2, 128, "Input"],
Cell[84851, 2201, 162, 3, 128, "Input"],
Cell[85016, 2206, 257, 5, 128, "Input"],
Cell[85276, 2213, 440, 10, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85753, 2228, 151, 2, 126, "Subsubsection"],
Cell[85907, 2232, 616, 14, 216, "Input"],
Cell[86526, 2248, 181, 3, 128, "Input"],
Cell[86710, 2253, 427, 11, 124, "Text"],
Cell[87140, 2266, 1991, 36, 128, "Input"],
Cell[89134, 2304, 172, 4, 128, "Input"],
Cell[89309, 2310, 131, 2, 128, "Input"],
Cell[89443, 2314, 751, 22, 300, "Text"],
Cell[90197, 2338, 433, 13, 186, "Input"],
Cell[90633, 2353, 229, 5, 128, "Input"],
Cell[90865, 2360, 1102, 27, 362, "Text"],
Cell[91970, 2389, 1128, 28, 128, "Input"],
Cell[93101, 2419, 174, 2, 122, "Text"],
Cell[93278, 2423, 339, 8, 216, "Input"],
Cell[93620, 2433, 128, 1, 122, "Text"],
Cell[93751, 2436, 170, 4, 128, "Input"],
Cell[93924, 2442, 409, 10, 128, "Input"],
Cell[94336, 2454, 104, 3, 128, "Input"],
Cell[94443, 2459, 159, 3, 128, "Input"],
Cell[94605, 2464, 261, 5, 128, "Input"],
Cell[94869, 2471, 928, 20, 292, "Input"],
Cell[95800, 2493, 203, 4, 128, "Input"],
Cell[96006, 2499, 287, 7, 128, "Input"],
Cell[96296, 2508, 320, 6, 302, "Input"],
Cell[96619, 2516, 257, 5, 128, "Input"],
Cell[96879, 2523, 71, 1, 128, "Input"],
Cell[96953, 2526, 441, 10, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[97431, 2541, 148, 2, 164, "Subsection"],
Cell[97582, 2545, 447, 11, 128, "Input"],
Cell[98032, 2558, 216, 5, 128, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[98297, 2569, 153, 2, 240, "Section"],
Cell[98453, 2573, 217, 3, 128, "Input"],
Cell[98673, 2578, 170, 3, 128, "Input"],
Cell[98846, 2583, 272, 6, 122, "Text"],
Cell[CellGroupData[{
Cell[99143, 2593, 173, 2, 164, "Subsection"],
Cell[99319, 2597, 222, 5, 128, "Input"],
Cell[99544, 2604, 361, 7, 128, "Input"],
Cell[99908, 2613, 222, 5, 184, "Input"],
Cell[100133, 2620, 324, 9, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[100494, 2634, 194, 3, 164, "Subsection"],
Cell[100691, 2639, 174, 4, 184, "Input"],
Cell[100868, 2645, 213, 5, 184, "Input"],
Cell[101084, 2652, 156, 4, 184, "Input"],
Cell[101243, 2658, 254, 8, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[101534, 2671, 229, 3, 164, "Subsection"],
Cell[101766, 2676, 202, 5, 184, "Input"],
Cell[101971, 2683, 213, 5, 184, "Input"],
Cell[102187, 2690, 156, 4, 184, "Input"],
Cell[102346, 2696, 254, 8, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[102637, 2709, 404, 7, 164, "Subsection"],
Cell[103044, 2718, 195, 3, 122, "Text"],
Cell[103242, 2723, 224, 5, 184, "Input"],
Cell[103469, 2730, 410, 9, 200, "Text"],
Cell[103882, 2741, 218, 5, 184, "Input"],
Cell[104103, 2748, 369, 8, 200, "Text"],
Cell[104475, 2758, 800, 23, 272, "Input"],
Cell[105278, 2783, 209, 4, 122, "Text"],
Cell[105490, 2789, 130, 2, 184, "Input"],
Cell[105623, 2793, 114, 1, 122, "Text"],
Cell[105740, 2796, 158, 3, 184, "Input"],
Cell[CellGroupData[{
Cell[105923, 2803, 175, 2, 126, "Subsubsection"],
Cell[106101, 2807, 521, 8, 200, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106659, 2820, 362, 9, 126, "Subsubsection"],
Cell[107024, 2831, 137, 1, 122, "Text"],
Cell[107164, 2834, 443, 13, 184, "Input"],
Cell[107610, 2849, 240, 7, 184, "Input"],
Cell[107853, 2858, 385, 9, 184, "Input"],
Cell[108241, 2869, 158, 3, 122, "Text"],
Cell[108402, 2874, 1607, 43, 428, "Input"],
Cell[110012, 2919, 946, 27, 396, "Text"],
Cell[110961, 2948, 1531, 41, 432, "Input"],
Cell[112495, 2991, 579, 12, 184, "Input"],
Cell[113077, 3005, 700, 18, 184, "Input"],
Cell[113780, 3025, 512, 10, 184, "Input"],
Cell[114295, 3037, 431, 8, 184, "Input"],
Cell[114729, 3047, 222, 5, 184, "Input"],
Cell[114954, 3054, 172, 4, 184, "Input"],
Cell[115129, 3060, 92, 2, 184, "Input"],
Cell[115224, 3064, 104, 1, 122, "Text"],
Cell[115331, 3067, 433, 9, 184, "Input"],
Cell[115767, 3078, 1626, 43, 428, "Input"],
Cell[117396, 3123, 1531, 41, 432, "Input"],
Cell[118930, 3166, 415, 12, 184, "Input"],
Cell[119348, 3180, 727, 19, 184, "Input"],
Cell[120078, 3201, 512, 10, 184, "Input"],
Cell[120593, 3213, 431, 8, 184, "Input"],
Cell[121027, 3223, 219, 5, 184, "Input"],
Cell[121249, 3230, 172, 4, 184, "Input"],
Cell[121424, 3236, 92, 2, 184, "Input"],
Cell[121519, 3240, 427, 12, 124, "Text"],
Cell[121949, 3254, 186, 4, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[122172, 3263, 217, 3, 126, "Subsubsection"],
Cell[122392, 3268, 398, 10, 124, "Text"],
Cell[122793, 3280, 165, 2, 122, "Text"],
Cell[122961, 3284, 525, 12, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123523, 3301, 175, 2, 126, "Subsubsection"],
Cell[123701, 3305, 322, 6, 122, "Text"],
Cell[124026, 3313, 143, 2, 184, "Input"],
Cell[124172, 3317, 123, 4, 184, "Input"],
Cell[124298, 3323, 310, 8, 184, "Input"],
Cell[124611, 3333, 1363, 37, 428, "Input"],
Cell[125977, 3372, 239, 4, 122, "Text"],
Cell[126219, 3378, 945, 24, 196, "Input"],
Cell[127167, 3404, 141, 1, 122, "Text"],
Cell[127311, 3407, 417, 11, 184, "Input"],
Cell[127731, 3420, 832, 24, 184, "Input"],
Cell[128566, 3446, 512, 10, 184, "Input"],
Cell[129081, 3458, 383, 7, 184, "Input"],
Cell[129467, 3467, 220, 5, 184, "Input"],
Cell[129690, 3474, 172, 4, 184, "Input"],
Cell[129865, 3480, 92, 2, 184, "Input"],
Cell[129960, 3484, 914, 24, 202, "Text"],
Cell[130877, 3510, 139, 1, 122, "Text"],
Cell[131019, 3513, 245, 6, 184, "Input"],
Cell[131267, 3521, 185, 4, 122, "Text"],
Cell[131455, 3527, 325, 8, 184, "Input"],
Cell[131783, 3537, 314, 9, 184, "Input"],
Cell[132100, 3548, 324, 6, 122, "Text"],
Cell[132427, 3556, 1544, 38, 358, "Input"],
Cell[133974, 3596, 1104, 37, 208, "Text"],
Cell[135081, 3635, 945, 24, 196, "Input"],
Cell[136029, 3661, 141, 1, 122, "Text"],
Cell[136173, 3664, 417, 11, 184, "Input"],
Cell[136593, 3677, 165, 2, 122, "Text"],
Cell[136761, 3681, 245, 5, 184, "Input"],
Cell[137009, 3688, 1059, 27, 184, "Input"],
Cell[138071, 3717, 154, 3, 122, "Text"],
Cell[138228, 3722, 221, 4, 272, "Input"],
Cell[138452, 3728, 512, 9, 184, "Input"],
Cell[138967, 3739, 467, 9, 184, "Input"],
Cell[139437, 3750, 220, 5, 184, "Input"],
Cell[139660, 3757, 116, 1, 122, "Text"],
Cell[139779, 3760, 172, 4, 184, "Input"],
Cell[139954, 3766, 209, 4, 184, "Input"],
Cell[140166, 3772, 282, 9, 124, "Text"],
Cell[140451, 3783, 426, 12, 184, "Input"],
Cell[140880, 3797, 143, 1, 122, "Text"],
Cell[141026, 3800, 347, 9, 184, "Input"],
Cell[141376, 3811, 324, 9, 124, "Text"],
Cell[141703, 3822, 186, 4, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[141926, 3831, 346, 5, 128, "Subsubsection"],
Cell[142275, 3838, 161, 3, 184, "Input"],
Cell[142439, 3843, 403, 7, 122, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[142879, 3855, 119, 1, 126, "Subsubsection"],
Cell[143001, 3858, 92, 2, 184, "Input"],
Cell[143096, 3862, 197, 5, 184, "Input"],
Cell[143296, 3869, 129, 2, 184, "Input"],
Cell[143428, 3873, 122, 1, 122, "Text"],
Cell[143553, 3876, 510, 15, 200, "Text"],
Cell[144066, 3893, 300, 7, 184, "Input"],
Cell[144369, 3902, 329, 9, 184, "Input"],
Cell[144701, 3913, 636, 18, 184, "Input"],
Cell[145340, 3933, 143, 1, 122, "Text"],
Cell[145486, 3936, 396, 10, 184, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[145931, 3952, 96, 1, 164, "Subsection"],
Cell[146030, 3955, 174, 3, 184, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[146253, 3964, 204, 3, 240, "Section"],
Cell[146460, 3969, 267, 5, 122, "Text"],
Cell[146730, 3976, 165, 3, 122, "Text"],
Cell[146898, 3981, 144, 2, 128, "Input"],
Cell[147045, 3985, 756, 22, 184, "Input"],
Cell[147804, 4009, 733, 19, 184, "Input"],
Cell[148540, 4030, 255, 5, 122, "Text"],
Cell[148798, 4037, 134, 2, 184, "Input"],
Cell[148935, 4041, 612, 14, 184, "Input"],
Cell[149550, 4057, 224, 5, 184, "Input"],
Cell[149777, 4064, 161, 3, 184, "Input"],
Cell[149941, 4069, 236, 5, 184, "Input"],
Cell[150180, 4076, 169, 3, 184, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150386, 4084, 94, 1, 240, "Section"],
Cell[150483, 4087, 221, 5, 216, "Input"],
Cell[150707, 4094, 158, 3, 96, "Input"],
Cell[150868, 4099, 185, 4, 128, "Input"],
Cell[151056, 4105, 278, 7, 128, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[151383, 4118, 306, 4, 93, "Chapter"],
Cell[151692, 4124, 98, 1, 128, "Input"],
Cell[151793, 4127, 1611, 34, 140, "Input"],
Cell[153407, 4163, 360, 7, 128, "Input"],
Cell[153770, 4172, 109, 2, 128, "Input"],
Cell[153882, 4176, 195, 4, 122, "Text"],
Cell[CellGroupData[{
Cell[154102, 4184, 121, 1, 164, "Subsection"],
Cell[154226, 4187, 420, 11, 256, "Input"],
Cell[154649, 4200, 217, 4, 244, "Text"],
Cell[154869, 4206, 220, 5, 256, "Input"],
Cell[155092, 4213, 165, 3, 244, "Text"],
Cell[155260, 4218, 402, 11, 256, "Input"],
Cell[155665, 4231, 307, 7, 244, "Text"],
Cell[155975, 4240, 759, 21, 776, "Input"],
Cell[156737, 4263, 288, 6, 244, "Text"],
Cell[157028, 4271, 783, 21, 604, "Input"],
Cell[157814, 4294, 385, 8, 244, "Text"],
Cell[158202, 4304, 596, 9, 556, "Text"],
Cell[158801, 4315, 393, 10, 256, "Input"],
Cell[159197, 4327, 525, 11, 400, "Text"],
Cell[159725, 4340, 138, 1, 244, "Text"],
Cell[159866, 4343, 477, 13, 432, "Input"],
Cell[160346, 4358, 784, 28, 400, "Text"],
Cell[161133, 4388, 108, 1, 244, "Text"],
Cell[161244, 4391, 362, 10, 256, "Input"],
Cell[161609, 4403, 92, 1, 244, "Text"],
Cell[161704, 4406, 171, 4, 256, "Input"],
Cell[161878, 4412, 156, 2, 244, "Text"],
Cell[162037, 4416, 339, 10, 256, "Input"],
Cell[162379, 4428, 264, 5, 400, "Text"],
Cell[162646, 4435, 132, 2, 256, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[162815, 4442, 164, 2, 124, "Subsection"],
Cell[162982, 4446, 717, 17, 408, "Text"],
Cell[163702, 4465, 250, 8, 256, "Input"],
Cell[163955, 4475, 759, 21, 776, "Input"],
Cell[164717, 4498, 348, 7, 244, "Text"],
Cell[165068, 4507, 859, 22, 604, "Input"],
Cell[165930, 4531, 172, 2, 244, "Text"],
Cell[166105, 4535, 538, 13, 256, "Input"],
Cell[166646, 4550, 156, 3, 244, "Text"],
Cell[166805, 4555, 146, 3, 256, "Input"],
Cell[166954, 4560, 138, 1, 244, "Text"],
Cell[167095, 4563, 577, 15, 432, "Input"],
Cell[167675, 4580, 106, 3, 256, "Input"],
Cell[167784, 4585, 245, 8, 256, "Input"],
Cell[168032, 4595, 67, 1, 256, "Input"],
Cell[168102, 4598, 264, 8, 252, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[168403, 4611, 209, 3, 124, "Subsection"],
Cell[168615, 4616, 1054, 27, 128, "Input"],
Cell[169672, 4645, 153, 3, 128, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[169862, 4653, 216, 3, 164, "Subsection"],
Cell[170081, 4658, 353, 9, 128, "Input"],
Cell[170437, 4669, 87, 2, 128, "Input"],
Cell[170527, 4673, 411, 11, 196, "Input"],
Cell[170941, 4686, 87, 2, 128, "Input"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[171077, 4694, 285, 4, 93, "Chapter"],
Cell[171365, 4700, 98, 1, 64, "Input"],
Cell[171466, 4703, 137, 1, 61, "Text"],
Cell[171606, 4706, 2999, 60, 124, "Input"],
Cell[174608, 4768, 124, 1, 61, "Text"],
Cell[CellGroupData[{
Cell[174757, 4773, 332, 9, 64, "Input"],
Cell[175092, 4784, 3623, 84, 280, "Output"]
}, Open  ]],
Cell[178730, 4871, 566, 12, 64, "Input"],
Cell[CellGroupData[{
Cell[179321, 4887, 195, 4, 64, "Input"],
Cell[179519, 4893, 668, 20, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[180224, 4918, 103, 1, 82, "Subsection"],
Cell[CellGroupData[{
Cell[180352, 4923, 109, 1, 63, "Subsubsection"],
Cell[180464, 4926, 453, 12, 102, "Text"],
Cell[180920, 4940, 707, 20, 67, "Text"],
Cell[CellGroupData[{
Cell[181652, 4964, 745, 22, 64, "Input"],
Cell[182400, 4988, 141, 2, 64, "Output"]
}, Open  ]],
Cell[182556, 4993, 1402, 48, 68, "Text"],
Cell[CellGroupData[{
Cell[183983, 5045, 620, 14, 64, "Input"],
Cell[184606, 5061, 591, 16, 95, "Output"]
}, Open  ]],
Cell[185212, 5080, 1393, 45, 68, "Text"],
Cell[CellGroupData[{
Cell[186630, 5129, 638, 18, 64, "Input"],
Cell[187271, 5149, 420, 11, 64, "Output"]
}, Open  ]],
Cell[187706, 5163, 289, 10, 62, "Text"],
Cell[CellGroupData[{
Cell[188020, 5177, 238, 6, 64, "Input"],
Cell[188261, 5185, 273, 8, 95, "Output"]
}, Open  ]],
Cell[188549, 5196, 119, 1, 61, "Text"],
Cell[CellGroupData[{
Cell[188693, 5201, 728, 22, 216, "Input"],
Cell[189424, 5225, 626, 19, 246, "Output"],
Cell[190053, 5246, 593, 18, 246, "Output"]
}, Open  ]],
Cell[190661, 5267, 171, 4, 122, "Text"],
Cell[CellGroupData[{
Cell[190857, 5275, 330, 9, 128, "Input"],
Cell[191190, 5286, 560, 15, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191787, 5306, 1613, 46, 388, "Input"],
Cell[193403, 5354, 867, 26, 280, "Output"]
}, Open  ]],
Cell[194285, 5383, 116, 1, 122, "Text"],
Cell[194404, 5386, 198, 5, 128, "Input"],
Cell[194605, 5393, 182, 4, 122, "Text"],
Cell[CellGroupData[{
Cell[194812, 5401, 327, 10, 128, "Input"],
Cell[195142, 5413, 305, 6, 184, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[195496, 5425, 149, 2, 126, "Subsubsection"],
Cell[CellGroupData[{
Cell[195670, 5431, 173, 4, 128, "Input"],
Cell[195846, 5437, 163, 4, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196046, 5446, 262, 7, 128, "Input"],
Cell[CellGroupData[{
Cell[196333, 5457, 224, 5, 82, "Print"],
Cell[196560, 5464, 210, 3, 94, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[196819, 5473, 515, 13, 128, "Input"],
Cell[197337, 5488, 926, 28, 256, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[198300, 5521, 172, 4, 128, "Input"],
Cell[198475, 5527, 227, 5, 82, "Print"]
}, Open  ]],
Cell[198717, 5535, 462, 14, 134, "Text"],
Cell[CellGroupData[{
Cell[199204, 5553, 348, 7, 128, "Input"],
Cell[199555, 5562, 790, 17, 486, "Print"],
Cell[200348, 5581, 387, 9, 184, "Output"]
}, Open  ]],
Cell[200750, 5593, 212, 6, 134, "Text"],
Cell[200965, 5601, 281, 8, 124, "Text"],
Cell[CellGroupData[{
Cell[201271, 5613, 281, 7, 128, "Input"],
Cell[201555, 5622, 532, 15, 248, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202124, 5642, 172, 4, 128, "Input"],
Cell[202299, 5648, 225, 5, 82, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202561, 5658, 157, 3, 128, "Input"],
Cell[202721, 5663, 143, 2, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[202901, 5670, 119, 2, 128, "Input"],
Cell[203023, 5674, 3294, 98, 268, "Output"]
}, Open  ]],
Cell[206332, 5775, 181, 4, 128, "Input"],
Cell[206516, 5781, 211, 5, 128, "Input"],
Cell[CellGroupData[{
Cell[206752, 5790, 272, 8, 128, "Input"],
Cell[207027, 5800, 72, 1, 184, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[207148, 5807, 172, 2, 126, "Subsubsection"],
Cell[CellGroupData[{
Cell[207345, 5813, 199, 5, 128, "Input"],
Cell[207547, 5820, 185, 4, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[207769, 5829, 262, 7, 128, "Input"],
Cell[CellGroupData[{
Cell[208056, 5840, 247, 5, 82, "Print"],
Cell[208306, 5847, 233, 3, 94, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[208588, 5856, 564, 14, 128, "Input"],
Cell[209155, 5872, 1193, 38, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210385, 5915, 172, 4, 128, "Input"],
Cell[210560, 5921, 247, 5, 82, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210844, 5931, 586, 14, 128, "Input"],
Cell[211433, 5947, 753, 21, 238, "Output"]
}, Open  ]],
Cell[212201, 5971, 173, 6, 122, "Text"],
Cell[CellGroupData[{
Cell[212399, 5981, 147, 3, 128, "Input"],
Cell[212549, 5986, 122, 2, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212708, 5993, 104, 3, 128, "Input"],
Cell[212815, 5998, 203, 5, 82, "Print"]
}, Open  ]],
Cell[213033, 6006, 281, 8, 124, "Text"],
Cell[CellGroupData[{
Cell[213339, 6018, 281, 7, 128, "Input"],
Cell[213623, 6027, 560, 16, 248, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214220, 6048, 172, 4, 128, "Input"],
Cell[214395, 6054, 253, 5, 82, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214685, 6064, 157, 3, 128, "Input"],
Cell[214845, 6069, 164, 2, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[215046, 6076, 119, 2, 128, "Input"],
Cell[215168, 6080, 4370, 131, 454, "Output"]
}, Open  ]],
Cell[219553, 6214, 181, 4, 128, "Input"],
Cell[219737, 6220, 211, 5, 128, "Input"],
Cell[CellGroupData[{
Cell[219973, 6229, 270, 8, 128, "Input"],
Cell[220246, 6239, 142, 2, 184, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[220437, 6247, 200, 3, 126, "Subsubsection"],
Cell[CellGroupData[{
Cell[220662, 6254, 223, 5, 128, "Input"],
Cell[220888, 6261, 209, 4, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[221134, 6270, 262, 7, 128, "Input"],
Cell[CellGroupData[{
Cell[221421, 6281, 274, 6, 82, "Print"],
Cell[221698, 6289, 258, 4, 94, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222005, 6299, 564, 14, 128, "Input"],
Cell[222572, 6315, 1184, 36, 268, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[223793, 6356, 172, 4, 128, "Input"],
Cell[223968, 6362, 274, 6, 82, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224279, 6373, 614, 15, 128, "Input"],
Cell[224896, 6390, 859, 24, 246, "Output"]
}, Open  ]],
Cell[225770, 6417, 173, 6, 122, "Text"],
Cell[CellGroupData[{
Cell[225968, 6427, 147, 3, 128, "Input"],
Cell[226118, 6432, 141, 2, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226296, 6439, 104, 3, 128, "Input"],
Cell[226403, 6444, 227, 5, 82, "Print"]
}, Open  ]],
Cell[226645, 6452, 281, 8, 124, "Text"],
Cell[CellGroupData[{
Cell[226951, 6464, 281, 7, 128, "Input"],
Cell[227235, 6473, 582, 16, 248, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227854, 6494, 172, 4, 128, "Input"],
Cell[228029, 6500, 276, 6, 82, "Print"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228342, 6511, 157, 3, 128, "Input"],
Cell[228502, 6516, 189, 3, 184, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228728, 6524, 119, 2, 128, "Input"],
Cell[228850, 6528, 3957, 116, 454, "Output"]
}, Open  ]],
Cell[232822, 6647, 181, 4, 64, "Input"],
Cell[233006, 6653, 211, 5, 64, "Input"],
Cell[CellGroupData[{
Cell[233242, 6662, 270, 8, 64, "Input"],
Cell[233515, 6672, 164, 2, 64, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[233728, 6680, 260, 3, 63, "Subsubsection"],
Cell[CellGroupData[{
Cell[234013, 6687, 327, 10, 64, "Input"],
Cell[234343, 6699, 324, 7, 64, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234728, 6713, 252, 3, 82, "Subsection"],
Cell[234983, 6718, 175, 4, 61, "Text"],
Cell[CellGroupData[{
Cell[235183, 6726, 294, 6, 108, "Input"],
Cell[235480, 6734, 169, 2, 64, "Output"],
Cell[235652, 6738, 171, 2, 64, "Output"]
}, Open  ]],
Cell[235838, 6743, 181, 2, 61, "Text"],
Cell[236022, 6747, 643, 17, 194, "Input"],
Cell[236668, 6766, 265, 5, 61, "Text"],
Cell[236936, 6773, 739, 20, 64, "Input"],
Cell[CellGroupData[{
Cell[237700, 6797, 306, 8, 64, "Input"],
Cell[238009, 6807, 6690, 174, 646, "Output"]
}, Open  ]],
Cell[244714, 6984, 197, 5, 64, "Input"],
Cell[CellGroupData[{
Cell[244936, 6993, 185, 4, 64, "Input"],
Cell[245124, 6999, 94, 1, 64, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

